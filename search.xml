<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Flow and Diffusion Models</title>
      <link href="/2025/06/30/flow/"/>
      <url>/2025/06/30/flow/</url>
      
        <content type="html"><![CDATA[<h1 id="flow-and-diffusion-models">Flow and Diffusion Models</h1><blockquote><p>ğŸ–Œ éšç€ç”Ÿæˆçš„æ¨¡å‹å‘å±•ï¼ŒDiffusionçš„æ–¹æ³•è®ºï¼Œä¹Ÿå˜å¾—è¶Šæ¥è¶Šç³»ç»Ÿäº†ï¼Œå½“ç„¶ä»‹ç»ç›¸å…³çŸ¥è¯†çš„æ–‡æ¡£ï¼Œä¹Ÿå±‚å‡ºä¸ç©·ã€‚è¿™ä¸ªæ–‡æ¡£ï¼Œæˆ‘ç”±æ•°å­¦åˆ°åº”ç”¨ï¼Œè§£é‡Šå½“ä¸‹Flow Modelï¼ŒDiffusion Modelçš„åŸç†å’Œå…·ä½“å®ç°ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿™ä¸ªBlogä¸»è¦æ˜¯æƒ³å°†åŸæ¥é‚£å¥—StableDiffusionçš„æè¿°è¯­è¨€å’Œç°åœ¨Flow Matchingè¿™å¥—æè¿°è¯­è¨€ç»Ÿä¸€èµ·æ¥ã€‚</p></blockquote><p><em>å¤‡æ³¨ï¼šBlogä¸­çš„ä¸€äº›å¯è§†åŒ–è„šæœ¬éƒ½åœ¨https://github.com/anschen1994/flow-diffusion#è¿™ä¸ªä»“åº“ä¸­</em></p><h1 id="ä½•ä¸ºç”Ÿæˆ">ä½•ä¸ºç”Ÿæˆ</h1><p>é¦–å…ˆåœ¨å…·ä½“è°ˆè®ºæ•°å­¦æ¨¡å‹ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥æ€è€ƒä¸€ä¸‹ï¼Œç”Ÿæˆåœ¨æ•°å­¦ä¸Šæ˜¯åœ¨åšæ€ä¹ˆæ ·çš„ä¸€ä»¶äº‹æƒ…ã€‚å½’æ ¹ç»“åº•ï¼Œç”Ÿæˆåœ¨æŸç§æ„ä¹‰ä¸Šå°±ç­‰ä»·äºæ•°å­¦ä¸Šçš„â€œé‡‡æ ·â€ã€‚ä¸¾ä¸ªç®€å•ä¾‹å­ï¼Œæˆ‘éœ€è¦ç”Ÿæˆä¸€å¼ æˆ¿å±‹çš„å›¾ç‰‡ã€‚é‚£å…¶å®åœ¨æ•°å­¦ä¸Šæˆ‘ä»¬è¦åšå¾—äº‹æƒ…ï¼š</p><ul><li>æ‰¾å‡º <span class="math inline">\(p(\cdot|house)\)</span>ï¼Œconditionon æˆ¿å±‹çš„æ•´ä¸ªå›¾ç‰‡çš„æ¦‚ç‡åˆ†å¸ƒæ˜¯ä»€ä¹ˆæ ·å­çš„ã€‚</li><li>ä»<span class="math inline">\(p(\cdot|house)\)</span>,ä»ä¸Šé¢çš„è¿™ä¸ªæ¡ä»¶æ¦‚ç‡ä¸­å»é‡‡æ ·ä¸€ä¸ªæ ·æœ¬å‡ºæ¥å³å¯ã€‚</li></ul><p>ä½†æ˜¯ï¼Œæˆ‘ä»¬å¾€å¾€æ²¡æœ‰åŠæ³•çŸ¥é“<span class="math inline">\(p(\cdot|house)\)</span>è¿™ä¸ªåˆ†å¸ƒæ˜¯ä»€ä¹ˆæ ·å­çš„ï¼Œå› æ­¤ï¼Œæ•´ä¸ªäº‹æƒ…å°±æ²¡æœ‰åŠæ³•å¾ˆå¥½çš„å®æ–½ã€‚é‚£ç°åœ¨ä¸»æµçš„ç”Ÿæˆæ‰€é‡‡å–çš„æ–¹æ¡ˆï¼Œå°è¯•å»ºç«‹æŸç§ç®€å•åˆå§‹åˆ†å¸ƒï¼ˆä¸€èˆ¬ä¸ºé«˜æ–¯åˆ†å¸ƒï¼‰å’Œç›®æ ‡åˆ†å¸ƒä¹‹é—´çš„è½¬ç§»æ–¹å¼ï¼Œå°±å¦‚ä¸‹é¢å›¾æ‰€ç¤ºã€‚</p><img src="/2025/06/30/flow/scheme.png" class="" width="500" title="Generation Scheme"><h1 id="æ•°å­¦æ¨¡å‹">æ•°å­¦æ¨¡å‹</h1><p>Flow Model å’Œ Diffusion Modelä¹Ÿéƒ½æ˜¯å»ºç«‹ä¸Šé¢è¿™ç§å¤§è‡´çš„æƒ³æ³•ä¸Šï¼Œè¯ç”Ÿçš„ä¸¤ç§ç®—æ³•ã€‚</p><p>é¦–å…ˆæ— è®ºæ˜¯ç”Ÿæˆå›¾ç‰‡ï¼Œè§†é¢‘ï¼Œ3Dæ¨¡å‹ç­‰ç­‰ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥å°†éœ€è¦å»ºæ¨¡çš„å¯¹è±¡ï¼Œç®€åŒ–æˆä¸€ä¸ªé«˜ç»´çš„éšæœºå˜é‡<span class="math inline">\(X_t\in\mathbb{R}^d\)</span></p><h2 id="flow-model">Flow Model</h2><p>Flow Model ä½¿ç”¨äº†ç®€å•çš„ ODE å»å»ºç«‹åˆå§‹åˆ†å¸ƒå’Œç›®æ ‡åˆ†å¸ƒä¹‹é—´çš„å…³ç³»ã€‚</p><p><span class="math display">\[\frac{dX_t}{dt}=f(X_t, t), t\in[0,1],\\f:\mathbb{R}^d\times\mathbb{R} \to \mathbb{R}^d\]</span></p><p>åŒæ—¶æ»¡è¶³</p><p><span class="math display">\[X_0 \sim p_{init}, X_1 \sim p_{target}\]</span></p><p>æ‰€ä»¥å¯¹äºç®€å•çš„ Flow Model æ¥è¯´ï¼Œæˆ‘ä»¬å°±æ˜¯è¦æ‰¾åˆ°<span class="math inline">\(f(X_t,t)\)</span>å»å»ºç«‹ä¸¤ä¸ªåˆ†å¸ƒä¹‹é—´çš„è”ç³»ã€‚</p><p>å½“ç„¶è¿™ä¸ªæ¨¡å‹è¢«ç§°ä¹‹ä¸º Flow Modelçš„åŸå› ã€‚æˆ‘ä»¬ä¼šå°†ä¸‹é¢è¿™ç§æ»¡è¶³æŸä¸ªåˆå§‹ç‚¹çš„è§£ç§°ä¹‹ä¸º Flowï¼Œå³ï¼š</p><p><span class="math display">\[\frac{d}{dt}\psi_t(x_0)=f(\psi_t(x_0),t),\psi_0(x_0)=x_0.\]</span></p><p>ç›´è§‚ä¸Šæ¥è¯´<span class="math inline">\(\psi_t(x_0), \psi_t(x_1),\psi_t(x_2), \cdots\)</span> å°±æ„æˆäº†åˆå§‹ç‚¹åœ¨<span class="math inline">\(x_0,x_1,x_2,\cdots\)</span>çš„ä¸€äº›æµï¼ŒåŒæ—¶è¿™äº›æµåœ¨æŸäº›æ—¶ç©ºç‚¹<span class="math inline">\((x,t)\)</span>å¤„ï¼Œæœ‰çš„å¯†é›†ï¼Œæœ‰çš„ç¨€ç–ã€‚</p><h3 id="example">Example</h3><p>ä¸‹é¢ç”¨ä¸€ä¸ªç®€å•çš„äºŒç»´å‘åŸç‚¹æ”¶ç¼©çš„ä¾‹å­ï¼Œæ¥å¯è§†åŒ–è¿™ä¸ªé—®é¢˜ã€‚</p><p><span class="math display">\[\frac{dX_t}{dt}=-\theta X_t, X_0 \sim \mathcal{N}(0,5), t\in[0,1]\]</span></p><p>è¿™ä¸ªæ–¹ç¨‹çš„è§£å¯ä»¥å†™æˆï¼š</p><p><span class="math display">\[X_t = e^{-\theta t}X_0\]</span></p><p>å¯¹åº”çš„ flow ä¸º</p><p><span class="math display">\[\psi_t(x) = e^{-\theta t}x\]</span></p><p>ä»ä¸‹é¢è¿™ä¸ªå›¾ï¼Œæˆ‘ä»¬å±•ç°ä¸Šé¢ Flow Modelå¯¹åº”çš„é€Ÿåº¦ï¼Œå…¶é€Ÿåº¦å‘é‡ï¼Œéƒ½æ˜¯æ²¿ç€è‡ªèº«çš„åæ–¹å‘æŒ‡å‘åŸç‚¹ã€‚</p><img src="/2025/06/30/flow/flow_ode.png" class="" width="400" title="Flow ODE"><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨ç®€å•çš„ ODE æ•°å€¼æ±‚è§£æ–¹æ³•ï¼Œå¹¶ä¸”å¯è§†åŒ–ä¸Šé¢çš„å„ç§ Flow <span class="math inline">\(\psi_t(x)\)</span>ï¼Œå¦‚ä¸‹å›¾:</p><img src="/2025/06/30/flow/flow_vec_filed.png" class="" width="400" title="Flow Vector Field"><p>è¿™ä¸ªå›¾ä¸­ï¼Œæ¯ä¸ªç»¿ç‚¹å¯¹åº”åˆå§‹çš„<span class="math inline">\(x\)</span>,æ¯ä¸ªçº¢è‰²è½¨è¿¹ï¼Œå¯¹åº”ç€ä¸€æ¡ flow <span class="math inline">\(\psi_t(x)\)</span>.</p><h3 id="section"></h3><h2 id="diffusion-model">Diffusion Model</h2><p>åœ¨ Flow Modelä¸­ï¼Œæˆ‘ä»¬å‘ç°æ•´ä¸ªåŠ¨åŠ›å­¦è¿‡ç¨‹ï¼Œæ²¡æœ‰éšæœºæ€§ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªç®€å•çš„ ODEæè¿°ã€‚Diffusion Model åˆ™æ˜¯åœ¨ Flow Modelçš„åŸºç¡€ä¸Šï¼Œå¢åŠ äº†ä¸€äº›éšæœºè¿‡ç¨‹ï¼Œæ•´ä½“çš„åŠ¨åŠ›å­¦è¿‡ç¨‹å¯ä»¥ç”¨ä¸‹é¢çš„ SDE æè¿°:</p><p><span class="math display">\[dX_t = f(X_t, t)dt + g(X_t, t)dW_t\]</span></p><p>è¿™è¾¹çš„<span class="math inline">\(dW_t\)</span>æ¥è‡ªäºç»å…¸çš„å¸ƒæœ—è¿åŠ¨ï¼Œç®€å•æ¥è¯´<span class="math inline">\(dW_t\)</span>æè¿°äº†ä¸€ä¸ªæ–¹å·®ä¸º<span class="math inline">\(dt\)</span>,å‡å€¼ä¸º 0çš„éšæœºæ‰°åŠ¨ã€‚å…·ä½“æ•°å­¦å¯ä»¥å‚è§ï¼Œä»»æ„ä»‹ç»éšå³å¾®ç§¯åˆ†çš„æ•™æã€‚</p><p>è¿™è¾¹æˆ‘ä»¬å°±éœ€è¦æ³¨æ„åˆ°å¯¹äºä»»æ„å›ºå®šçš„<span class="math inline">\(x\)</span>ï¼Œæˆ‘ä»¬ä¸å†ä¼šæœ‰ä¸€ä¸ªç¡®å®šæ€§çš„æµ<span class="math inline">\(\psi_t(x)\)</span>ï¼Œå› ä¸ºå°±ç®—åˆå§‹ç‚¹ç¡®å®šï¼Œæ•´ä¸ªè¿‡ç¨‹ä¾ç„¶å……æ»¡äº†éšæœºã€‚</p><h3 id="example-1">Example</h3><p>æˆ‘ä»¬æ‰©å±•ä¸€ä¸‹ä¸Šé¢é‚£ä¸ªç®€å•çš„ Flow Modelï¼Œåˆ°ç»å…¸çš„OU(Ornstein-Uhlenbeck) Process.</p><p><span class="math display">\[dX^{OU}_t = -\theta X_t dt + \sigma dW_t\]</span></p><p>æˆ‘ä»¬å¯ä»¥çŸ¥é“ä¸Šé¢ SDE çš„è§£å¯ä»¥å†™æˆä¸‹é¢çš„ç§¯åˆ†å½¢å¼ï¼š</p><p><span class="math display">\[X^{OU}_t = e^{-\theta t}X_0 + \sigma \int_0^t e^{\theta(s-t)}dW_s\]</span></p><p>å¯¹æ¯”ä¸Šé¢çš„ODEï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸¤è€…çš„æ•°å­¦æœŸæœ›æ˜¯åœ¨ä»»æ„æ—¶åˆ»éƒ½æ˜¯ä¸€æ ·çš„ï¼Œ<span class="math inline">\(\mathbb{E}[X_t^{OU}]=\mathbb{E}[X_t]=e^{-\thetat}X_0\)</span>. ä½†æ˜¯<span class="math inline">\(X^{OU}_t\)</span>å­˜åœ¨æ˜æ˜¾çš„éšæœºé¡¹ï¼Œå½“ç„¶é€šè¿‡ç®€å•çš„è®¡ç®—ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼š</p><p><span class="math display">\[\mathbb{Var}[X_t^{OU}] = \frac{\sigma^2}{2\theta}(1-e^{-2\theta t}),\mathbb{Cov}[X_t^{OU},X_s^{OU}]=\frac{\sigma^2}{2\theta}(e^{-\theta|t-s|}-e^{-\theta|t+s|})\]</span></p><blockquote><p><strong>Flow and Diffusion Model</strong>ä»ä¸Šé¢çš„æè¿°æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼ŒFlowå’ŒDiffusionModeléƒ½å¯ä»¥ä½¿ç”¨ä¸‹é¢å¯¹äºéšæœºå˜é‡çš„åŠ¨åŠ›å­¦æ–¹ç¨‹æè¿°: <span class="math display">\[dX_t = f(X_t, t)dt + g(X_t, t)dW_t\]</span> FlowModel åªæ˜¯ä¸Šé¢<span class="math display">\[g(X_t,t)\equiv0\]</span>çš„ç‰¹æ®Šæƒ…å†µ</p></blockquote><p>åœ¨ä¸‹é¢çš„è¿™å¼ å›¾ä¸­ï¼Œæˆ‘ä»¬å¯è§†åŒ–äº† OU è¿‡ç¨‹ï¼š <img src="/2025/06/30/flow/ou_simulate.png" class="" width="400" title="Flow ODE"></p><p>ä»<span class="math inline">\(X_0=5\)</span>å‡ºå‘ï¼Œç»™å‡ºäº†è¿™ä¸ª SDEå¯¹åº”çš„ 50 æ¡å¯èƒ½çš„trajectoryï¼ŒåŒæ—¶ç”¨çº¢è‰²è™šçº¿ï¼Œæ ‡æ³¨äº†è¿™äº›è½¨è¿¹å¯¹åº”çš„å¹³å‡å€¼<span class="math inline">\(e^{-\theta t}X_0\)</span></p><h3 id="section-1"></h3><h2 id="fokker-planck-equation">Fokker-Planck Equation</h2><h3 id="å®šç†">å®šç†</h3><p>Fokker-Planck Equation æ˜¯æè¿°æ•´ä¸ª Flow Model å’Œ Diffusion Modelçš„æ•°å­¦åŸºçŸ³ã€‚è¿™è¾¹ä¸»è¦é™ˆåˆ—å…¶å‡ ä¸ªé‡è¦çš„ç»“æœï¼Œå…·ä½“çš„æ•°å­¦æ¨å¯¼å¯ä»¥å‚è€ƒè¿™ä¸ªBlog: <a href="https://www.peterholderrieth.com/blog/2023/The-Fokker-Planck-Equation-and-Diffusion-Models/">https://www.peterholderrieth.com/blog/2023/The-Fokker-Planck-Equation-and-Diffusion-Models/</a></p><blockquote><p><strong>Fokker-Planck Equation</strong>å¯¹äºä¸€ä¸ªéšæœºå˜é‡å…¶åŠ¨åŠ›å­¦æ–¹ç¨‹æ»¡è¶³:<span class="math display">\[dX_t=f(X_t,t)dt+g(X_t,t)dW_t\]</span>,å½“ä¸”ä»…å½“å…¶éšæœºå˜é‡å¯¹åº”çš„åˆ†å¸ƒ<span class="math inline">\(p_t(x)\)</span>æ»¡è¶³ä¸‹é¢çš„åŠ¨åŠ›å­¦æ–¹ç¨‹: <span class="math display">\[\frac{dp_t(x)}{dt}=-\nabla\cdot(f(x,t)p_t(x))+\frac{1}{2}\nabla^2\cdot(g(x,t)g(x,t)^Tp_t(x))\]</span></p></blockquote><p>ä¸Šé¢æ–¹ç¨‹ç¬¬ä¸€é¡¹æ¯”è¾ƒå¥½ç†è§£ï¼Œå¯¹äºè¿ç»­ä¸å¯å‹ç¼©çš„ç‰©è´¨æ¥è¯´ï¼Œæ•£åº¦<span class="math inline">\(\nabla\cdot(f(x,t)p_t(x))\)</span>å¯¹åº”åœ¨æ—¶ç©ºç‚¹<span class="math inline">\((x,t)\)</span>å¤„çš„å‡€æµé‡ã€‚ç¬¬äºŒé¡¹åˆ™æ˜¯ç”±<span class="math inline">\(dW_t\)</span>è¿™ä¸ªå¸ƒæœ—è¿åŠ¨å¸¦æ¥çš„ã€‚ä»ç›´è§‰æˆ‘ä»¬å¯ä»¥çŸ¥é“å…¶å¤§æ¦‚çš„scaling ç”±æ–¹å·®é€ æˆ<span class="math inline">\(dW_t^Tg^TgdW_t\sim gg^TI_d dt\)</span>ã€‚</p><p><strong>Fokker-Planck Equationæœ€é‡è¦çš„ç‚¹ï¼Œæ˜¯å…¶æˆåŠŸè¿æ¥äº†éšæœºå˜é‡çš„åŠ¨åŠ›å­¦å’Œå…¶åˆ†å¸ƒå¯¹åº”çš„åŠ¨åŠ›å­¦ä¹‹é—´çš„å…³ç³»</strong></p><h3 id="example-2">Example</h3><p>è¿™è¾¹æˆ‘ä»¬ä»¥ OU Process ä¸ºä¾‹ï¼Œè§£é‡Š Fokker-Planck Equationã€‚</p><p>é¦–å…ˆ OU Process çš„ FPE å¯ä»¥å†™æˆä¸‹é¢çš„å½¢å¼:</p><p><span class="math display">\[\partial_tp_t(x)=\theta\partial_x(xp_t(x))+\frac{1}{2}\sigma^2\partial_x^2p_t(x)\]</span></p><p>ä¸Šé¢è¿™ä¸ª PDE å¯¹åº”çš„è§£ä¸º(å…·ä½“æ•°å­¦æ¨å¯¼å¯ä»¥å‚è€ƒé™„å½•)ï¼Œ</p><p><span class="math display">\[p_t(x)=\frac{1}{2\pi s_t^2}\exp\left(-\frac{(x-\mu_t)^2}{2s_t^2}\right),s_t^2:=\frac{\sigma^2}{2\theta}(1-e^{-2\theta t}),\mu_t:=x_0e^{-\thetat}\]</span></p><p>ä»è¿™è¾¹æˆ‘ä»¬å¯ä»¥çœ‹åˆ°<span class="math inline">\(p_t(x)\)</span>å¯¹åº”çš„åˆ†å¸ƒï¼Œå’Œä¸Šé¢æˆ‘ä»¬ç›´æ¥æ±‚è§£ SDEæ˜¯ä¸€æ ·ï¼Œæ˜¯ä¸€ä¸ªå‡å€¼ä¸º<span class="math inline">\(\mu_t\)</span>,æ ‡å‡†å·®ä¸º<span class="math inline">\(s_t\)</span>çš„é«˜æ–¯åˆ†å¸ƒã€‚</p><p>æˆ‘ä»¬é€šè¿‡æ¨¡æ‹Ÿ OU Process ä»<span class="math inline">\(t=0\)</span>åˆ°$t=4<span class="math inline">\(50000æ¬¡ï¼ŒåŒæ—¶è®°å½•\)</span>t=0.0,0.5,1.5,4.0$å››ä¸ªæ—¶é—´ç‚¹çš„å–å€¼åˆ†å¸ƒï¼Œå¹¶ä¸”æ ¹æ® FPE å¯¹åº”çš„è§£æè§£è¿›è¡Œå¯¹æ¯”ï¼š <img src="/2025/06/30/flow/ou_fpe.png" class="" width="400" title="Flow ODE"></p><h3 id="from-sde-to-ode">From SDE to ODE</h3><blockquote><p><strong>From SDE to ODE</strong> å¯¹äºä¸€ä¸ªSDE <span class="math inline">\(dX_t=f(X_t, t)dt+g(X_t,t)dW_t\)</span>,æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªODE: <span class="math display">\[dZ_t=F(Z_t,t)dt, \\F(z,t):=f(z,t)-\frac{1}{2}\nabla\left(g(z,t)g(z,t)^T\right)-\frac{1}{2}g(z,t)g(z,t)^T\nabla\log p_t(z)\]</span> ä½¿å¾—<span class="math inline">\(X_t\)</span>åœ¨<span class="math inline">\(t\)</span>æ—¶åˆ»çš„åˆ†å¸ƒ<span class="math inline">\(p_t(x)\)</span>å’Œ<span class="math inline">\(Z_t\)</span>åœ¨<span class="math inline">\(t\)</span>æ—¶åˆ»çš„åˆ†å¸ƒ<span class="math inline">\(p_t(z)\)</span>æ˜¯ä¸€æ ·çš„ï¼Œå¦‚æœä»–ä»¬çš„åˆå§‹åˆ†å¸ƒä¸€æ ·<span class="math inline">\(X_0\sim p_{init}, Z_0\sim p_{init}\)</span></p></blockquote><p>ä¸Šé¢è¿™ä¸ªæ–¹ç¨‹è€ƒè™‘äº†æ¯”ä¸Šé¢å‚è€ƒçš„ Blogæ›´ä¸€èˆ¬çš„æƒ…å†µï¼Œå› æ­¤å¤šå‡ºæ¥äº†é¢å¤–çš„ä¸€é¡¹<span class="math inline">\(-\frac{1}{2}\nabla\left(g(z,t)g(z,t)^T\right)\)</span></p><p><strong>ä¸Šé¢è¿™ä¸ªå®šç†å‘Šè¯‰äº†æˆ‘ä»¬ä¸€ä¸ªå¾ˆé‡è¦çš„äº‹æƒ…ï¼Œå¦‚æœæˆ‘ä»¬å¯ä»¥çŸ¥é“</strong><span class="math inline">\(\nabla \log p_t(x)\)</span>ï¼Œ<strong>é‚£ä¹ˆå°±å¯ä»¥æŠŠSDE è½¬åŒ–æˆ ODEã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬çŸ¥é“</strong><span class="math inline">\(\nabla\log p_t(x)\)</span><strong>, é‚£ä¹ˆæˆ‘ä»¬ä»Flow Model å¾—å‡ºæ¥çš„ç»“è®ºå¾ˆå®¹æ˜“ç›´æ¥æ¨å¹¿åˆ° Diffusion Model</strong></p><h3 id="example-3">Example</h3><p>æˆ‘ä»¬ä»ç„¶ä»¥ OU Process æ¥è¯´æ˜è¿™ä¸ªè¿‡ç¨‹ã€‚</p><p>æˆ‘ä»¬å¯ä»¥æ ¹æ®ä¸Šé¢çš„è¿™ä¸ªå®šç†çŸ¥é“ï¼ŒOU Process å¯¹åº”çš„ ODEåº”è¯¥å¯ä»¥å†™æˆè¿™ç§å½¢å¼ï¼š</p><p><span class="math display">\[dZ_t=-\theta Z_tdt-\frac{1}{2}\sigma^2\partial_z\log p_t(Z_t)dt\]</span></p><p>å¦‚æœ<span class="math inline">\(p_{init}\)</span>æ˜¯ä¸€ä¸ªé«˜æ–¯åˆ†å¸ƒçš„è¯ï¼Œæ¯”å¦‚<span class="math inline">\(X_0\sim\mathcal{N}(\mu_0,\sigma_0)\)</span>ï¼Œæˆ‘ä»¬çŸ¥é“<span class="math inline">\(X_t\)</span>ä¹Ÿæ˜¯æœä»ä¸€ä¸ªé«˜æ–¯åˆ†å¸ƒï¼š</p><p><span class="math display">\[X_t\sim\mathcal{N}(\mu_t,\sigma_t),\mu_t=\mu_0e^{-\thetat},\sigma_t^2=\sigma_0^2e^{-2\thetat}+\frac{\sigma^2}{2\theta}(1-e^{-2\theta t})\]</span></p><p>æˆ‘ä»¬å¯ä»¥çŸ¥é“å…¶å¯¹åº”çš„ ODE æ˜¯ï¼š</p><p><span class="math display">\[dZ_t = -\theta Z_t dt+\frac{\sigma^2}{2}\frac{Z_t-\mu_t}{\sigma_t^2}dt\]</span></p><p>ä¸‹é¢æ˜¯é€šè¿‡ä¸€ä¸ª Python ç¨‹åºæ¥æè¿°äº†è¿™ä¸ªè¿‡ç¨‹ã€‚<!-- ![](./flow/sde_ode_animation.mp4) --><!-- <iframe height=498 width=510 src="sde_ode_animation.mp4"> --><video src="sde_ode_animation.mp4" controls="" width="100%">æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒ video æ ‡ç­¾ã€‚ </video></p><h3 id="section-2"></h3><h2 id="reversed-time-sde">Reversed Time SDE</h2><blockquote><p><strong>Reversed Time SDE</strong> å¯¹äºä¸€ä¸ªSDE: <span class="math display">\[dX_t=f(X_t, t)dt+g(X_t,t)dW_t\]</span><span class="math inline">\(t\)</span>ä»<span class="math inline">\(0\)</span>åˆ°<span class="math inline">\(1\)</span>çš„æ¼”åŒ–ç”¨è¿™ä¸ªæ–¹ç¨‹æè¿°ã€‚é‚£ä¹ˆ<span class="math inline">\(\tau:=1-t\)</span>ä»<span class="math inline">\(1\)</span>åˆ°<span class="math inline">\(0\)</span>çš„æ¼”åŒ–ï¼Œåˆ™å¯ä»¥ç”¨ä¸‹é¢çš„æ–¹ç¨‹æè¿°: <span class="math display">\[d\overleftarrow{X}_{\tau}=\overleftarrow{f}(\overleftarrow{X}_{\tau},\tau)d\tau+g(\overleftarrow{X}_{\tau},\tau)dW_{\tau},\\\overleftarrow{f}(x,\tau)=-f(x,t)+\nabla(g(x,\tau)g(x,\tau)^T)+g(x,\tau)g(x,\tau)^T\nabla\logp_{\tau}(x)\]</span></p></blockquote><p>å…³äºä¸Šé¢çš„å®šç†çš„è¯æ˜ï¼Œä¸€èˆ¬éƒ½æ˜¯é‡‡ç”¨ Kolmogorov Forward Equation å’ŒKolmogorov Backward Equation å»è·å¾—<span class="math inline">\(p(x,t|y,s)\)</span>è¿™æ ·çš„è”åˆåˆ†å¸ƒï¼Œç„¶ååœ¨æ±‚å¾—å¯¹åº”çš„è¾¹é™…åˆ†å¸ƒã€‚æ•´ä½“æ­£é¢æ€è·¯ç¨æ˜¾å¤æ‚ï¼Œè¿™è¾¹å€ŸåŠ©Fokker-Planck Equation åœ¨é™„å½•ç»™å‡ºä¸€ä¸ªç¨å¾®ç®€å•ç‚¹çš„æ•°å­¦è¯æ˜ã€‚</p><h3 id="example-4">Example</h3><p>æˆ‘ä»¬è¿™è¾¹ä»ç„¶ä»¥ç®€å•çš„ OU Process ä½œä¸ºä¾‹å­æ¥é˜è¿°ä¸Šé¢è¿™ä¸ªå®šç†ã€‚å¯¹äº OUProcessï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼š</p><p><span class="math display">\[\overleftarrow{f}(x,\tau)=\theta x - \sigma^2 \frac{x-\mu_{1-\tau}}{\sigma_{1-\tau}^2}\]</span></p><p>æˆ‘ä»¬é€šè¿‡ä¸€äº› Python ä»£ç å»å¯è§†åŒ–ï¼Œä¸Šé¢è¿™ä¸ªè¿‡ç¨‹ç¡®å®æ˜¯åå‘è¿‡ç¨‹ï¼š</p><img src="/2025/06/30/flow/reversed_time_sde.png" class="" width="400" title="Flow ODE"><p>ä»ä¸‹é¢è¿™ä¸ªåˆ†å¸ƒä¸Šçœ‹ï¼Œæˆ‘ä»¬å¯ä»¥æ˜æ˜¾çœ‹åˆ°åå‘è¿‡ç¨‹åœ¨<span class="math inline">\(\tau\)</span>æ—¶åˆ»çš„åˆ†å¸ƒå’Œæ­£å‘è¿‡ç¨‹åœ¨ <span class="math inline">\(1-\tau\)</span> æ—¶åˆ»çš„åˆ†å¸ƒæ˜¯ä¸€æ ·çš„ã€‚</p><p>ä¸è¿‡æˆ‘ä»¬æ³¨æ„åˆ°ä¸€ä¸ªéå¸¸æœ‰æ„æ€çš„ç‚¹ï¼Œä»è¿™å¼ å›¾çš„ä¸ŠåŠéƒ¨åˆ†ï¼Œå¯ä»¥çœ‹åˆ°åå‘è¿‡ç¨‹ï¼Œç¥å¥‡åœ°é‡æ–°æ”¶æ•›å›<span class="math inline">\(x_0\)</span>ï¼Œæ— è®ºæ˜¯ä½ ä»æ€ä¹ˆæ ·çš„<span class="math inline">\(x_1\)</span>å¼€å§‹å»åšè¿™ä¸ªæ–¹å‘è¿‡ç¨‹ã€‚</p><p>æˆ‘ä»¬è¿™è¾¹å¯¹äºæ­¤ï¼Œç»™å‡ºä¸€ä¸ªæ¯”è¾ƒç®€å•æ˜¯ç²—ç³™çš„åˆ†æï¼Œè¿™ä¸ªç°è±¡æ˜¯å¦‚ä½•å‘ç”Ÿçš„ã€‚æˆ‘æŠŠ<span class="math inline">\(\overleftarrow{f}(x,\tau)\)</span>åœ¨<span class="math inline">\(\tau=1\)</span>å¤„åšå±•å¼€ï¼Œå…¶ç­‰ä»·äº<span class="math inline">\(\overleftarrow{f}(x,t)\)</span> åœ¨<span class="math inline">\(t=0\)</span>å¤„åšå±•å¼€ã€‚</p><p><span class="math display">\[\overleftarrow{f}(x,t)=\theta x - \frac{2\theta(x-x_0e^{-\thetat})}{1-e^{-2\theta t}}\approx \theta x -\frac{2\theta(x-x_0+x_0\thetat)}{2\theta t} \sim \frac{x-x_0}{t}\]</span></p><p>åœ¨<span class="math inline">\(t\sim0\)</span>çš„æ—¶å€™ï¼Œä¼šæœ‰ä¸€ä¸ªæ— ç©·å¤§çš„åŠ›ï¼Œå°†å…¶æ‹½å›<span class="math inline">\(x_0\)</span>.</p><h3 id="section-3"></h3><h1 id="ç¥ç»ç½‘ç»œçš„å¼•å…¥">ç¥ç»ç½‘ç»œçš„å¼•å…¥</h1><p>å½“ç„¶åœ¨ AIGC é¢†åŸŸï¼Œä¸€èˆ¬ä¸ä¼šè€ƒè™‘ä¸Šé¢è¿™ä¹ˆå¤æ‚çš„SDEï¼Œå…¶å¾€å¾€è€ƒè™‘ç®€å•çš„å„å‘åŒæ€§çš„SDEï¼Œåç»­çš„è®¨è®ºï¼Œæˆ‘ä»¬ä¹Ÿå°†åªè®¨è®ºä¸‹é¢è¿™å¼ ç¨å¾®ç®€åŒ–ç‚¹çš„ç‰ˆæœ¬:</p><p><span class="math display">\[dX_t=f(X_t,t)dt+\sigma_t dW_t\]</span></p><p>å½“<span class="math inline">\(\sigma_t\equiv 0\)</span>çš„æ—¶å€™ï¼Œå›é€€åˆ°Flow Model.</p><p>æœ‰äº†ä¸Šé¢çš„åŸºç¡€çš„æ¦‚å¿µï¼Œæˆ‘ä»¬çŸ¥é“äº†ä¸€ä»¶äº‹æƒ…ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦ç»™<span class="math inline">\(p_{init}\)</span>å’Œ<span class="math inline">\(p_{target}\)</span>è¿™ä¸¤ä¸ªåˆ†å¸ƒï¼Œæ‰¾å‡ºä¸€ä¸ªè¿æ¥çš„æ¡¥æ¢ï¼Œé‚£ä¹ˆåªéœ€è¦æ‰¾å‡ºæ»¡è¶³ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„ODE(Flow Model)æˆ–è€… SDE(DiffusionModel)ã€‚ä½†æ˜¯æ¯”è¾ƒå›°éš¾çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ€ä¹ˆæ‰¾åˆ°è¿™äº›çš„ SDE æˆ–è€… ODEå‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™å°±ç¥ç»ç½‘ç»œçš„ç™»åœºçš„æ—¶å€™ï¼Œå½“æˆ‘ä»¬ä¸çŸ¥é“å…·ä½“çš„åŠ¨åŠ›å­¦æ–¹ç¨‹è¯¥æ€ä¹ˆå†™çš„æ—¶å€™ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨ç¥ç»ç½‘ç»œä»£æ›¿ä»–ï¼Œç„¶åæ‰¾åˆ°ä¸€ä¸ªå¥½çš„Loss å»ä¼˜åŒ–ã€‚</p><p>ç¬¬ä¸€æ­¥ï¼Œ</p><p>æ—¢ç„¶ä¸çŸ¥é“ä»€ä¹ˆæ ·çš„<span class="math inline">\(f(X_t,t)\)</span>å¯ä»¥æ­£ç¡®è¿æ¥<span class="math inline">\(p_{init}\)</span>å’Œ<span class="math inline">\(p_{target}\)</span>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ç”¨ç¥ç»ç½‘ç»œä»£æ›¿ä»–ï¼Œ</p><p><span class="math display">\[dX_t=f_{\theta}(X_t,t)dt+\sigma_t dW_t\]</span></p><p>ç¬¬äºŒæ­¥ï¼Œæˆ‘ä»¬éœ€è¦æ„é€ æ€ä¹ˆæ ·çš„ Loss æ¥è®­ç»ƒ<span class="math inline">\(f_{\theta}(x,t)\)</span>å‘¢ã€‚è¿™è¾¹å¾ˆè‡ªç„¶åœ°ä¼šæƒ³åˆ°:</p><ul><li>ç›´æ¥æ‰¾åˆ°<span class="math inline">\(f(x,t)\)</span>å¯¹åº”çš„å€¼<span class="math inline">\(\tilde{f}(x,t)\)</span>ï¼Œç„¶åä½¿ç”¨ MSE Losså»æ‹Ÿåˆ:</li></ul><p><span class="math display">\[\min_{\theta}\mathbb{E}_{X_t}[\|f_{\theta}(X_t,t)-\tilde{f}(X_t,t)\|^2]\]</span></p><h3 id="flow-model-1">Flow Model</h3><p>é¦–å…ˆç›´æ¥æƒ³è¦çŸ¥é“<span class="math inline">\(\tilde{f}(x,t)\)</span>é•¿ä»€ä¹ˆæ ·å­æ˜¯éå¸¸å›°éš¾çš„ï¼Œå› ä¸ºä¸å¤ªçŸ¥é“<span class="math inline">\(p_{target}\)</span>ï¼ˆå³<span class="math inline">\(p_{data}\)</span>ï¼‰å…·ä½“æ˜¯ä»€ä¹ˆæ ·å­ã€‚ä½†æ˜¯å¦‚æœå¯¹äºæŸä¸ªæ ·æœ¬<span class="math inline">\(z \simp_{data}\)</span>ï¼Œå¥½åœ¨æˆ‘ä»¬æ˜¯æ¯”è¾ƒå®¹æ˜“çŸ¥é“<span class="math inline">\(\tilde{f}(x,t|z)\)</span>æ˜¯ä»€ä¹ˆæ ·å­çš„ã€‚</p><blockquote><p><strong>Gaussian Probability Path</strong>å…·ä½“ä¸ªç®€å•çš„ä¾‹å­ï¼Œå‡è®¾åˆå§‹åˆ†å¸ƒæ˜¯ä¸€ä¸ªé«˜æ–¯åˆ†å¸ƒå¹¶ä¸”<span class="math inline">\(\sigma_t=0\)</span>ï¼Œæˆ‘ä»¬å¯ä»¥å‡è®¾åˆ†å¸ƒå‡½æ•°<span class="math inline">\(p_t(x|z)\)</span>ç”±ä¸‹é¢çš„å½¢å¼ç»™å‡ºæ¥ï¼š <span class="math display">\[x_t=\alpha_t z + \beta_t \epsilon, \epsilon \sim\mathcal{N}(0,I_d), \\\alpha_0:=0,\alpha_1:=1,\beta_0:=1,\beta_1:=0\\x_t \sim p_t(x|z)\]</span> å¾ˆæ˜¾ç„¶ä¸Šé¢è¿™ä¸ªè¿‡ç¨‹æ»¡è¶³<span class="math inline">\(p_0(x|z)=\mathcal{N}(0,I_d),p_1(x|z)=\delta(x-z)\)</span>,é‚£ä¹ˆï¼š <span class="math display">\[p_0(x)=\intp_{data}(z)\mathcal{N}(0,I_d)dz = \mathcal{N}(0,I_d),\\p_1(x)=\int p_{data}(z)\delta(x-z)dz = p_{data}(x)\]</span>å› æ­¤è¿™æ˜¯ä¸€ä¸ªåˆç†çš„æ„é€ ã€‚ é‚£ä¹ˆå¯¹äºè¿™æ ·çš„æ„é€ ï¼Œå®ƒå¯¹åº”çš„<span class="math inline">\(\tilde{f}(x,t|z)\)</span>é•¿ä»€ä¹ˆæ ·å­å‘¢ã€‚é‚£ä¹ˆåªéœ€è¦ç®€å•å°†ä¸Šé¢çš„è¿‡ç¨‹å¸¦å…¥ODE,<span class="math display">\[\tilde{f}(x_t,t|z)=\frac{dx_t}{dt}=\dot{\alpha_t}z+\dot{\beta_t}\epsilon\]</span>é‚£ä¹ˆæ‰¾å‡ºå‡½æ•°<span class="math inline">\(\tilde{f}\)</span>æ»¡è¶³ä¸Šè¿°çš„æ–¹ç¨‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬çŸ¥é“<span class="math inline">\(x_t=\alpha_t z+\beta_t \epsilon\)</span>,ç»è¿‡ç®€å•çš„è°ƒæ•´æˆ‘ä»¬å°±çŸ¥é“ï¼š <span class="math display">\[\tilde{f}(x_t,t|z)=\dot{\alpha_t}z+\dot{\beta_t}\epsilon=\dot{\alpha_t}z+\dot{\beta_t}\frac{x_t-\alpha_tz}{\beta_t}=(\dot{\alpha_t}-\frac{\dot{\beta_t}}{\beta_t}\alpha_t)z+\frac{\dot{\beta_t}}{\beta_t}x_t\]</span></p></blockquote><p>é‚£ä¹ˆå½“æˆ‘ä»¬æœ‰äº†<span class="math inline">\(\tilde{f}(x,t|z)\)</span>ï¼Œæˆ‘ä»¬æ‰èƒ½çŸ¥é“<span class="math inline">\(f(x,t)\)</span>å‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™ Fokker-Planckå°±å¯ä»¥æ´¾ä¸Šç”¨åœºäº†ã€‚æˆ‘ä»¬çŸ¥é“<span class="math inline">\(f(x,t)\)</span>ï¼Œéœ€è¦æ»¡è¶³ä¸‹é¢çš„æ–¹ç¨‹:</p><p><span class="math display">\[\frac{dp_t(x)}{dt}=-\nabla\cdot(\tilde{f}(x,t)p_t(x))\]</span></p><p>è€Œæ–¹ç¨‹å·¦è¾¹å¯ä»¥å†™æˆ</p><p><span class="math display">\[\frac{dp_t(x)}{dt}=\int \frac{dp_t(x|z)}{dt}p_{data}(z)dz \\= -\int \nabla \cdot (p_t(x|z)\tilde{f}(x,t|z))p_{data}(z)dz \\= -\nabla \cdot \int p_t(x)\frac{p_t(x|z)}{p_t(x)}\tilde{f}(x,t|z)p_{data}(z)dz\]</span></p><p>å¯¹æ¯”è¿™ä¸¤ä¸ªæ–¹ç¨‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥çŸ¥é“ï¼š</p><p><span class="math display">\[\tilde{f}(x,t)=\int \tilde{f}(x,t|z)\frac{p_t(x|z)}{p_t(x)}p_{data}(z)dz\]</span></p><p>å› æ­¤ï¼Œå¯¹åº”çš„ Loss å¯ä»¥å†™ä½œå¦‚ä¸‹çš„å½¢å¼ï¼š</p><p><span class="math display">\[\mathcal{L}=\mathbb{E}_{t,x\simp_t(x)}\left[\left(f_{\theta}(x,t)-\tilde{f}(x,t)\right)^2\right]\]</span></p><p>ä½†æ˜¯ä¸Šé¢è¿™ä¸ª Lossï¼Œå®é™…ä¸Šä¸å¤ªå¯ä»¥ä½¿ç”¨ï¼Œå› ä¸º<span class="math inline">\(\tilde{f}(x,t)\)</span>éœ€è¦æˆ‘ä»¬å¯¹<span class="math inline">\(p_{data}(z)\)</span>è¿™ä¸ªå®é™…æˆ‘ä»¬ä¸çŸ¥é“çš„åˆ†å¸ƒè¿›è¡Œç§¯åˆ†ã€‚å› æ­¤åœ¨å®é™…æ“ä½œçš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€å¯¹æ•°æ®è¿›è¡Œé‡‡æ ·ï¼Œå»è¿‘ä¼¼è¿™ä¸ªç§¯åˆ†ï¼š</p><p><span class="math display">\[\mathcal{L}_{cond}=\mathbb{E}_{t,z\sim p_{data}, x\simp_t(x|z)}\left[\left(f_{\theta}(x,t)-\tilde{f}(x,t|z)\right)^2\right]\]</span></p><h3 id="diffusion-model-1">Diffusion Model</h3><p>é‚£ä¹ˆæ ¹æ® <a href="https://i0imzi7wrro.feishu.cn/docx/XwWvdDoEroTVWEx5u3rc6uukndc#share-QCMsdYCl7ouEcpx0R5ocP8k6nwc">Flowand Diffusion Models</a>ï¼Œæˆ‘ä»¬ç›´æ¥å°† Flow Model å’Œ Diffusion Modelè¿æ¥èµ·æ¥ã€‚å¦‚æœæˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ‰¾åˆ°ä¸€ä¸ª SDE<span class="math inline">\(dX_t=F(X_t,t)dt+\sigma_tdW_t\)</span>ï¼Œä½¿å¾—å…¶åœ¨<span class="math inline">\(t\)</span>æ—¶åˆ»çš„æ¦‚ç‡åˆ†å¸ƒä¸º<span class="math inline">\(p_t(x)\)</span>é‚£ä¹ˆå¯ä»¥çŸ¥é“ï¼š</p><p><span class="math display">\[F(x,t)=f(x,t)+\frac{1}{2}\sigma_t^2\nabla \log p_t(x)\]</span></p><p>å¯¹äº<span class="math inline">\(f(x,t)\)</span>ç›¸å…³çš„ Loss åˆ™æ˜¯å’Œä¸Šé¢Flow Model æ˜¯ä¸€æ ·çš„ã€‚é‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦å¦å¤–ä¸€ä¸ªç¥ç»ç½‘ç»œ<span class="math inline">\(s_{\theta}(x,t)\)</span>å»æ‹Ÿåˆ<span class="math inline">\(\nablap_t(x)\)</span>ã€‚ç±»ä¼¼ä¸Šé¢çš„æ¨å¯¼ï¼Œæˆ‘ä»¬å¯ä»¥æ¡ä»¶ Lossï¼š</p><p><span class="math display">\[\mathcal{L}_{cond}^{score}=\mathbb{E}_{t,z\sim p_{data}, x\simp_t(x|z)}\left[\left(s_{\theta}(x,t)-\nabla \log p_t(x)\right)^2\right]\]</span></p><blockquote><p><strong>Gaussian Probability Pathè®­ç»ƒè¿‡ç¨‹</strong>å¯¹äºGPPè¿™ç§è¿‡ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼š <span class="math display">\[\mathcal{L}_{cond}=\mathbb{E}_{t,z\sim p_{data},x\simp_t(x|z)}\left[\left\|f_{\theta}(x,t)-(\dot{\alpha_t}-\frac{\dot{\beta_t}}{\beta_t}\alpha_t)z-\frac{\dot{\beta_t}}{\beta_t}x\right\|^2\right]\\\mathcal{L}_{cond}^{score}=\mathbb{E}_{t,z\sim p_{data}, x\simp_t(x|z)}\left[\left\|s_{\theta}(x,t)+\frac{x-\alpha_tz}{\beta_t^2}\right\|^2\right]\]</span>å…³äºä¸Šé¢è¿™ä¸ªLossï¼Œæˆ‘ä»¬å¯ä»¥æ¢ä¸¤ä¸ªè§’åº¦å»çœ‹å¾…ã€‚ç¬¬ä¸€ï¼Œæˆ‘ä»¬å¯ä»¥ä»å™ªå£°çš„è§’åº¦å»çœ‹ï¼Œ<span class="math inline">\(x \simp_t(x|z)\)</span>ï¼Œ<span class="math inline">\(x\)</span>ä»è¿™ä¸ªåˆ†å¸ƒé‡Œé¢å»é‡‡æ ·ï¼ŒçœŸæ­£å†³å®š<span class="math inline">\(x\)</span>å€¼çš„å…¶å®å°±æ˜¯é«˜æ–¯é€ æˆ<span class="math inline">\(\epsilon\)</span>é€šè¿‡<span class="math inline">\(x_t=\alpha_t z+\beta_t\epsilon\)</span>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°†ä¸Šé¢çš„Lossé‡æ–°è¡¨ç¤ºæˆ: <span class="math display">\[\mathcal{L}_{cond}^{score}=\mathbb{E}_{t,z\simp_{data},\epsilon \sim\mathcal{N}(0,I_d)}\left[\left\|s_{\theta}(x,t)+\frac{\epsilon}{\beta_t}\right\|^2\right]\]</span>è€Œä¼ ç»ŸDiffusion Modelçš„Lossï¼Œå¸¸å¸¸å†™æˆå¦‚ä¸‹çš„å½¢å¼ï¼š <span class="math display">\[\mathcal{L}_{SD}=\mathbb{E}_{t,z,\epsilon}\left[\left\|\epsilon_{\theta}(x_t,t)-\epsilon\right\|^2\right]\]</span><strong>è¿™è¾¹æˆ‘ä»¬å°±å¯ä»¥çœ‹å‡ºæ¥ï¼šScore Matchingå’ŒDiffusionModelåŸæœ¬ä½¿ç”¨variational lower boundè¿™ç§è¿‘ä¼¼æ–¹æ³•ï¼Œæ®Šé€”åŒå½’äº†ã€‚</strong>ç¬¬äºŒï¼Œè§‚å¯Ÿåˆ°å¯¹äºGPPæ¥è¯´, <span class="math display">\[(\dot{\alpha_t}-\frac{\dot{\beta_t}}{\beta_t}\alpha_t)z+\frac{\dot{\beta_t}}{\beta_t}x_t=\dot{\alpha_t}z+\dot{\beta_t}\epsilon=\frac{\dot{\alpha_t}}{\alpha_t}x_t-(\frac{\dot{\alpha_t}}{\alpha_t}\beta_t-\dot{\beta_t})\epsilon\]</span>é‚£ä¹ˆï¼Œè¿™ä¸ªæ˜¯å¦‚æœæˆ‘ä»¬è®­ç»ƒå‡ºæ¥äº†ä¸€ä¸ªå¾ˆå¥½çš„score function,<span class="math inline">\(s_{\theta}(x,t)\)</span>å¯ä»¥å¾ˆå¥½æ‹Ÿåˆ<span class="math inline">\(\epsilon\)</span>,é‚£ä¹ˆæˆ‘ä»¬ä¸å†éœ€è¦è®­ç»ƒé¢å¤–çš„<span class="math inline">\(f_{\theta}(x,t)\)</span>ã€‚<strong>æ¢å¥è¯è¯´ï¼šå¯¹äºGPPæ¥è¯´ï¼Œåªéœ€è¦åšScore matchingï¼Œè®­ç»ƒ<span class="math inline">\(s_{\theta}(x,t)\)</span>å°±è¶³å¤Ÿäº†ã€‚</strong></p></blockquote><h1 id="ç¦»æ•£æ—¶é—´çš„-diffusion-model">ç¦»æ•£æ—¶é—´çš„ Diffusion Model</h1><h2 id="ddpm-ç®€ä»‹">DDPM ç®€ä»‹</h2><p>åœ¨ Diffusion Model åˆšåˆšåœ¨ AIGCé¢†åŸŸå…´èµ·çš„æ—¶å€™ï¼Œæ•´ä½“çš„æè¿°è¯­è¨€ï¼Œå¹¶ä¸æ˜¯ä¸Šé¢è¿™æ ·ã€‚è€Œæ˜¯ä»¥ç¦»æ•£æ—¶é—´çš„å¸ƒæœ—è¿åŠ¨æ¥æè¿°ï¼Œæ•´ä¸ªè¿‡ç¨‹åˆ†ä¸ºï¼š</p><ul><li>Forward Diffusion Processï¼ˆå‰å‘è¿‡ç¨‹ï¼‰</li><li>Reverse Diffusion Process ï¼ˆé€†å‘è¿‡ç¨‹ï¼‰</li></ul><p>å…·ä½“çš„æè¿°å¯ä»¥å‚è€ƒä¸‹é¢è¿™ä¸ªéå¸¸å¥½çš„ Blogï¼š<a href="https://lilianweng.github.io/posts/2021-07-11-diffusion-models/">https://lilianweng.github.io/posts/2021-07-11-diffusion-models/</a></p><p>æˆ‘ä»¬è¿™è¾¹åªé™ˆåˆ—ä¸€äº› Notation å’Œé‡è¦çš„ç»“è®ºã€‚</p><h3 id="forward-diffusion-process">Forward Diffusion Process</h3><p><span class="math display">\[x_0\to x_1 \to x_2 \to \cdots x_N \to \cdots\]</span></p><p>æ¯ä¸€æ­¥ä½¿ç”¨ä¸€ä¸ª Gaussian éšæœºå˜é‡å»åŠ å™ª:</p><p><span class="math display">\[x_n=\sqrt{\alpha_n}x_{n-1}+\sqrt{1-\alpha_n}\epsilon;x_0 \simp_{data},x_{+\infty}\sim \mathcal{N}(0,I_d)\]</span></p><p>è¿™è¾¹æˆ‘ä»¬å…¨éƒ¨ä½¿ç”¨<span class="math inline">\(n\)</span>ä»£æ›¿ï¼Œå› ä¸ºæ•´ä¸ªè¿‡ç¨‹æ˜¯ç¦»æ•£çš„ã€‚åŒæ—¶åˆ©ç”¨Gaussian åˆ†å¸ƒçš„å…³ç³»ï¼Œ<span class="math inline">\(x_n,x_0\)</span>ä¹‹é—´çš„å…³ç³»å¯ä»¥è¡¨ç¤ºä¸º:</p><p><span class="math display">\[x_n=\sqrt{\bar{\alpha}_n}x_0+\sqrt{1-\bar{\alpha}_n}\epsilon,\bar{\alpha}_n=\prod_{i=1}^n\alpha_i\]</span></p><h3 id="reverse-diffusion-process">Reverse Diffusion Process</h3><p><span class="math display">\[\cdots \to x_N \to x_{N-1} \to \cdots x_1 \to x_0\]</span></p><p>åœ¨ç»™å®š<span class="math inline">\(x_0\)</span>çš„æ—¶å€™ï¼Œå¯ä»¥å¾—åˆ°é€†å‘çš„æ¡ä»¶åˆ†å¸ƒ:</p><p><span class="math display">\[p(x_{n-1}|x_n,x_0) \sim\mathcal{N}(\tilde{\mu}(x_n,x_0),\tilde{\sigma}_n I_d),\\\tilde{\mu}(x_n,x_0)=\frac{\sqrt{\alpha_n}(1-\bar{\alpha}_{n-1})}{1-\bar{\alpha}_n}x_n+\frac{\sqrt{\bar{\alpha}_{n-1}}\beta_n}{1-\bar{\alpha}_n}x_0=\frac{1}{\sqrt{\alpha_n}}\left(x_n-\frac{1-\alpha_n}{\sqrt{1-\bar{\alpha}_n}}\epsilon\right),\\\tilde{\sigma}_n=\frac{1-\bar{\alpha}_{n-1}}{1-\bar{\alpha}_n}\beta_n\]</span></p><h3 id="æŸå¤±å‡½æ•°">æŸå¤±å‡½æ•°</h3><p>ç®€åŒ–è¿‡åçš„æŸå¤±å‡½æ•°</p><p><span class="math display">\[\mathcal{L}_{simple}=\mathbb{E}_{n,x_0,\epsilon_n}\left[\left\|\epsilon_{\theta}(\sqrt{\bar{\alpha}_n}x_0+\sqrt{1-\bar{\alpha}_n}\epsilon_n,n)-\epsilon_n\right\|^2\right]\]</span></p><h2 id="ddim">DDIM</h2><h3 id="ddim-çš„è¿›æ­¥ä¹‹å¤„">DDIM çš„è¿›æ­¥ä¹‹å¤„</h3><p>å½“ç„¶ DDPM æ•´ä¸ªè¿‡ç¨‹ï¼Œæœ€æ ¸å¿ƒçš„ç‚¹æ˜¯ï¼Œç»™å®šä¸€ä¸ª<span class="math inline">\(n\)</span>ï¼Œé‚£ä¹ˆéšæœºå˜è„¸<span class="math inline">\(X_n\)</span>éœ€è¦æ»¡è¶³å¦‚ä¸‹çš„åˆ†å¸ƒï¼š</p><p><span class="math display">\[x_n\sim\mathcal{N}(\sqrt{\bar{\alpha}_n}x_0,\sqrt{1-\bar{\alpha}_n}I_d)\]</span></p><p>åœ¨ DDPMä¸­æ•´ä¸ªè¿‡ç¨‹éƒ½æ˜¯é©¬å°”å¯å¤«çš„ã€‚ä½†æ˜¯å®é™…ä¸Šï¼Œå¦‚æœåªæ˜¯æ»¡è¶³ä¸Šé¢è¿™ä¸ªåˆ†å¸ƒçš„è¯ï¼Œé‚£æ•´ä¸ªè¿‡ç¨‹ä¸ä¸€å®šéœ€è¦é©¬å°”å¯å¤«çš„ã€‚å¯ä»¥è¯æ˜çš„æ˜¯ï¼Œå¦‚æœ</p><p><span class="math display">\[p(x_{n-1}|x_n,x_0)=\mathcal{N}\left(\sqrt{\bar{\alpha}_{n-1}}x_0+\sqrt{1-\bar{\alpha}_{n-1}-\sigma_n}\frac{x_n-\sqrt{\bar{\alpha}_n}x_0}{\sqrt{1-\bar{\alpha}_n}},&nbsp;\sigma_nI_d\right)\]</span></p><p>é‚£ä¹ˆä¸Šé¢çš„è¿‡ç¨‹åˆ†å¸ƒå°±èƒ½è¢«æ»¡è¶³ã€‚</p><p>ç¬¬ä¸€ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¦‚æœ<span class="math inline">\({\sigma}_n=\frac{1-\bar{\alpha}_{n-1}}{1-\bar{\alpha}_n}\beta_n\)</span>ï¼Œé‚£ä¹ˆè¿™ä¸ªè¡¨è¾¾å¼åˆ™å›é€€åˆ°DDPM çš„æƒ…å†µã€‚</p><p>ç¬¬äºŒï¼Œå¦‚æœæˆ‘ä»¬ä»¤<span class="math inline">\(\sigma_n\equiv0\)</span>ï¼Œé‚£ä¹ˆï¼Œ</p><p><span class="math display">\[p(x_{n-1}|x_n,x_0)=\delta_{x_{n-1}}\left(\sqrt{\bar{\alpha}_{n-1}}x_0+\sqrt{1-\bar{\alpha}_{n-1}}\frac{x_n-\sqrt{\bar{\alpha}_n}x_0}{\sqrt{1-\bar{\alpha}_n}}\right)=\delta_{x_{n-1}}\left(\sqrt{\bar{\alpha}_{n-1}}x_0+\sqrt{1-\bar{\alpha}_{n-1}}\epsilon\right)\]</span></p><p>å˜æˆäº†ä¸€ä¸ªç¡®å®šæ€§çš„è¿‡ç¨‹ã€‚</p><p>ç¬¬ä¸‰ï¼ŒåŒæ—¶ç”Ÿæˆçš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ³¨æ„åˆ°ä¸€ä»¶éå¸¸å¥½çš„äº‹æƒ…ã€‚åŠ å…¥æˆ‘ä»¬å·²ç»è®­ç»ƒå¥½äº†<span class="math inline">\(\epsilon_{\theta}\)</span>ï¼Œæˆ‘ä»¬ä¸éœ€è¦åƒ DDPMé‚£æ ·ï¼Œå…ˆä» Gaussion ä¸­é‡‡æ ·ä¸€ä¸ª<span class="math inline">\(x_N\)</span>ç„¶åä¸€æ­¥ä¸€æ­¥çš„ä½¿ç”¨<span class="math inline">\(\epsilon_{\theta}(x_n,n)\)</span>å»å»é™¤å™ªå£°ã€‚è€Œæ˜¯å¯ä»¥æ ¹æ®ä¸Šçœ‹è¿™ä¸ªè¡¨è¾¾å¼å»ä¼˜åŒ–ç”Ÿæˆçš„è¿‡ç¨‹ï¼Œå› ä¸ºæˆ‘ä»¬æ ¸å¿ƒå…³å¿ƒçš„åªæ˜¯<span class="math inline">\(p(x_{n-1}|x_n,x_0)\)</span>è¿™ä¸ªè¾¹é™…åˆ†å¸ƒã€‚é¦–å…ˆæˆ‘ä»¬å‘ç°è¦ç¡®å®š<span class="math inline">\(x_{n-1}\)</span>,ä¸ä»…è¦çŸ¥é“<span class="math inline">\(x_n\)</span>ï¼Œè¿˜è¦çŸ¥é“<span class="math inline">\(x_0\)</span>ï¼Œä½†æ˜¯åœ¨ç”Ÿæˆè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬æ˜¯ä¸çŸ¥é“<span class="math inline">\(x_0\)</span>æ˜¯å¤šå°‘çš„ï¼Œå› æ­¤æœ€ç®€å•çš„ä¸€ä¸ªåŸåˆ™ï¼Œæ˜¯ä½¿ç”¨ä¼°è®¡çš„<span class="math inline">\(\hat{x}_0\)</span>å»ä»£æ›¿ä¸Šé¢å…¬å¼çš„<span class="math inline">\(x_0\)</span>ï¼Œå› æ­¤ï¼š</p><p><span class="math display">\[x_{n-1}=\sqrt{\bar{\alpha}_{n-1}}\hat{x}_0+\sqrt{1-\bar{\alpha}_{n-1}-\sigma_n}\epsilon_{\theta}(x_{n},n)+\sigma_n\epsilon,\\\hat{x}_0=\frac{x_n-\sqrt{1-\bar{\alpha}_n}\epsilon_{\theta}(x_n,n)}{\sqrt{\bar{\alpha}_n}}\]</span></p><h2 id="ä¸-flow-model-çš„è”ç³»">ä¸ Flow Model çš„è”ç³»</h2><h3 id="ddpm">DDPM</h3><p>é¦–å…ˆæˆ‘ä»¬å…ˆåˆ†æä¸€ä¸‹ DDPMï¼Œå¯¹äº DDPM æ¥è¯´ï¼Œä»–çš„ Forward Process ä¸º:</p><p><span class="math display">\[x_n=\sqrt{\alpha_n}x_{n-1}+\sqrt{1-\alpha_n}\epsilon;x_0 \simp_{data},x_{+\infty}\sim \mathcal{N}(0,I_d)\]</span></p><p>é‚£ä¹ˆå¯¹äºä¸€ä¸ªå›ºå®šçš„<span class="math inline">\(N\)</span>ï¼Œæˆ‘ä»¬å¯ä»¥ä»¤<span class="math inline">\(t_n=\frac{n}{N},\Deltat=\frac{1}{N}\)</span>ï¼Œå°†ä¸Šé¢çš„æ–¹ç¨‹ rescale åˆ°<span class="math inline">\([0,1]\)</span>ï¼Œå› æ­¤ï¼š</p><p><span class="math display">\[x_{t+\Delta t}=\sqrt{\frac{\bar{\alpha}_{t+\Deltat}}{\bar{\alpha}_t}}x_t+\sqrt{1-\frac{\bar{\alpha}_{t+\Deltat}}{\bar{\alpha}_t}}\epsilon\]</span></p><p>å¯¹ä¸Šé¢çš„å¼å­ï¼Œåšå±•å¼€ï¼Œä¿ç•™åˆ° <span class="math inline">\(\Deltat\)</span>ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°:</p><p><span class="math display">\[dx_t=\frac{1}{2}\frac{\dot{\bar{\alpha}_t}}{\bar{\alpha}_t}x_t+\sqrt{-\frac{\dot{\bar{\alpha}_t}}{\bar{\alpha}_t}dt}\epsilon\]</span></p><p>è¿™è¾¹æˆ‘çŸ¥é“ <span class="math inline">\(\bar{\alpha}_t\)</span>æ˜¯éšç€æ—¶é—´å•è°ƒé€’å‡ï¼Œå› æ­¤ <span class="math inline">\(\dot{\bar{\alpha}}_t&lt;0\)</span>ã€‚å½“ç„¶ä¸ºäº†ä¿æŒå’ŒPaper é‡Œé¢çš„ä¸€è‡´ï¼Œå¦‚æœæˆ‘ä»¬å®šä¹‰:<span class="math inline">\(\beta_t=-\frac{d}{dt}\log\bar{\alpha}_t\)</span>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°æ¯”è¾ƒç†Ÿæ‚‰çš„Foward Process å¯¹åº”çš„ SDE:</p><p><span class="math display">\[dX_t=-\frac{1}{2} \beta_t X_t dt+\sqrt{\beta_t}dW_t\]</span></p><p>å…¶å¯¹åº”çš„ Reversed Time SDE åˆ™å¯ä»¥å†™æˆ:</p><p><span class="math display">\[d\overleftarrow{X}_{\tau}=\left(\frac{1}{2}\beta_{\tau}\overleftarrow{X}_{\tau}+\beta_{\tau}\nabla\logp_{\tau}(\overleftarrow{X}_{\tau})\right)d\tau+\sqrt{\beta_{\tau}}dW_{\tau}\]</span></p><p>æˆ–è€…ï¼š</p><p><span class="math display">\[d\overleftarrow{X}_{t}=-\left(\frac{1}{2}\beta_{t}\overleftarrow{X}_{t}+\beta_{t}\nabla\logp_{t}(\overleftarrow{X}_{t})\right)dt+\sqrt{\beta_{t}}d\overleftarrow{W}_{t}\]</span></p><p>æ ¹æ® Fokker-Planck Equationï¼Œæˆ‘ä»¬çŸ¥é“è¿™ä¸ª SDE å¯¹åº”çš„ODEï¼Œå¯ä»¥å†™æˆ:</p><p><span class="math display">\[d\overleftarrow{X}_{t}=-\frac{1}{2}{\beta}_{t}\overleftarrow{X}_{t}dt-\frac{1}{2}{\beta}_{t}\nabla\log p_{t}(\overleftarrow{X}_{t})dt\]</span></p><p>å› æ­¤è¿™ä¸ªä¼šæ˜¯ä¸Šé¢ Diffusion Model çš„ä¸€ç§ç‰¹æ®Šçš„æƒ…å†µã€‚</p><h3 id="ddim-1">DDIM</h3><p>å¦å¤–å¯¹äº DDIMï¼Œä»ç›´è§‰ä¸Šçœ‹èµ·æ¥ï¼Œå¦‚æœ<span class="math inline">\(\sigma_n\equiv&nbsp;0\)</span>ï¼Œä¸Šé¢æ•´ä¸ªç”Ÿæˆè¿‡ç¨‹ä¹Ÿæ˜¯ä¸€ä¸ªç¡®å®šæ€§çš„è¿‡ç¨‹ã€‚è€Œæˆ‘ä»¬ä¹‹å‰ä»‹ç»çš„Flow Model ä¹Ÿæ˜¯ç¡®å®šæ€§çš„ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªåœ¨æœ¬è´¨ä¸Šæ˜¯ä¸æ˜¯åŒä¸€ä¸ªäº‹æƒ…å‘¢ã€‚</p><p>æ ¹æ®ä¸Šé¢çš„æ‰‹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å°†ï¼ŒDDIM çš„ç”Ÿæˆç¦»æ•£åŒ–ï¼Œå¾—åˆ°ä¸€ä¸ª SDEã€‚</p><p>å…¶ç¦»æ•£çš„æ–¹ç¨‹ä¸º:</p><p><span class="math display">\[x_{n-1}=\sqrt{\bar{\alpha}_{n-1}}\frac{x_n-\sqrt{1-\bar{\alpha}_n}\epsilon_{\theta}(x_n,n)}{\sqrt{\bar{\alpha}_n}}+\sqrt{1-\bar{\alpha}_{n-1}}\epsilon_{\theta}(x_{n},n)\]</span></p><p>å¯¹åº”çš„è¿ç»­å±•å¼€ä¸º:</p><p><span class="math display">\[x_{t-dt}=\sqrt{\frac{\bar{\alpha}_{t-dt}}{\bar{\alpha}_t}}\left(x_t-\sqrt{1-\bar{\alpha}_t}\epsilon_{\theta}\right)+\sqrt{1-\bar{\alpha}_{t-dt}}\epsilon_\theta&nbsp;\\=&nbsp;(1-\frac{1}{2}\frac{\dot{\bar{\alpha}_t}}{\alpha_t}dt)x_t-d\sqrt{1-\bar{\alpha}_t}\epsilon_{\theta}+\frac{1}{2}\frac{\dot{\bar{\alpha}_t}}{\alpha_t}dt\sqrt{1-\bar{\alpha}_t}\epsilon_{\theta}\]</span></p><p>å½“ç„¶ï¼Œæˆ‘ä»¬åˆ©ç”¨<span class="math inline">\(\frac{d}{dt}\sqrt{1-\bar{\alpha}_t}=\frac{\dot{\bar{\alpha}}_t}{2\sqrt{1-\bar{\alpha}}_t}\)</span>,æˆ‘ä»¬æœ€ç»ˆå¯ä»¥å¾—åˆ°:</p><p><span class="math display">\[dX_t=\frac{1}{2}\frac{\dot{\bar{\alpha}}_t}{\bar{\alpha}_t}X_tdt-\frac{1}{2}\frac{\dot{\bar{\alpha}}_t}{\sqrt{1-\bar{\alpha}_t}\bar{\alpha}_t}\epsilon_{\theta}\]</span></p><p>ä½¿ç”¨ä¸Šé¢çš„ç¬¦å·:</p><p><span class="math display">\[d\overleftarrow{X}_t=-\frac{1}{2}\beta_t\overleftarrow{X}_tdt+\frac{1}{2}\frac{\beta_t}{\sqrt{1-\bar{\alpha}_t}}\epsilon_{\theta}(\overleftarrow{X}_t)\]</span></p><p>é‚£ä¹ˆå¯¹æ¯”ä¸€ä¸‹ï¼Œ<strong>æˆ‘ä»¬å°±çŸ¥é“ DDIM çš„</strong><span class="math inline">\(\epsilon_{\theta}\)</span><strong>åªéœ€è¦æ‹Ÿåˆ</strong><span class="math inline">\(-\frac{\nabla \logp_t(x)}{\sqrt{1-\alpha_t}}\)</span><strong>ï¼Œé‚£ä¹ˆæ•´ä¸ªè¿‡ç¨‹å°±æ˜¯ DDPMæ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„åŒºåˆ«ï¼Œè‡³å°‘å°±æ•´ä½“çš„åˆ†å¸ƒæƒ…å†µæ¥è¯´ã€‚è€Œä¸”äº‹å®ä¸Šï¼Œå¯¹äº GPPæ¥è¯´ï¼Œç¥ç»ç½‘ç»œå°±æ˜¯åœ¨æ‹Ÿåˆæ•´ä¸ª score function.</strong></p><h1 id="conditional-generation">Conditional Generation</h1><p>ä¸Šé¢æˆ‘ä»¬ä¸»è¦è®¨è®ºçš„è¿˜æ˜¯ï¼Œå¦‚æœå»æ„å»º<span class="math inline">\(p_{init}\)</span>åˆ°<span class="math inline">\(p_{target}\)</span>ä¹‹é—´çš„æ˜ å°„ï¼Œè¿™æ ·é€šè¿‡å¯¹äº<span class="math inline">\(p_{init}\)</span>è¿›è¡Œé‡‡ç”¨ï¼Œè¾¾åˆ°åœ¨<span class="math inline">\(p_{target}\)</span>é‡Œé¢é‡‡æ ·çš„æ•ˆæœï¼Œå³æ‰€è°“çš„ç”Ÿæˆã€‚ä½†æ˜¯åœ¨ç°å®ä¸­ï¼Œæˆ‘ä»¬åº”ç”¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬éƒ½æ˜¯è¾“å…¥ä¸€ä¸ªprompt æˆ–è€…æŸç§æ¡ä»¶ï¼Œä»¥æ­¤ä¿è¯ AIå¯ä»¥ç”Ÿæˆç¬¦åˆè¦æ±‚çš„å›¾åƒã€è§†é¢‘ï¼Œè€Œä¸æ˜¯ç›´æ¥ä»å…¨é›†ä¸­é‡‡æ ·ä¸€ä¸ªå›¾åƒæˆ–è§†é¢‘ã€‚</p><p>é‚£ä¹ˆä¸Šé¢çš„è®­ç»ƒè¿‡ç¨‹åˆ™å¯ä»¥å˜æˆ:</p><ul><li>è¾“å…¥æŸä¸€ä¸ª prompt æˆ–è€…æ¡ä»¶<span class="math inline">\(c\)</span></li><li>æ ¹æ®å¯¹åº”çš„æ¡ä»¶<span class="math inline">\(c\)</span>ï¼Œå»é‡‡æ ·ä¸€ä¸ªçœŸå®çš„æ ·æœ¬<span class="math inline">\(z_c\)</span></li><li>ä½¿ç”¨ç¥ç»ç½‘ç»œ<span class="math inline">\(f_{\theta}(x|c)\)</span>å»æ‹Ÿåˆ<span class="math inline">\(\tilde{f}(x|z_c)\)</span></li></ul><p>é‚£ä¹ˆè¿™è¾¹æˆ‘ä»¬å°±ä¼šå‘ç°ä¸€ä»¶æ¯”è¾ƒé‡è¦çš„äº‹æƒ…ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ§åˆ¶<span class="math inline">\(c\)</span>çš„é‡‡æ ·ï¼Œå»æ§åˆ¶<span class="math inline">\(z_c\)</span>çš„é‡‡æ ·ç»“æœï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å½±å“æœ€ç»ˆçš„è®­ç»ƒæ•ˆæœã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦å¯¹ä¸Šé¢çš„è¿‡ç¨‹åšä¸€ä¸ªæ‹†è§£ï¼Œæ‹†è§£æˆä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†å®Œå…¨ä¸å—<span class="math inline">\(c\)</span>é‡‡æ ·ç®—æ³•çš„å½±å“ï¼Œä¸€éƒ¨åˆ†å¯ä»¥<span class="math inline">\(c\)</span>çš„é‡‡æ ·ç®—æ³•è¿›è¡Œè°ƒæ§ã€‚</p><p>å¯¹äº GPP æ¥è¯´ï¼Œæˆ‘ä»¬çŸ¥é“<span class="math inline">\(f_{\theta}(x|c)\)</span>æ‹Ÿåˆçš„ç›®æ ‡æ˜¯<span class="math inline">\(\frac{\dot{\beta}_t}{\beta_t}x_t+(\dot{\alpha_t-\frac{\dot{\beta}_t}{\beta_t}\alpha_t})z_c\)</span>ï¼Œæˆ‘ä»¬å¯ä»¥ç»è¿‡ä¸€äº›å˜åŒ–ï¼ŒæŠŠè¿™ä¸ªé‡æ–°å†™æˆï¼š</p><p><span class="math display">\[f_{\theta}(x|c) \to \frac{\dot{\alpha}_t}{\alpha_t}x +\frac{\dot{\alpha}_t\beta_t^2-\dot{\beta}_t\beta_t\alpha_t}{\alpha_t}\nabla\log p_t(x|z_c):=A_tx+B_t\nabla\log p_t(x|z_c)\]</span></p><p>æˆ‘ä»¬è¿˜æœ‰ï¼š</p><p><span class="math display">\[\nabla\log p_t(x|z_c)=\nabla\log \frac{p(z_c|x)p(x)}{p(z_c)}=\nabla\logp(x)+\nabla \log p(z_c|x)\]</span></p><p>è¿™æ˜¯å› ä¸º<span class="math inline">\(\nabla p(z_c)=0\)</span>ã€‚</p><p>å› æ­¤,</p><p><span class="math display">\[f_{\theta}(x|c)\to A_tx+B_t\nabla\log p(x)+B_t\nabla\logp(z_c|x)=\tilde{f}(x,t)+B_t\nabla\log p(z_c|x)\]</span></p><p>ä»ä¸Šé¢è¿™ä¸ªç»“æœï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼š</p><ul><li>ç¬¬ä¸€æ­¥æ˜¯å…¨å±€çš„é€Ÿåº¦åœºå’Œä½ çš„é‡‡æ ·æ²¡æœ‰å…³ç³»</li><li>ç¬¬äºŒæ­¥åˆ™æ˜¯ç±»ä¼¼ä¸€ä¸ªåˆ†ç±»æˆ–è€… image caption çš„ä»»åŠ¡</li></ul><p>å› æ­¤å¯¹äº<span class="math inline">\(c\)</span>é‡‡æ ·ç®—æ³•å¯¹æœ€ç»ˆç»“æœçš„å½±å“ï¼Œä¸»è¦ç”±ç¬¬äºŒéƒ¨åˆ†é€ æˆã€‚å› æ­¤ï¼Œå¯ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªè¶…å‚æ•°<span class="math inline">\(\lambda\)</span>æ¥æ§åˆ¶è¿™éƒ¨åˆ†çš„å½±å“ã€‚</p><p><span class="math display">\[f_{\theta}(x|c)\to \tilde{f}(x,t)+\lambda B_t\nabla\log p(z_c|x) =\tilde{f}(x,t)+\lambda B_t(\nabla \log p(x|z_c) -\nabla\log p(x))\\f_{\theta}(x|c) \to (1-\lambda)\tilde{f}(x,t)+\lambda\tilde{f}(x,t|z_c)\]</span></p><p>ç¬¬ä¸€éƒ¨åˆ†åˆ™æ˜¯ä¸Šé¢æ²¡æœ‰æ¡ä»¶çš„æ‹Ÿåˆç›®æ ‡ï¼Œç¬¬äºŒéƒ¨åˆ†åˆ™æ˜¯æœ‰æ¡ä»¶çš„æ‹Ÿåˆç›®æ ‡ã€‚å½“ç„¶æˆ‘ä»¬ä¸éœ€è¦è®­ç»ƒä¸¤ä¸ªç½‘ç»œåˆ†åˆ«æ‹Ÿåˆï¼Œè€Œæ˜¯ç›´æ¥å¢åŠ ä¸€ä¸ª<span class="math inline">\(\empty\)</span>æ¥ä»£è¡¨ç¬¬ä¸€éƒ¨åˆ†ã€‚å› æ­¤æœ€ç»ˆçš„å®Œæ•´ç®—æ³•ï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„è¿‡ç¨‹æ¥æè¿°ï¼š</p><blockquote><p><strong>Classifier-free guidance CFM(CFG-CFM)</strong> -<strong>è®­ç»ƒ</strong>ï¼š - ä»<span class="math inline">\(p_{data}\)</span>é‡‡æ ·ä¸€ç»„<span class="math inline">\((z_c,c)\)</span> - <span class="math inline">\(t\sim Uniform[0,1]\)</span> - <span class="math inline">\(x \sim p_t(x|z_c)\)</span> - ä»¥<span class="math inline">\(p_{drop}\)</span><span class="math inline">\(ä¸¢å¼ƒæ‰æ¡ä»¶\)</span><span class="math inline">\(c\)</span><span class="math inline">\(,å³\)</span><span class="math inline">\(c=\empty\)</span> - <span class="math inline">\(\min_{\theta}\|f_{\theta}(x,t|c)-\tilde{f}(x|z_c)\|^2\)</span>- <strong>éƒ¨ç½²</strong>ï¼š - ç»™å‡ºä¸€ä¸ªæ¡ä»¶<span class="math inline">\(c\)</span> - <span class="math inline">\(x_0\simp_{init}\)</span> - ä½¿ç”¨PDEæ•°å€¼æ–¹æ³•æ±‚è§£<span class="math inline">\(dX_t=f_{\theta}(x,t|c)dt\)</span> - å¾—åˆ°<span class="math inline">\(x_1\)</span></p></blockquote><h1 id="é™„å½•">é™„å½•</h1><h2 id="reversed-time-sde-è¯æ˜">Reversed Time SDE è¯æ˜</h2><p>å¯¹äºä¸€ä¸ª SDE:<span class="math inline">\(dX_t=f(X_t,t)dX_t+g(X_t,t)dW_t\)</span>å…¶å¯¹åº”çš„Fokker-Planck Equation æ˜¯å¦‚ä¸‹çš„å½¢å¼ï¼š</p><p><span class="math display">\[\frac{dp_t(x)}{dt}=-\nabla\cdot(f(x,t)p_t(x))+\frac{1}{2}\nabla^2\cdot(g(x,t)g(x,t)^Tp_t(x))\]</span></p><p>å¦‚æœæˆ‘ä»¬å•çº¯åœ°æƒ³çŸ¥é“ï¼Œå¯¹åº”åœ° Reversed Time SDEé•¿ä»€ä¹ˆæ ·å­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç®€å•åœ°æ¢å…ƒ<span class="math inline">\(\tau=1-t\)</span>ï¼Œå¾—åˆ°ï¼š</p><p><span class="math display">\[\frac{dp_{\tau}(x)}{d\tau}=-\frac{dp_t(x)}{dt}=\nabla\cdot(f(x,\tau)p_{\tau}(x))-\frac{1}{2}\nabla^2\cdot(g(x,\tau)g(x,\tau)^Tp_{\tau}(x))\]</span></p><p>æ ¹æ®ç®€å•åœ°å‘é‡æ±‚å¯¼æ³•åˆ™:</p><p><span class="math display">\[\nabla^2\left(gg^Tp\right)=\nabla\cdot\left(\nabla(gg^Tp)\right)=\nabla\cdot\left(p\nabla(gg^T)+gg^T\nablap\right)=\nabla\cdot \left[p\left(\nabla(gg^T)+gg^T\nabla \logp\right)\right]\]</span></p><p>é‚£ä¹ˆæ ¹æ® Fokker-Planck Equation æˆ‘ä»¬å¯ä»¥çŸ¥é“ä¸‹é¢è¿™ä¸ªODEï¼Œå¯ä»¥ç”¨æ¥æè¿° Reversed Time SDE:</p><p><span class="math display">\[d\overleftarrow{X}_{\tau}=\left(-f(\overleftarrow{X}_{\tau},\tau)+\frac{1}{2}\nablag(\overleftarrow{X}_{\tau},\tau)g(\overleftarrow{X}_{\tau},\tau)^T+\frac{1}{2}g(\overleftarrow{X}_\tau,\tau)g(\overleftarrow{X}_{\tau},\tau)^T\nabla\logp_{\tau}(X_{\tau})\right)\]</span></p><p>å½“ç„¶ï¼ŒåŒæ—¶æ ¹æ® SDE å’Œ ODE çš„å…³ç³» <a href="https://i0imzi7wrro.feishu.cn/docx/XwWvdDoEroTVWEx5u3rc6uukndc#share-OR6ldY1gGoB82JxFlW4cutubnqd">Flowand Diffusion Models</a>ï¼Œå¦‚æœæˆ‘ä»¬å¢åŠ ä¸€ä¸ªéšæœºé¡¹<span class="math inline">\(gdW\)</span>,é‚£ä¹ˆæˆ‘ä»¬éœ€è¦åœ¨ shift ä¸­è¡¥å…¥:<span class="math inline">\(\frac{1}{2}\nabla(gg^T)+\frac{1}{2}gg^t\nabla \logp\)</span></p><p>å› æ­¤å®Œæ•´çš„ Reversed Time SDE å¯ä»¥å†™æˆä¸‹é¢çš„å½¢å¼:</p><p><span class="math display">\[d\overleftarrow{X}_{\tau}=\overleftarrow{f}(\overleftarrow{X}_{\tau},\tau)d\tau+g(\overleftarrow{X}_{\tau},\tau)dW_{\tau},\\\overleftarrow{f}(x,\tau)=-f(x,t)+\nabla(g(x,\tau)g(x,\tau)^T)+g(x,\tau)g(x,\tau)^T\nabla\log p_{\tau}(x)\]</span></p><h2 id="ou-process-å¯¹åº”çš„-fpe-çš„è§£">OU Process å¯¹åº”çš„ FPE çš„è§£</h2><p>å¯¹äºåå¾®åˆ†æ–¹ç¨‹ï¼š</p><p><span class="math display">\[\partial_tp_t(x)=\theta\partial_x(xp_t(x))+\frac{1}{2}\sigma^2\partial_x^2p_t(x)\]</span></p><p>è¯¥ PDEè®¾è®¡åˆ°å¯¹äºç©ºé—´çš„äºŒé˜¶å¯¼æ•°ï¼Œä¸€èˆ¬ä¹ æƒ¯ä¸Šä¼šä½¿ç”¨å‚…é‡Œå¶å˜æ¢ï¼Œå°†å…¶è½¬åŒ–æˆä»£æ•°æ–¹ç¨‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å®šä¹‰</p><p><span class="math display">\[\tilde{p}_t(w):=\mathcal{F}[p_t(x)]:=\frac{1}{\sqrt{2\pi}}\intp_t(x)e^{-iwx}dx\]</span></p><p>æ ¹æ®å‚…é‡Œå¶å˜æ¢çš„åŸºæœ¬æ€§è´¨ï¼š</p><p><span class="math display">\[\mathcal{F}[xp_t(x)]=i\partial_w\tilde{p}_t(w),\mathcal{F}[\partial_x^2p_t(x)]=-w^2\tilde{p}_t(w)\]</span></p><p>å˜æ¢ä¹‹åçš„ PDEï¼Œå˜æˆäº†ï¼š</p><p><span class="math display">\[\partial_t\tilde{p}_t(w)=-\thetaw\partial_w\tilde{p}_t(w)-\frac{1}{2}\sigma^2w^2\tilde{p}_t(w)\]</span></p><p>è¯¥æ–¹ç¨‹ä¸ºä¸€é˜¶ PDEï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¼ ç»Ÿçš„è¾¾æœ—è´å°”æ–¹æ³•æ±‚è§£ï¼š</p><p><span class="math display">\[\frac{dt}{1}=\frac{dw}{\thetaw}=-2\frac{d\tilde{p}}{\sigma^2w^2\tilde{p}}\]</span></p><p>ä»å·¦è¾¹ä¸€åŠï¼Œå¯ä»¥å¾—åˆ°<span class="math inline">\(w=C_1e^{\thetat}\)</span>ï¼Œä»å³è¾¹ä¸€åŠå¯ä»¥å¾—åˆ°<span class="math inline">\(\tilde{p}=C_2e^{-\frac{\sigma^2}{4\theta}w^2}\)</span>ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥å¾—åˆ°ï¼Œä¸€ä¸ªé€šç”¨çš„è§£:</p><p><span class="math display">\[\tilde{p}_t(w)=e^{-\frac{\sigma^2w^2}{4\theta}}F(we^{-\theta t})\]</span></p><p>ä¸‹é¢æˆ‘ä»¬å°±éœ€è¦æ ¹æ®è¾¹ç•Œæ¡ä»¶å»ç¡®è®¤<span class="math inline">\(F\)</span>çš„å½¢å¼ã€‚</p><p>å¦‚æœå‡è®¾æˆ‘ä»¬çš„åˆå§‹åˆ†å¸ƒä¸º<span class="math inline">\(p_0(x)=\delta(x-x_0)\)</span>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥çŸ¥é“<span class="math inline">\(\tilde{p}_0(w)=\frac{1}{\sqrt{2\pi}}e^{-iwx_0}\)</span></p><p>é‚£ä¹ˆæˆ‘ä»¬æœ‰:</p><p><span class="math display">\[F(w)=\frac{1}{\sqrt{2\pi}}e^{-iwx_0}e^{\frac{\sigma^2w^2}{4\theta}}\]</span></p><p>å› æ­¤ï¼Œæˆ‘ä»¬æœ‰ï¼š</p><p><span class="math display">\[\tilde{p}_t(w)=\frac{1}{\sqrt{2\pi}}\exp\left(-\frac{\sigma^2w^2}{4\theta}(1-e^{-2\thetat})\right)\exp\left(-iwe^{-\theta t}x_0\right)\]</span></p><p>æ ¹æ®å‚…é‡Œå¶é€†å˜æ¢ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼š</p><p><span class="math display">\[p_t(x)=\frac{1}{\sqrt{2\pi}}\int \tilde{p}_t(w)e^{iwx}dw\]</span></p><p>åŒæ—¶æ ¹æ®ç§¯åˆ†æ’ç­‰å¼(é€šè¿‡ç®€å•çš„é…æ–¹å³å¯å¾—åˆ°)ï¼š</p><p><span class="math display">\[\int e^{-Aw^2}e^{iBw}dw = \sqrt{\frac{\pi}{A}}e^{-\frac{B^2}{4A}}\]</span></p><p>å› æ­¤,</p><p><span class="math display">\[p_t(w)=\frac{1}{2\pi}\int\exp\left(-\frac{\sigma^2w^2}{4\theta}(1-e^{-2\thetat})\right)\exp\left(-iwe^{-\theta t}x_0\right)e^{iwx}dw\]</span></p><p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä»¤ï¼š</p><p><span class="math display">\[A=\frac{\sigma^2}{4\theta}(1-e^{-2\theta t}),\\B = x-e^{-\theta t}x_0\]</span></p><p>é‚£ä¹ˆ,</p><p><span class="math display">\[p_t(w)=\frac{1}{2\pi}\sqrt{\frac{\pi}{A}}e^{-\frac{B^2}{4A}}=\frac{1}{\sqrt{2\pi2A}}e^{\frac{B^2}{2\times2A}}\]</span></p><p>æˆ‘ä»¬å¯ä»¥çŸ¥é“<span class="math inline">\(p_t(w)\)</span>æ„æˆäº†ä¸€ä¸ªï¼Œå‡å€¼ä¸º<span class="math inline">\(e^{-\theta t}x_0\)</span>ï¼Œæ–¹å·®ä¸º<span class="math inline">\(\frac{\sigma^2}{2\theta}(1-e^{-2\thetat})\)</span> çš„é«˜æ–¯åˆ†å¸ƒã€‚</p><h1 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h1><p>Ho, Jonathan, and Tim Salimans. â€œClassifier-Free Diffusion Guidance.â€arXiv, July 25, 2022. <a href="http://arxiv.org/abs/2207.12598">http://arxiv.org/abs/2207.12598</a>.</p><p>Lipman, Yaron, Ricky T. Q. Chen, Heli Ben-Hamu, Maximilian Nickel,and Matt Le. â€œFlow Matching for Generative Modeling.â€ arXiv, February 8,2023. <a href="https://doi.org/10.48550/arXiv.2210.02747">https://doi.org/10.48550/arXiv.2210.02747</a>.</p><p>Liu, Xingchao, Chengyue Gong, and Qiang Liu. â€œFlow Straight and Fast:Learning to Generate and Transfer Data with Rectified Flow.â€ arXiv,September 7, 2022. <a href="http://arxiv.org/abs/2209.03003">http://arxiv.org/abs/2209.03003</a>.</p><p>Song, Jiaming, Chenlin Meng, and Stefano Ermon. â€œDenoising DiffusionImplicit Models.â€ arXiv, October 5, 2022. <a href="http://arxiv.org/abs/2010.02502">http://arxiv.org/abs/2010.02502</a>.</p><p>Song, Yang, Jascha Sohl-Dickstein, Diederik P. Kingma, AbhishekKumar, Stefano Ermon, and Ben Poole. â€œScore-Based Generative Modelingthrough Stochastic Differential Equations.â€ arXiv, February 10, 2021. <a href="https://doi.org/10.48550/arXiv.2011.13456">https://doi.org/10.48550/arXiv.2011.13456</a>.</p><p>StrÃ¼mke, Inga, and Helge Langseth. â€œLecture Notes in ProbabilisticDiffusion Models.â€ arXiv, December 16, 2023. <a href="https://doi.org/10.48550/arXiv.2312.10393">https://doi.org/10.48550/arXiv.2312.10393</a>.</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> äººå·¥æ™ºèƒ½ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é‡å­ç‰©ç†ï¼Œæœºå™¨å­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¤§æ¨¡å‹é‡Œçš„ Attention æœºåˆ¶</title>
      <link href="/2025/03/01/attention/"/>
      <url>/2025/03/01/attention/</url>
      
        <content type="html"><![CDATA[<h1 id="å¼•è¨€">å¼•è¨€</h1><p>è¿‘å¹´æ¥ï¼Œéšç€æ·±åº¦å­¦ä¹ æŠ€æœ¯çš„å¿«é€Ÿå‘å±•ï¼Œå¤§æ¨¡å‹ï¼ˆLarge Language Models,LLMsï¼‰åœ¨è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰é¢†åŸŸå–å¾—äº†æ˜¾è‘—çš„è¿›å±•ã€‚è¿™äº›æ¨¡å‹é€šè¿‡å¤§è§„æ¨¡æ•°æ®è®­ç»ƒï¼Œèƒ½å¤Ÿç”Ÿæˆé«˜è´¨é‡çš„æ–‡æœ¬ã€å®Œæˆå¤æ‚çš„è¯­è¨€ç†è§£ä»»åŠ¡ï¼Œå¹¶åœ¨å¤šä¸ªé¢†åŸŸå±•ç°å‡ºå¼ºå¤§çš„èƒ½åŠ›ã€‚ç„¶è€Œï¼Œéšç€æ¨¡å‹è§„æ¨¡çš„ä¸æ–­æ‰©å¤§ï¼Œå¦‚ä½•é«˜æ•ˆåœ°å¤„ç†é•¿åºåˆ—æ•°æ®ã€é™ä½è®¡ç®—å¤æ‚åº¦ä»¥åŠå‡å°‘å†…å­˜å ç”¨æˆä¸ºäº†ç ”ç©¶çš„çƒ­ç‚¹é—®é¢˜ã€‚</p><p>åœ¨å¤§æ¨¡å‹ä¸­ï¼ŒAttention æœºåˆ¶ï¼ˆæ³¨æ„åŠ›æœºåˆ¶ï¼‰æ˜¯æ ¸å¿ƒç»„ä»¶ä¹‹ä¸€ã€‚è‡ªTransformer æ¨¡å‹æå‡ºä»¥æ¥ï¼ŒAttentionæœºåˆ¶å‡­å€Ÿå…¶å¼ºå¤§çš„åºåˆ—å»ºæ¨¡èƒ½åŠ›ï¼Œé€æ¸å–ä»£äº†ä¼ ç»Ÿçš„å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰å’Œå·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰ã€‚ç„¶è€Œï¼Œæ ‡å‡†çš„Attention æœºåˆ¶ï¼ˆå¦‚ Multi-Head Attention,MHAï¼‰åœ¨å¤„ç†é•¿åºåˆ—æ—¶é¢ä¸´ç€è®¡ç®—å¤æ‚åº¦å’Œå†…å­˜å ç”¨çš„åŒé‡æŒ‘æˆ˜ï¼Œè¿™ä½¿å¾—å…¶åœ¨å¤„ç†é•¿æ–‡æœ¬æ—¶æ•ˆç‡ä½ä¸‹ã€‚</p><p>ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œç ”ç©¶è€…ä»¬æå‡ºäº†å¤šç§æ”¹è¿›çš„ Attention æœºåˆ¶ï¼Œä¾‹å¦‚FlashAttentionã€Multi-Query Attention (MQA)ã€Group Query Attention (GQA)ä»¥åŠ Sparse Attentionç­‰ã€‚è¿™äº›æ–¹æ³•é€šè¿‡ä¼˜åŒ–è®¡ç®—æµç¨‹ã€å‡å°‘å†…å­˜è®¿é—®æ¬¡æ•°æˆ–å¼•å…¥ç¨€ç–æ€§ï¼Œæ˜¾è‘—æå‡äº†Attention æœºåˆ¶çš„æ•ˆç‡ã€‚æ­¤å¤–ï¼ŒDeepSeek-V2 æå‡ºçš„ Multi-Head LatentAttention (MLA)è¿›ä¸€æ­¥é€šè¿‡ä½ç»´æ˜ å°„å’Œç®—å­èåˆæŠ€æœ¯ï¼Œé™ä½äº†è®¡ç®—å¤æ‚åº¦å’Œå†…å­˜å ç”¨ï¼Œä¸ºå¤§æ¨¡å‹çš„è§„æ¨¡åŒ–åº”ç”¨æä¾›äº†æ–°çš„æ€è·¯ã€‚</p><p>æœ¬æ–‡å°†æ·±å…¥æ¢è®¨è¿™äº› AttentionæŠ€æœ¯çš„åŸç†ã€å®ç°ç»†èŠ‚åŠå…¶åœ¨å¤§æ¨¡å‹ä¸­çš„åº”ç”¨ã€‚æˆ‘ä»¬å°†ä»æ ‡å‡†çš„ MHAå‡ºå‘ï¼Œé€æ­¥ä»‹ç»å…¶å˜ä½“ï¼ˆå¦‚ MQA å’Œ GQAï¼‰ï¼Œå¹¶è¯¦ç»†åˆ†æ FlashAttentionå¦‚ä½•é€šè¿‡åˆ†å—è®¡ç®—å’Œé‡è®¡ç®—æŠ€æœ¯ä¼˜åŒ–æ€§èƒ½ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å°†æ¢è®¨ SparseAttention å’Œ DeepSeek-MLAçš„åˆ›æ–°è®¾è®¡ï¼Œä»¥åŠå®ƒä»¬å¦‚ä½•åœ¨å¤§è§„æ¨¡è¯­è¨€æ¨¡å‹ä¸­å®ç°é«˜æ•ˆçš„é•¿åºåˆ—å¤„ç†ã€‚</p><p>é€šè¿‡å¯¹è¿™äº›æŠ€æœ¯çš„å…¨é¢åˆ†æï¼Œæœ¬æ–‡æ—¨åœ¨ä¸ºè¯»è€…æä¾›ä¸€ä¸ªç³»ç»Ÿçš„è§†è§’ï¼Œç†è§£å¤§æ¨¡å‹ä¸­Attentionæœºåˆ¶çš„æ¼”è¿›åŠå…¶åœ¨å®é™…åº”ç”¨ä¸­çš„ä¼˜åŒ–ç­–ç•¥ã€‚æˆ‘ä»¬ç›¸ä¿¡ï¼Œéšç€è¿™äº›æŠ€æœ¯çš„ä¸æ–­å‘å±•ï¼Œå¤§æ¨¡å‹å°†åœ¨æ›´å¤šé¢†åŸŸå±•ç°å‡ºå…¶å¼ºå¤§çš„æ½œåŠ›ï¼Œå¹¶ä¸ºäººå·¥æ™ºèƒ½çš„æœªæ¥å¼€è¾Ÿæ–°çš„å¯èƒ½æ€§ã€‚</p><h1 id="attention-æŠ€æœ¯">Attention æŠ€æœ¯</h1><h2 id="mhamulti-head-attention">MHA(Multi Head Attention)</h2><blockquote><p>Attention is all you need.</p></blockquote><h3 id="single-head">Single Head</h3><p>åœ¨åŸºç¡€çš„ MHAï¼Œç»™å®šä¸€ä¸ª Sequence çš„è¡¨ç¤º<span class="math inline">\(x\in\mathbb{R}^{N\times d}\)</span>ï¼Œ<span class="math inline">\(N\)</span>æ˜¯ Sequence çš„é•¿åº¦ï¼Œ<span class="math inline">\(d\)</span>æ˜¯è¡¨å¾çš„ç»´åº¦ã€‚</p><p>æ„é€ ä¸‰ä¸ª Tensor, <span class="math inline">\(W^Q,W^K,W^V\in\mathbb{R}^{d\times&nbsp;d}\)</span>,é‚£ä¹ˆå¯¹åº”çš„ï¼Œ</p><p><span class="math display">\[Q=xW^Q, K=xW^K, V=xW^V\]</span></p><p>Attention çš„ç»“æœ<span class="math inline">\(O\)</span>åˆ™å˜æˆäº†ï¼š</p><p><span class="math inline">\(Q=g(QK^T)V\)</span>ï¼Œè¿™è¾¹<span class="math inline">\(g\)</span>ä»£è¡¨æŒ‰è¡Œ softmax æ“ä½œã€‚</p><h3 id="multi-head">Multi Head</h3><p>Single Head å¾€ Multi Head çš„æ¨å¹¿åˆ™åªéœ€è¦åšå¦‚ä¸‹çš„æ”¹å˜å°±å¯ä»¥äº†<span class="math inline">\(W^Q,&nbsp;W^K,&nbsp;W^V\in\mathbb{R}^{d\times\frac{d}{h}\timesh},\)</span><span class="math inline">\(h\)</span>æ˜¯ Headçš„ä¸ªæ•°ã€‚ä¸‹é¢è¿™æ®µæä¾›äº† Multi Head çš„ Demo å®ç°çš„ä¸¤ç§æ–¹å¼ï¼š</p><ol type="1"><li>ä½¿ç”¨ Single Head çš„æ–¹å¼ï¼Œç„¶åæ‹¼æ¥èµ·æ¥</li><li>ç›´æ¥å®Œæ•´çš„å¼ é‡è®¡ç®—æ–¹å¼</li></ol><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch </span><br><span class="line"></span><br><span class="line">batch_size = <span class="number">8</span></span><br><span class="line">seq_len = <span class="number">16</span></span><br><span class="line">d = <span class="number">128</span> </span><br><span class="line">h = <span class="number">4</span></span><br><span class="line">sub_d = d // h</span><br><span class="line"></span><br><span class="line">x = torch.randn(size=(batch_size, seq_len, d))</span><br><span class="line"></span><br><span class="line">w_qs = [torch.randn(size=(d, sub_d)) <span class="keyword">for</span> _ <span class="keyword">in</span> range(h)]</span><br><span class="line">w_ks = [torch.randn(size=(d, sub_d)) <span class="keyword">for</span> _ <span class="keyword">in</span> range(h)]</span><br><span class="line">w_vs = [torch.randn(size=(d, sub_d)) <span class="keyword">for</span> _ <span class="keyword">in</span> range(h)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(<span class="string">"========From Single Head START========="</span>)</span><br><span class="line">os = []</span><br><span class="line"><span class="keyword">for</span> head <span class="keyword">in</span> range(h):</span><br><span class="line">    q = torch.matmul(x, w_qs[head])</span><br><span class="line">    k = torch.matmul(x, w_ks[head])</span><br><span class="line">    v = torch.matmul(x, w_vs[head])</span><br><span class="line">    att = torch.einsum(<span class="string">'bnd,bmd-&gt;bnm'</span>, q, k) / (sub_d ** <span class="number">0.5</span>)</span><br><span class="line">    att_sep.append(att)</span><br><span class="line">    att = torch.softmax(att, dim=<span class="number">-1</span>)</span><br><span class="line">    att_sep_soft.append(att)</span><br><span class="line">    o = torch.einsum(<span class="string">'bnm,bmd-&gt;bnd'</span>, att, v)</span><br><span class="line">    os.append(o)</span><br><span class="line">output = torch.cat(os, dim=<span class="number">-1</span>)</span><br><span class="line">print(<span class="string">"output shape: "</span>, output.shape)</span><br><span class="line">print(<span class="string">"========From Single Head END========="</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(<span class="string">"========VEC START========="</span>)</span><br><span class="line">w_qs_vec = torch.stack(w_qs, dim=<span class="number">-1</span>) <span class="comment"># (d, sub_d, h)</span></span><br><span class="line">w_ks_vec = torch.stack(w_ks, dim=<span class="number">-1</span>)</span><br><span class="line">w_vs_vec = torch.stack(w_vs, dim=<span class="number">-1</span>)</span><br><span class="line">q_vec = torch.einsum(<span class="string">'bnd,dsh-&gt;bnsh'</span>, x, w_qs_vec) <span class="comment"># (b, n, d, h)</span></span><br><span class="line">k_vec = torch.einsum(<span class="string">'bnd,dsh-&gt;bnsh'</span>, x, w_ks_vec)</span><br><span class="line">v_vec = torch.einsum(<span class="string">'bnd,dsh-&gt;bnsh'</span>, x, w_vs_vec)</span><br><span class="line">att = torch.einsum(<span class="string">'bnsh,bmsh-&gt;bnmh'</span>, q_vec, k_vec) / (sub_d ** <span class="number">0.5</span>)</span><br><span class="line">att = torch.softmax(att, dim=<span class="number">-2</span>)</span><br><span class="line">o = torch.einsum(<span class="string">'bnmh,bmsh-&gt;bnhs'</span>, att, v_vec)</span><br><span class="line">output2 = torch.reshape(o, shape=(batch_size, seq_len, d))</span><br><span class="line">print(<span class="string">"output2 shape: "</span>, output2.shape)</span><br><span class="line">print(<span class="string">"========VEC END========="</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">err = torch.sum(torch.abs(output - output2))</span><br><span class="line">print(<span class="string">"err: "</span>, err)</span><br></pre></td></tr></tbody></table></figure><p>ä¸Šé¢çš„å…·ä½“è®¡ç®—æµç¨‹å¯ä»¥å½’çº³ä¸ºå¦‚ä¸‹</p><img src="/2025/03/01/attention/mha.png" class="" title="This is an image"><p>ä»è¿™è¾¹æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¼ ç»Ÿçš„ MHA é’ˆå¯¹<span class="math inline">\(N\)</span>çš„å¤æ‚åº¦<span class="math inline">\(\sim\mathcal{O}(N^2)\)</span></p><p>æ€»ä½“çš„ FLOPS å¯ä»¥æ€»ç»“æˆå¦‚ä¸‹çš„è¡¨æ ¼</p><div data-align="center"><table><thead><tr class="header"><th>æ­¥éª¤</th><th>Operation</th><th>è§£é‡Š</th><th>FLOPs(MHA)</th></tr></thead><tbody><tr class="odd"><td>1</td><td>Q,K,V çš„è®¡ç®—</td><td>3 ä¸ªçŸ©é˜µä¹˜æ³•</td><td><span class="math inline">\(6Nd^2\)</span></td></tr><tr class="even"><td>2</td><td>QK^T</td><td><span class="math inline">\(h\)</span>ä¸ªçŸ©é˜µä¹˜æ³•</td><td><span class="math inline">\(2N^2d\)</span></td></tr><tr class="odd"><td>3</td><td>Softmax</td><td>3 æ¥è‡ª exp,æ±‚å’Œï¼Œé™¤æ³•</td><td><span class="math inline">\(3N^2h\)</span></td></tr><tr class="even"><td>4</td><td>ä¹˜ V</td><td>çŸ©é˜µä¹˜æ³•</td><td><span class="math inline">\(2N^2d\)</span></td></tr><tr class="odd"><td>5</td><td>FFN</td><td>Dense Layer çš„çŸ©é˜µä¹˜æ³•</td><td><span class="math inline">\(2Nd^2\)</span></td></tr></tbody></table></div><h2 id="section"></h2><h2 id="flash-attention">Flash Attention</h2><blockquote><p>FlashAttentionï¼šä»ç®—æ³•å®ç°çš„è§’åº¦ï¼Œæå‡ºäº†ä¸€ç§IOé«˜æ•ˆï¼Œæ— æŸï¼Œå¿«é€Ÿçš„MHAè®¡ç®—æ–¹æ³•ã€‚</p></blockquote><p>å¯¹äºé«˜æ€§èƒ½è®¡ç®—ç¨‹åºæ¥è¯´,å¾€å¾€éœ€è¦ä»ä¸‹é¢ä¸¤ä¸ªè§’åº¦å»è€ƒè™‘ç¨‹åºçš„æ€§èƒ½ç“¶é¢ˆ:</p><ol type="1"><li><p>Compute Bottleneck:</p><ol type="1"><li>å¤„ç†å™¨æœ¬èº«çš„è®¡ç®—èƒ½åŠ›æˆäº†çŸ­æ¿ã€‚</li><li>åœ¨æ·±åº¦å­¦ä¹ åœºæ™¯ï¼Œä¾‹å¦‚å¤§çŸ©é˜µçš„ä¹˜æ³•ã€‚</li></ol></li><li><p>Memory and IO Bottleneck</p><ol type="1"><li>ç¨‹åºå¤§é‡å’Œå†…å­˜ï¼Œæ˜¾å­˜æˆ–è€…ç£ç›˜äº¤äº’ã€‚</li><li>åœ¨æ·±åº¦å­¦ä¹ åœºæ™¯ï¼Œå„ç±» element-wise æ“ä½œï¼Œå„ç±» Reduce æ“ä½œã€‚</li></ol></li></ol><p>é‚£ä¹ˆåœ¨ MHAçš„è®¡ç®—åœºæ™¯ï¼Œæˆ‘ä»¬ä»ä¸Šé¢çš„ç®—æ³•ä¸­å¯ä»¥çœ‹åˆ°ï¼Œæ•´ä¸ªæµç¨‹éœ€è¦é¢‘ç¹å†™å…¥HBMï¼Œå¹¶ä¸”ç«‹é©¬ä» HBMå†æ¬¡è¯»å–çš„æ“ä½œï¼Œè¿™æ ·å¾€å¾€æ‹–ç´¯æ•´ä¸ªç¨‹åºçš„æ€§èƒ½ã€‚æˆ‘ä»¬ç®€å•çœ‹ä¸€ä¸‹ GPUçš„ç»“æ„å°±å¯ä»¥ç†è§£ä¸ºä»€ä¹ˆä¼šè¿™æ ·ã€‚</p><img src="/2025/03/01/attention/gpu.png" class="" title="This is an image"><p>ä»ä¸Šé¢çš„è¿™å¼ å›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ•´ä¸ª GPU çš„å†…å­˜ï¼Œåˆ†æˆäº†ä¸‰ä¸ªå±‚æ¬¡:</p><ol type="1"><li>SRAM: é™æ€éšæœºå­˜å‚¨å™¨ï¼Œä»·æ ¼æ˜‚è´µï¼Œå®¹é‡å°ï¼Œä½†æ˜¯é€Ÿåº¦å¿«</li><li>HBMï¼šå³å¸¸è¯´çš„æ˜¾å­˜</li><li>CPU DRAMï¼šGPU æœºå™¨ä¸Šçš„ CPU çš„å†…å­˜</li></ol><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ° SRAM çš„å®¹é‡åªæœ‰ 20MBï¼Œå› æ­¤å¾€å¾€ä¸èƒ½å­˜å‚¨ä¸‹ä¸€ä¸ªå®Œæ•´çš„è¶…å¤§Tensorã€‚åœ¨å¯¹å¤§çŸ©é˜µè¿›è¡Œè®¡ç®—çš„æ—¶å€™ï¼Œä¼šå°†å…¶åˆ†å—ï¼Œå¹¶åˆ†ç»™ä¸åŒ CUDAæ ¸å¿ƒå»æ“ä½œï¼Œç„¶åé€šè¿‡ HBM ä½œä¸ºç›¸äº’é€šä¿¡çš„ä¸­é—´ Bufferã€‚</p><p>æ‰€ä»¥ä¸ºäº†æé«˜ä¼ ç»Ÿ MHA çš„è®¡ç®—æ•ˆç‡ï¼Œéœ€è¦éµå¾ªä¸‹é¢çš„åŸåˆ™ï¼š</p><p><strong>å°½å¯èƒ½å‡å°‘å’Œ HBMçš„äº¤äº’æ¬¡æ•°ï¼Œå¯¹æ•´ä¸ªè®¡ç®—åšèåˆ(Fuse)</strong></p><p>å› æ­¤åœ¨ FlashAttentionçš„ç®—æ³•ä¸­ï¼Œä½œè€…æä¾›äº†ä¸¤ä¸ªæ¨¡å—æ¥å®Œæˆä¸Šè¿°çš„è¿™ä»¶äº‹æƒ…ï¼š</p><ol type="1"><li>Tiling: ä½¿ç”¨åˆ†å—å’Œæµå¼çš„æ–¹å¼ï¼Œé™ä½å’Œ HBM çš„äº¤äº’é¢‘ç‡</li><li>Recomputing: é€šè¿‡å­˜å‚¨ Normalization Factorçš„æ–¹å¼ï¼Œçœå»äº†å­˜å‚¨è¶…å¤§çš„ä¸­é—´ AttentionMatrixï¼Œä¸€æ ·å¯ä»¥ä¿è¯æ•´ä½“æ¢¯åº¦å›ä¼ çš„æ­£ç¡®æ€§</li></ol><p><u>å¤‡æ³¨ï¼šç¬¬äºŒç‚¹å…¶å®åœ¨ç»Ÿè®¡ç‰©ç†ä¸­éå¸¸å¸¸ç”¨ï¼Œä¸€ä¸ªç»Ÿè®¡åˆ†å¸ƒçš„é…åˆ†å‡½æ•°(partitionfunction),å³ Normalization Factor,è•´å«äº†è¯¥åˆ†å¸ƒçš„éå¸¸å¤šçš„ä¿¡æ¯ã€‚</u></p><h3 id="forward-pass">Forward Pass</h3><p>Tiling çš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯æµå¼åˆ†å—è®¡ç®— softmaxã€‚</p><p>å¯¹äºç»™å®šä¸€ä¸ªå‘é‡<span class="math inline">\(x\in\mathbb{R}^{N}\)</span>,é‚£ä¹ˆèµ· softmaxå¯ä»¥æŒ‰ç…§å¦‚ä¸‹çš„æ–¹å¼è®¡ç®—ï¼š</p><p><span class="math display">\[g(x)_i=\frac{e^{x_i-m(x)}}{\sum_j&nbsp;e^{x_j-m(x)}},&nbsp;m(x)=\max_i\{x_i\}\]</span></p><p>è¿™è¾¹åŒæ—¶å‡å»<span class="math inline">\(m(x)\)</span>åªæ˜¯ä»æ•°å€¼ç¨³å®šæ€§çš„è§’åº¦å‡ºå‘ã€‚</p><p>é‚£ä¹ˆæµå¼åˆ†å—è®¡ç®—æ˜¯ä»€ä¹ˆæ„æ€ï¼Œå‡è®¾æˆ‘ä»¬æ²¡æœ‰åŠæ³•ä¸€ä¸‹å¾—åˆ°æ•´ä¸ª<span class="math inline">\(x\)</span>,è€Œæ˜¯åˆ†å—å¾—åˆ°<span class="math inline">\(x^{(i)}\)</span>,å…¶ä¸­<span class="math inline">\(x=(x^{(1)},x^{(2)},\cdots,x^{(n)}),x^{(i)}\in\mathbb{R}^{d_i},\sum_i&nbsp;d_i&nbsp;=&nbsp;N\)</span>ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ä¸ªç®—æ³•ï¼Œå®Œç¾åœ°è®¡ç®—å‡º<span class="math inline">\(g(x)\)</span></p><p>ä¸ºäº†æ–¹ä¾¿è®¨è®ºï¼Œæˆ‘ä»¬è€ƒè™‘æœ€ç®€å•çš„æƒ…å†µï¼Œ<span class="math inline">\(x\)</span>è¢«åˆ†æˆäº†ä¸¤ä¸ª block, <span class="math inline">\(x^{(1)},x^{(2)}\)</span>ã€‚é‚£ä¹ˆæ•´ä¸ªè®¡ç®—å¯ä»¥æŒ‰ç…§å¦‚ä¸‹çš„æ­¥éª¤è¿›è¡Œï¼š</p><ol type="1"><li><p>å½“æˆ‘ä»¬æ‹¿åˆ°ç¬¬ä¸€ä¸ª block,<span class="math inline">\(x^{(1)}\)</span>ä¹‹åï¼Œæˆ‘ä»¬å…ˆè®¡ç®—è¿™ä¸ª blockæœ¬èº«è‡ªå·±çš„ softmaxï¼ŒåŒæ—¶ä¿ç•™å¦‚ä¸‹çš„å˜é‡:</p><ol type="1"><li><span class="math display">\[m(x^{(1)}),l^{(1)}=\sum_j&nbsp;e^{x^{(1)}_j-m(x^{(1)})}\]</span></li><li><span class="math inline">\(g(x)\)</span>çš„å‰<span class="math inline">\(d_1\)</span>ä¸ªå…ƒç´ æ›´æ–°æˆ<span class="math inline">\(\frac{e^{x^{(1)}_j}-m(x^{(1)})}{l^{(1)}}\)</span></li></ol></li><li><p>å½“æˆ‘ä»¬æ‹¿åˆ°ç¬¬äºŒä¸ª block çš„æ—¶å€™ï¼Œæˆ‘ä»¬çŸ¥é“<span class="math inline">\(x^{(2)}\)</span>å¯¹<span class="math inline">\(x^{(1)}\)</span>é‚£éƒ¨åˆ† softmaxå€¼çš„å½±å“ï¼Œåªæœ‰ä¸¤ä¸ªæ–¹é¢ï¼š</p><ol type="1"><li>æ›´æ–°æœ€å¤§å€¼<span class="math inline">\(m(x)=\max(m(x^{(1)}),m(x^{(2)}))\)</span>ï¼Œè¿™è¾¹<span class="math inline">\(m(x^{(1)})\)</span>ä¹‹å‰æ‰€æœ‰çš„æœ€å¤§å€¼ï¼Œä¸€ç›´é€šè¿‡ä¸€ä¸ªå˜é‡ç»´æŠ¤ç€ï¼Œ<span class="math inline">\(m(x^{(2)})\)</span>ä½¿ç”¨æ–°æ¥çš„æ•°æ®<span class="math inline">\(x^{(2)}\)</span>è®¡ç®—</li><li>æ›´æ–°æ•´ä½“çš„ normalization factorï¼Œ<span class="math inline">\(l(x)=e^{m(x^{(1)})-m(x)}l^{(1)}+e^{m(x^{(2)})-m(x)}l^{(2)}\)</span>,è¿™è¾¹<span class="math inline">\(l^{(2)}\)</span>å¯ä»¥ä½¿ç”¨æ–°æ¥çš„æ•°æ®<span class="math inline">\(x^{(2)}\)</span>ä¸´æ—¶è®¡ç®—</li><li>æ›´æ–°<span class="math inline">\(g(x)\)</span>,<span class="math inline">\(g(x)\)</span>å‰<span class="math inline">\(d_1\)</span>ä¸ªå…ƒç´ ï¼Œå¯ä»¥ä¹˜ä¸Š<span class="math inline">\(\frac{l^{(1)}}{l(x)}e^{m(x^{(1)})-m(x)}\)</span>è¿™ä¸ªå› å­å»æ›´æ–°ï¼Œ<span class="math inline">\(g(x)\)</span>åé¢æ–°çš„<span class="math inline">\(d_2\)</span>ä¸ªå…ƒç´ ï¼Œåˆ™å¯ä»¥ç›´æ¥èµ‹å€¼<span class="math inline">\(\frac{e^{x^{(2)}-m(x)}}{l(x)}\)</span></li></ol></li></ol><p>å¦‚æœç†è§£æ¸…æ¥šä¸Šé¢è¿™ä¸ªç®€å•çš„<span class="math inline">\(x\in\mathbb{R}^{N}\)</span>çš„æƒ…å†µï¼Œé‚£ä¹ˆä¸èƒ½æ‰©å±•åˆ°Attention çœŸæ­£é¢ä¸´çš„åœºæ™¯ã€‚</p><ol type="1"><li><p>ä»<span class="math inline">\(\mathbb{R}^{N}\)</span>æ±‚ softmaxæ‰©å±•åˆ°ä»»æ„<span class="math inline">\(B_r\)</span>è¡Œ,<span class="math inline">\(B_c\)</span>åˆ—çš„çŸ©é˜µ<span class="math inline">\(\mathbb{R}^{B_r\times&nbsp;B_c}\)</span>çš„æŒ‰è¡Œæ±‚softmaxã€‚</p><ol type="1"><li><span class="math inline">\(l,m\)</span>å˜æˆä¸€ä¸ª<span class="math inline">\(\mathbb{R}^{B_r}\)</span>çš„å‘é‡ï¼Œ<span class="math inline">\(g\)</span>å˜æˆä¸€ä¸ª<span class="math inline">\(\mathbb{R}^{B_r\times B_c}\)</span>çš„çŸ©é˜µ</li><li><span class="math inline">\(\frac{1}{l(x)}\)</span>çš„æ“ä½œå˜æˆçŸ©é˜µæ±‚é€†æ“ä½œ</li></ol></li><li><p>Atttention Matrix <span class="math inline">\(QK^T\)</span>æŒ‰ç…§ç¡¬ä»¶å‚æ•°æ‹†åˆ†æˆä¸ªä¸ªå°çš„Block</p></li><li><p>æ„è¯†åˆ°<span class="math inline">\(V\)</span>çš„ä¹˜æ³•ï¼Œåªå’Œ Blockæœ¬èº«çš„ä½ç½®åˆå…³ç³»ï¼Œsoftmax æœ¬èº«çš„æµå¼æ›´æ–°å¹¶ä¸å½±å“ã€‚</p></li></ol><p>é‚£ä¹ˆåœ¨è¿™ç§æƒ…å†µä¸‹é¢ï¼Œæˆ‘ä»¬å°±ä¼šçŸ¥é“åœ¨ Forward Passè¿‡ç¨‹ä¸­ï¼ŒFlashAttention æ•´ä½“çš„ç®—æ³•å¯ä»¥è¡¨è¿°æˆä¸‹å›¾:</p><img src="/2025/03/01/attention/fa1.png" class="" title="This is an image"><blockquote><p>Algorithm 1 <span class="math inline">\(\mathcal{O}(N^2d)\)</span>FLOPs and requires <span class="math inline">\(\mathcal{O}(N)\)</span>additional memory beyond inputs and output.</p></blockquote><p>FLOPS ä¸»è¦æ¥è‡ªäº<span class="math inline">\(Q_iK_j^T\)</span>çš„çŸ©é˜µä¹˜æ³•: <span class="math inline">\(T_c T_rB_rB_cd&nbsp;\sim&nbsp;\mathcal{O}(N^2d)\)</span></p><p>é¢å¤–çš„<span class="math inline">\(\mathcal{O}(N)\)</span>çš„æ˜¾å­˜å¼€é”€æ¥è‡ªäº<span class="math inline">\(l,m\)</span>å‘é‡çš„å­˜å‚¨</p><blockquote><p>æ ‡å‡†MHAéœ€è¦å’ŒHBMäº¤äº’<span class="math inline">\(\mathcal{O}(Nd+N^2)\)</span>æ¬¡ï¼ŒFlashAttentionéœ€è¦å’ŒHBMäº¤äº’<span class="math inline">\(\mathcal{O}(N^2d^2M^{-1})\)</span>æ¬¡</p></blockquote><p>æ ‡å‡† MHA Load <span class="math inline">\(Q,K,V\)</span>éœ€è¦<span class="math inline">\(\mathcal{O}(Nd)\)</span>, Attention Matrixçš„è¯»å†™éœ€è¦<span class="math inline">\(\mathcal{O}(N^2)\)</span></p><p>FlashAttention ä¸»è¦ Load <span class="math inline">\(T_r&nbsp;T_c\)</span>æ¬¡<span class="math inline">\(M\)</span>å¤§å°é‡çº§çš„ Tensor, å› æ­¤<span class="math inline">\(T_rT_cM&nbsp;\sim&nbsp;\mathcal{O}(N^2d^2M^{-1})\)</span></p><p>åœ¨ä¸€èˆ¬æƒ…å†µä¸‹é¢<span class="math inline">\(M\gg&nbsp;d^2\)</span>,å› æ­¤FlashAttention çš„äº¤äº’æ¬¡æ•°ä¼šè¢«å¤§å¹…åº¦å‹ç¼©ã€‚</p><p>å½“ç„¶åœ¨ LLM çš„è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå› ä¸ºæœ‰ Sequence Mask çš„å­˜åœ¨ï¼Œå¾€å¾€å¾ˆå¤šAttention Block ä¸éœ€è¦è®¡ç®—ï¼Œå¯ä»¥ç›´æ¥è®¤ä¸ºæ˜¯ä¸€ä¸ª<span class="math inline">\(-\infty\)</span>ï¼Œå› æ­¤ä½œè€…è¯æ˜äº†ï¼Œå¯¹äº Sparseç»“æ„çš„ Attentionï¼Œæ•´ä½“ä¸ HBM äº¤äº’æ¬¡æ•°å¯ä»¥å‹ç¼©åˆ°<span class="math inline">\(\mathcal{O}(N^2d^2M^{-1}s)\)</span>,<span class="math inline">\(s\)</span>ç”¨æ¥å¾ˆè¡¡é‡ç¨€ç–åº¦ã€‚</p><h3 id="backward-pass">Backward Pass</h3><p>åœ¨åˆ†æå®Œäº† Forward Pass ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦è¯æ˜ï¼š</p><blockquote><p>ç»´æŠ¤<span class="math inline">\(Q,K,V,l\)</span>å°±è¶³å¤Ÿå®Œæˆæ¢¯åº¦è®¡ç®—ï¼Œä¸éœ€è¦ç»´æŠ¤ä¸­é—´çš„AttentionMatrix<span class="math inline">\(P:=g(QK^T)\)</span></p></blockquote><p>å‡è®¾æ¢¯åº¦å›ä¼ åˆ°<span class="math inline">\(O\)</span>çš„æ—¶å€™ä¸º<span class="math inline">\(O^{\prime}&nbsp;\in&nbsp;\mathbb{R}^{N\times&nbsp;d}\)</span>,å› ä¸º<span class="math inline">\(O=PV\)</span>ï¼Œæ ¹æ®é“¾å¼æ³•åˆ™æˆ‘ä»¬å¯ä»¥æœ‰:</p><p><span class="math inline">\(V'_{ij}&nbsp;=&nbsp;\frac{\partialO_{rs}}{\partial V_{ij}}O'_{rs}=P_{ri}\delta_{sj}O'_{rs}=P^T_{ir}O'_{rj}=\sum_r\frac{e^{q_rk_i^T}}{l_r}O'_{rj}\)</span>ï¼Œå³<span class="math inline">\(V'=P^TO'\)</span>.</p><p>å› ä¸ºå…³äº<span class="math inline">\(V\)</span>çš„æ¢¯åº¦ï¼Œå¯ä»¥ä»¿ç…§ä» V åˆ°O çš„è¿‡ç¨‹ï¼Œä½¿ç”¨ç±»ä¼¼ ForwardPass çš„æ–¹å¼è¿›è¡Œè®¡ç®—ä»<span class="math inline">\(O'\)</span>åˆ°<span class="math inline">\(V'\)</span>.</p><p>ä¸‹é¢æˆ‘ä»¬è¿˜éœ€è¦ç¡®è®¤ä¸€ä¸‹<span class="math inline">\(Q',K'\)</span>æ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥æ¯”è¾ƒæ–¹ä¾¿çš„è®¡ç®—å‡ºæ¥ã€‚æ ¹æ®<span class="math inline">\(O=PV\)</span>,æˆ‘ä»¬å¯ä»¥ç±»ä¼¼çš„å¾—åˆ°<span class="math inline">\(P'=O'V^T\)</span>,å³æˆ‘ä»¬å¯ä»¥ç”¨ä¸Šé¢çš„æ–¹å¼è®¡ç®—å‡ºæ¥<span class="math inline">\(P'\)</span>ã€‚</p><p><span class="math display">\[Q'_{i,:}=P'_{is}\frac{\partial P_{is}}{\partialQ_{i:}}=P'_{is}\frac{\partial P_{is}}{\partial S_{it}}\frac{\partialS_{it}}{\partialQ_{i:}}=(\delta_{st}P_{is}-P_{is}P_{it})P'_{is}K_{t:}=\sum_tP_{it}(O'_{i:}V_{j:}-O'_{i:}O_{i:})K_{t:}\]</span></p><h3 id="v2">V2</h3><p>FlashAttention-V2 çš„ç‰ˆæœ¬åœ¨ V1 çš„åŸºç¡€ä¸Šåšäº†ä¸€äº›å°çš„ä¼˜åŒ–:</p><ol type="1"><li>åŸæ¥åœ¨æ›´æ–°Oçš„è¿‡ç¨‹ä¸­ï¼Œæ¯ä¸€æ­¥éƒ½æ˜¯ç”¨è€çš„<span class="math inline">\(l_{old}\)</span>å’Œæ–°çš„<span class="math inline">\(l_{new}\)</span>å»åšscaleï¼Œå°†æ•´ä¸ªsoftmaxè®¡ç®—ç»“æœä¿æŒåˆ°æ ¹æ®å·²æœ‰æ•°æ®èƒ½ç®—åˆ°æœ€å‡†ç¡®çš„ç»“æœã€‚ä½†æ˜¯å®é™…è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬åªå…³å¿ƒæœ€ç»ˆç»“æœçš„å‡†ç¡®æ€§ï¼Œæ‰€ä»¥ä¸­é—´è¿‡ç¨‹ï¼Œå®Œå…¨ä¸éœ€è¦å»å¯¹Oåšscaleï¼Œåªéœ€è¦ä¸æ–­ç»´æŠ¤æœ€æ–°çš„<span class="math inline">\(l\)</span>,ç­‰åˆ°è®¡ç®—ç»“æŸä¹‹åç»Ÿè®¡åšscale</li><li>åœ¨åå‘è¿‡ç¨‹ä¸­ä¸éœ€è¦ç»´æŠ¤å®Œæ•´çš„<span class="math inline">\(m\)</span><span class="math inline">\(å’Œ\)</span><span class="math inline">\(l\)</span>ï¼Œåªéœ€è¦ç»´æŠ¤<span class="math inline">\(L=m+\logl\)</span>ï¼Œä½†æ˜¯æ„Ÿè§‰è¿™è¾¹æœ¬èº«çš„æ¶ˆè€—å°±åº”è¯¥å¾ˆå°ï¼Ÿ</li></ol><img src="/2025/03/01/attention/fa2.png" class="" title="This is an image"><p>ç®—æ³•çš„æ ¸å¿ƒæ”¹åŠ¨å°±æ˜¯çº¢è‰²åœˆå‡ºæ¥çš„ä¸¤éƒ¨åˆ†ã€‚</p><h3 id="v3">V3</h3><p>é’ˆå¯¹ Hopper GPUï¼Œä¾‹å¦‚ H100 çš„ä¼˜åŒ–</p><h2 id="mqamulti-query-attention">MQA(Multi Query Attention)</h2><p>MQA ç®—æ³•ï¼Œæ˜¯å¯¹ MHA ä¸€ç§è¿‘ä¼¼æ›¿ä»£ï¼Œæ­£å¦‚ä¸Šé¢çœ‹åˆ°çš„ï¼Œåœ¨ MHA ä¸­,<span class="math inline">\(W^Q,&nbsp;W^K,&nbsp;W^V\in\mathbb{R}^{d\times\frac{d}{h}\timesh},\)</span>MQA åˆ™æ˜¯å¯¹äº<span class="math inline">\(W^K,W^V\)</span>åšäº†å…±äº«çš„ä¼˜åŒ–ï¼Œæ‰€æœ‰çš„ headå…±äº«ç›¸åŒçš„å‚æ•°ï¼Œå˜æˆ<span class="math inline">\(W^K,W^V\in\mathbb{R}^{d\times\frac{d}{h}}\)</span>ï¼Œä»¥æ­¤æ¥é™ä½æ•´ä¸ªç®—æ³•çš„è®¡ç®—å¤æ‚åº¦ã€‚</p><h2 id="gqagroup-query-attention">GQA(Group Query Attention)</h2><img src="/2025/03/01/attention/gqa.png" class="" title="This is an image"><p>MQA ç›¸æ¯”äº MHAè·¨åº¦è¿‡å¤§ï¼Œåœ¨å¾ˆå¤šå®éªŒä¸­ï¼Œæ¨¡å‹æ€§èƒ½ä¸‹é™å¾ˆæ˜æ˜¾ï¼Œå› æ­¤åç»­ç ”ç©¶è€…ï¼Œæœ‰æå‡ºæ¥ä¸€ä¸ªé‰´äºMHA å’Œ MQA ä¸­çš„æ–¹æ³•ï¼ŒKey å’Œ Value ä»ä¸åŒ headä¹‹é—´å®Œå…¨ç‹¬ç«‹å’Œå®Œå…¨å…±äº«ï¼Œé€‰æ‹©äº†ä¸€ç§åˆ†ç»„å…±äº«çš„æŠ˜ä¸­æ–¹å¼ï¼Œä»¥æ­¤å¹³è¡¡æ•´ä¸ªæ•ˆç‡å’Œæ€§èƒ½ã€‚</p><p>å¦‚æœæˆ‘ä»¬<span class="math inline">\(h\)</span>ä¸ª head åˆ†æˆäº†<span class="math inline">\(h_g\)</span>ä¸ª Groupï¼Œæˆ‘ä»¬å¯ä»¥çœ‹çœ‹æ•´ä½“ FLOPSå‡å°‘åˆ°å¤šå°‘ã€‚é¦–å…ˆå¯¹æ¯”è¿™ä¸ªè¡¨æ ¼<a href="https://i0imzi7wrro.feishu.cn/docx/LsRGdRBdzobE9YxTXiMclsgsned#share-FRZdd97MTo3RwfxmTOtcsGhqnle">å¤§æ¨¡å‹é‡Œçš„Attention æœºåˆ¶</a>ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼ŒGQA åªæ˜¯é™ä½äº†ç¬¬ä¸€æ­¥çš„ FLOPSï¼Œ</p><p><span class="math display">\[6Nd^2&nbsp;\to&nbsp;2Nd^2+4Nd^2\frac{h_g}{h}\]</span></p><p>ä¸è¿‡åœ¨ GQA çš„æ–‡ç« ä¸­ï¼Œä½œè€…æå‡ºæ¥ä¸€ä¸ª Uptrainingçš„æ€è·¯ï¼Œåšæ³•å¾ˆç®€å•ï¼Œä¸è¿‡å¼€è¾Ÿäº†ä»åŸºäº MHA è®­ç»ƒå¾—åˆ° checkpointsä¹‹åå¯ä»¥è‡ªç”±åˆ‡æ¢åˆ° MQA æˆ–è€… GQA å»è¿›è¡Œfinetuningï¼Œè¿™æ ·å°±å¯ä»¥æå¤§å¯èƒ½çš„ä¿è¯æ€§èƒ½å’Œæ•ˆç‡ã€‚</p><img src="/2025/03/01/attention/uptrain.png" class="" title="This is an image"><p>åšæ³•å°±æ˜¯å¾ˆç®€å•çš„å¯¹äºåŸºäº MHA è®­ç»ƒå¥½çš„ chekpoints çš„<span class="math inline">\(W^K,W^V\)</span>åšåˆ†ç»„ç„¶åå»å¹³å‡ã€‚</p><h2 id="sparse-attention">Sparse Attention</h2><h3 id="swasliding-window-attention">SWA(Sliding Window Attention)</h3><p>SWA(Sliding Window Attention),è¯¥æ–¹æ³•æ˜¯ä¸€ç§â€œå€’é€€â€çš„æƒ³æ³•ã€‚æˆ‘ä»¬çŸ¥é“åœ¨CNN ç±»å‹çš„ç»“æ„ä¸­ï¼Œæ¯ä¸ªå·ç§¯æ“ä½œéƒ½æ˜¯ Localä¿¡æ¯çš„èåˆï¼Œéœ€è¦ä¸æ–­åŠ æ·±ç½‘ç»œçš„æ·±åº¦ï¼Œæ‰èƒ½æ…¢æ…¢æ•æ‰ Global çš„ä¿¡æ¯ã€‚</p><img src="/2025/03/01/attention/cnn.png" class="" title="This is an image"><p>VisionTransformer çš„æå‡ºï¼Œåˆ™æ˜¯æƒ³å€ŸåŠ© Attentionè¿™ç§å…¨å±€çš„æœºåˆ¶ï¼Œå»ç›´æ¥æ•è· Global çš„ä¿¡æ¯ã€‚</p><p>SWA åˆ™æ˜¯è§‰å¾—å…¨å±€ Attention çš„æœºåˆ¶è®¡ç®—å¤æ‚åº¦å¤ªé«˜ï¼Œé€šè¿‡ä½¿ç”¨ Maskçš„æ–¹å¼ï¼Œå°†æ¯å±‚çš„ Attention é™åˆ¶åœ¨å±€éƒ¨ã€‚</p><img src="/2025/03/01/attention/swa.png" class="" title="This is an image"><p>æœ€å·¦è¾¹åˆ™æ˜¯æ­£å¸¸çš„ Attention å¯¹åº”çš„ CasualMaskï¼Œæ˜¯ä¸€ä¸ªä¸‹ä¸‰è§’çŸ©é˜µã€‚ä¸­é—´åˆ™æ˜¯ SWA é™åˆ¶äº† Attention èŒƒå›´çš„ MaskçŸ©é˜µï¼Œæœ€å³è¾¹åˆ™æ˜¯ SWA é€šè¿‡æ·±åº¦ä¸æ–­åŠ æ·±ä¹‹åï¼Œæ•´ä½“ä¸ªæ¨¡å‹è§†é‡å›¾ã€‚</p><p>ä»ä¸Šé¢è¿™ä¸ªå›¾ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° SWA å¸¦æ¥çš„å¥½å¤„æœ‰ä¸‹é¢ä¸¤ä¸ªç‚¹ï¼š</p><ol type="1"><li>ä» FLOPS çš„è§’åº¦æ¥è¯´ï¼ŒMHA è®¡ç®—ä¸­å¾ˆå¤š<span class="math inline">\(\mathcal{O}(N^2)\)</span>çš„æ“ä½œï¼Œéƒ½ä¸ä¼šéšç€<span class="math inline">\(N\)</span>å†ä»¥å¹³æ–¹çš„é€Ÿåº¦å¢é•¿ã€‚</li><li>ä» KV Cache çš„è§’åº¦æ¥è¯´ï¼Œå½“è¶…è¿‡ Window é•¿åº¦çš„ KVå°±ä¸å†éœ€è¦ç¼“å­˜ï¼Œå¤§å¹…åº¦èŠ‚çœäº† Cacheã€‚</li></ol><h3 id="longformer">LongFormer</h3><p>å’Œ SWA è¿™ç§å€Ÿé‰´ CNN æ€æƒ³çš„ Attention æœºåˆ¶ï¼Œåé¢åˆæœ‰ä¸€äº›ç±»ä¼¼çš„ SparseAttention æœºåˆ¶è¢«æå‡ºæ¥ï¼Œæ€»ä½“ç»“æ„å’Œä¸‹é¢çš„å›¾ç±»ä¼¼ã€‚</p><img src="/2025/03/01/attention/la.png" class="" title="This is an image"><h2 id="deepseek-mlamultihead-latent-attention">Deepseek-MLA(MultiHeadLatent Attention)</h2><h3 id="mla-åŸç†">MLA åŸç†</h3><p>Deepseek-V2 åœ¨æŠ€æœ¯æŠ¥å‘Šä¸­æå‡ºæ¥ä»–ä»¬çš„ MLA æŠ€æœ¯ï¼Œä¸»è¦ä»¥æ­¤æ¥é™ä½æ•´ä¸ª KVCache çš„æ¶ˆè€—ï¼ŒåŒæ—¶é™ä½ FLOPSã€‚</p><p>ä»ä¸Šé¢æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨åŸå§‹çš„ MHA ä¸­ï¼Œæ‰€æœ‰çš„<span class="math inline">\(Q,K,V\)</span>éƒ½æ¥è‡ªäºä¸Šä¸€å±‚çš„è¾“å‡ºè¡¨ç¤º<span class="math inline">\(\mathbb{R}^d\)</span>, åŒæ—¶ KV Cache ä¹Ÿéœ€è¦ Cache<span class="math inline">\(\mathcal{O}(2Nd)\)</span>ã€‚åœ¨ MLAå½“ä¸­ï¼Œä½œè€…é‡‡ç”¨äº†ç±»ä¼¼ LORA çš„ä¸€äº›åšæ³•ï¼Œå…ˆå°†<span class="math inline">\(x\in\mathbb{R}^d\)</span>æ˜ å°„åˆ°ä¸€ä¸ªä½ç»´çš„ç©ºé—´ï¼Œ</p><p><span class="math display">\[\begin{gather}c^{KV}=xW_{D}^{KV},&nbsp;c^Q=xW_{D}^{Q}\\W_{D}^{KV}\in\mathbb{R}^{d\timesd_c^{KV}},&nbsp;W_{D}^{Q}\in&nbsp;\mathbb{R}^{d\timesd_{c}^Q}\\&nbsp;d_c^{KV},d_c^{Q}&nbsp;\ll&nbsp;d\end{gather}\]</span></p><p>é‚£ä¹ˆè¿™ä¸ªæ—¶å€™ï¼Œæ‰€æœ‰çš„<span class="math inline">\(K,V\)</span>éƒ½æ˜¯åŸºäºè¿™ä¸ªå…±æœ‰çš„<span class="math inline">\(c\)</span>å†å‡ç»´ä¸Šå»ï¼Œå³ï¼š</p><p><span class="math display">\[\begin{gather}k=c^{KV}W_{U}^{K},v=c^{KV}W_{U}^{V},W_{U}^{K},&nbsp;q=c^QW_{U}^Q\\W_{U}^V&nbsp;\in&nbsp;\mathbb{R}^{d_c^{KV}\times&nbsp;d},&nbsp;W_{U}^Q\in&nbsp;\mathbb{R}^{d_c^Q\times d}\end{gather}\]</span></p><p>é‚£æˆ‘ä»¬åˆ†åˆ«ä» FLOPS å’Œ KV Cache çš„è§’åº¦æ¥çœ‹è¿™ä¹ˆåšçš„å¥½å¤„ï¼š</p><ol type="1"><li><strong>FLOPS</strong>: å¯¹äº<span class="math inline">\(Q,K,V\)</span>çš„è®¡ç®—çš„éœ€è¦çš„ FLOPS ä» <span class="math inline">\(6Nd^2\)</span>å˜æˆäº†<span class="math inline">\(6Ndd_c^{KV}+4Ndd_c^Q\)</span>ï¼Œè€Œ<span class="math inline">\(d_c^{KV},d_c^{Q} \ll d\)</span>ï¼Œå› æ­¤ FLOPSçš„å¾—åˆ°äº†å¤§å¹…åº¦å‡å°‘ã€‚</li><li><strong>KVCache</strong>: åŸå§‹ MHA çš„ KV Cache æ¯å±‚éœ€è¦ <span class="math inline">\(2Nd\)</span>ï¼ŒMLAçš„KV Cacheåªéœ€è¦<span class="math inline">\(Nd_c^{KV}\)</span> å› æ­¤ä¹Ÿå¤§å¹…åº¦å‡å°‘äº†ã€‚</li></ol><p><u>é‚£ä¹ˆå½“ç„¶ç¬¬ä¸€ä¸ªç–‘é—®æ˜¯ä¸æ˜¯å¦‚æœæˆ‘ä»¬åªç¼“å­˜</u><span class="math inline">\(c^{KV}\)</span><u>ï¼Œé‚£ä¹ˆåœ¨æ¨ç†çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦å®æ—¶å»è®¡ç®—</u><span class="math inline">\(c^{KV}W_U^K,c^{KV}W_U^V\)</span><u>è¿™ä¸¤ä¸ªçŸ©é˜µä¹˜æ³•ï¼Œé‚£ä¹ˆ MLAæ˜¯ä¸æ˜¯ä¸€ç§ä»¥æ—¶é—´æ¢å–ç©ºé—´çš„ç­–ç•¥å‘¢ï¼Ÿ</u></p><p>å½“ç„¶ï¼Œè¿™è¾¹ä½œè€…ä»¬å‘ç°åœ¨æ¨ç†é˜¶æ®µï¼Œå¯ä»¥å¯¹æ¨¡å‹ç®—å­åšèåˆï¼Œä»è€Œé¿å…ä¸Šé¢çš„è®¡ç®—å¼€é”€ã€‚æˆ‘ä»¬ä»¥<span class="math inline">\(qk^T\)</span>çš„è®¡ç®—ä¸ºä¾‹ï¼Œçœ‹çœ‹å¦‚ä½•è¿›è¡Œèåˆæ‰<span class="math inline">\(W_U^K\)</span>ã€‚</p><p><span class="math display">\[qk^T=c^QW_U^Q(W_U^K)^T(c^{KV})^T:=c^QW_U^{QK}(c^{KV})^T\]</span></p><p>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å°†<span class="math inline">\(W_U^K\)</span>èå…¥åˆ°<span class="math inline">\(W_U^Q\)</span>å½“ä¸­å»ã€‚ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†<span class="math inline">\(W_U^V\)</span>èåˆåˆ°<span class="math inline">\(W^O\)</span>ï¼Œå³ Attention çš„ FFNçš„æƒé‡å½“ä¸­å»ï¼Œé¿å…é‡å¤è®¡ç®—ã€‚</p><p>å› æ­¤åœ¨æ¨ç†é˜¶æ®µï¼Œå¦‚æœè€ƒè™‘ç®—å­çš„èåˆ FLOPS ä¼šè¿›ä¸€æ­¥ä» <span class="math inline">\(6Ndd_c^{KV}+4Ndd_c^Q\)</span>å‹ç¼©åˆ°<span class="math inline">\(2N(dd_c^{KV}+dd_c^Q+d_c^Qd_c^{KV})\)</span></p><h3 id="mla-çš„-rope">MLA çš„ RoPE</h3><p>æˆ‘ä»¬çŸ¥é“åœ¨ Transformer æ¶æ„ä¸­ï¼Œéƒ½ä¼šåŠ å…¥ Position Encodingæ¥è®©æ¨¡å‹æ„ŸçŸ¥åˆ°æ¯ä¸ª Token åœ¨æ—¶é—´åºåˆ—ä¸­æ‰€å¤„çš„ä½ç½®ã€‚å½“ç„¶ï¼Œå¯¹äº PositionEncoding çš„ä¹Ÿæœ‰å¾ˆå¤šè®¨è®ºï¼Œä¸è¿‡ç°åœ¨çš„ä¸»æµ LLM éƒ½å‡ ä¹ä½¿ç”¨RoPEï¼Œè¿™è¾¹æˆ‘ä»¬å°±ç®€å•ä»‹ç»ä¸€ä¸‹ RoPE çš„åŸç†ã€‚</p><p>åœ¨ç¬”è€…çœ‹æ¥ï¼ŒRoPE çš„ç‰¹ç‚¹å¯ä»¥æ€»ç»“æˆå¦‚ä¸‹çš„ä¸€å¥è¯ï¼š</p><p><strong>RoPE å¯»æ±‚ä¸€ç§ç»å¯¹ä½ç½®çš„ PEè¡¨ç¤ºæ–¹æ³•ï¼Œä½†æ˜¯åˆå¯ä»¥ä¿è¯åœ¨è®¡ç®—</strong><span class="math inline">\(qk^T\)</span><strong>çš„æ—¶å€™èƒ½ä¿æŒç›¸å¯¹ä½ç½®çš„ä¸€è‡´æ€§ã€‚</strong></p><p>è€Œ<span class="math inline">\(qk^T\)</span>ä½œä¸ºä¸€ç§å†…ç§¯çš„è®¡ç®—ï¼Œæ»¡è¶³ä¸Šé¢çš„è¦æ±‚çš„è¡¨ç¤ºï¼Œå¾ˆæ˜¾ç„¶å°±æ˜¯æ—‹è½¬çŸ©é˜µã€‚å› æ­¤ï¼Œå¯¹äºä¼ ç»Ÿçš„MHAï¼Œæˆ‘ä»¬åˆ™å¯ä»¥ä¹˜ä¸Šä¸€ä¸ªæ—‹è½¬çŸ©é˜µ,</p><p><span class="math display">\[q_i^R=q_iR(i,\theta),k_j^R=k_jR(j,\theta)\]</span></p><p>è¿™è¾¹<span class="math inline">\(i,j\)</span>ä»£è¡¨çš„æ˜¯ç¬¬<span class="math inline">\(i,j\)</span>ä¸ª tokenã€‚é‚£ä¹ˆï¼Œ</p><p><span class="math display">\[q_i^R(k_j^R)^T=q_iR(i,\theta)R^T(j,\theta)k_j^T=q_iR(i-j,\theta)k_j^T\]</span></p><p>ä¿è¯äº†ç›¸å¯¹ä½ç½®çš„ä¸€è‡´æ€§ã€‚</p><p>é‚£ä¹ˆå¦‚æœæˆ‘ä»¬ç›´æ¥å°†è¿™ç§æ–¹å¼ä» MHA æ¨å¹¿åˆ°MLAï¼Œä¼šé‡åˆ°æ€ä¹ˆæ ·çš„é—®é¢˜å‘¢ï¼Ÿ</p><p><span class="math display">\[q_i^R(k_j^R)^T=c_i^QW_U^QR(i,\theta)R^T(j,\theta)(W_U^K)^T(c_j^{KV})^T\]</span></p><p>ä»ä¸Šé¢çš„è¡¨è¾¾å¼ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªæ—‹è½¬çŸ©é˜µ<span class="math inline">\(R(i,\theta),R(j,\theta)\)</span>æ’åœ¨äº†ä¸¤ä¸ª<span class="math inline">\(W\)</span>ä¸­é—´ï¼Œè€Œè¿™ä¸¤ä¸ªæ—‹è½¬çŸ©é˜µåˆå’Œç»å¯¹çš„ä½ç½®<span class="math inline">\(i,j\)</span>æœ‰å…³ç³»ï¼Œå› æ­¤æˆ‘ä»¬å°±æ²¡æœ‰åŠæ³•å»åšç®—å­èåˆï¼Œè¿™å°±è®©MLA åœ¨æ¨ç†é˜¶æ®µçš„æ€§èƒ½ä¼˜åŠ¿å¤§å¹…åº¦é™ä½ã€‚</p><p>é‚£ä¹ˆåœ¨ Deepseek çš„ V2ä¸­ï¼Œé‡‡å–äº†ä¸€ç§æŠ˜ä¸­çš„å¤„ç†æ–¹å¼ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒDeepseekå¤„ç†æ–¹å¼å…¶å®æ˜¯åœ¨ä¸€å®šç¨‹åº¦ä¸Šï¼Œç ´åäº† RoPE çš„è®¾è®¡ç†å¿µçš„ï¼Œå³ï¼š</p><p><strong>DeepSeek-MLA-RoPE æ˜¯ä¸èƒ½ä¿æŒç›¸å¯¹ä½ç½®çš„ä¸€è‡´æ€§çš„ã€‚</strong></p><p>Deepseek é¢å¤–å¼•å…¥äº†<span class="math inline">\(q^R,k^R\)</span>ä½¿ç”¨RoPE ç¼–ç ä½ç½®ä¿¡æ¯ï¼Œå³:</p><p><span class="math display">\[q^R:=\mathrm{RoPE}\left(c^QW^{QR}\right),k^R:=\mathrm{RoPE}\left(xW^{KR}\right),W^{QR}\in\mathbb{R}^{d_c^Q\times&nbsp;d_R},&nbsp;W^{KR}\in\mathbb{R}^{d\timesd_R}\]</span></p><p>ç„¶åä½¿ç”¨äº†æš´åŠ›æ‹¼æ¥çš„æ–¹æ³•å¾—åˆ°äº†<span class="math inline">\(q,k\)</span>:</p><p><span class="math display">\[q\leftarrow&nbsp;[q, q^R],&nbsp;k&nbsp;\leftarrow&nbsp;[k, k^R]\]</span></p><h1 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h1><p>Ainslie, Joshua, James Lee-Thorp, Michiel de Jong, Yury Zemlyanskiy,Federico LebrÃ³n, and Sumit Sanghai. â€œGQA: Training GeneralizedMulti-Query Transformer Models from Multi-Head Checkpoints.â€ arXiv,December 23, 2023. <a href="https://doi.org/10.48550/arXiv.2305.13245">https://doi.org/10.48550/arXiv.2305.13245</a>.</p><p>Beltagy, Iz, Matthew E. Peters, and Arman Cohan. â€œLongformer: TheLong-Document Transformer.â€ arXiv, December 2, 2020. <a href="https://doi.org/10.48550/arXiv.2004.05150">https://doi.org/10.48550/arXiv.2004.05150</a>.</p><p>Dao, Tri, Daniel Y. Fu, Stefano Ermon, Atri Rudra, and ChristopherRÃ©. â€œFlashAttention: Fast and Memory-Efficient Exact Attention withIO-Awareness.â€ arXiv, June 23, 2022. <a href="https://doi.org/10.48550/arXiv.2205.14135">https://doi.org/10.48550/arXiv.2205.14135</a>.</p><p>Lu, Enzhe, Zhejun Jiang, Jingyuan Liu, Yulun Du, Tao Jiang, ChaoHong, Shaowei Liu, et al. â€œMOBA: MIXTURE OF BLOCK ATTENTION FORLONG-CONTEXT LLMS,â€ n.d.</p><p>Shah, Jay, Ganesh Bikshandi, Ying Zhang, Vijay Thakkar, PradeepRamani, and Tri Dao. â€œFlashAttention-3: Fast and Accurate Attention withAsynchrony and Low-Precision.â€ arXiv, July 12, 2024. <a href="https://doi.org/10.48550/arXiv.2407.08608">https://doi.org/10.48550/arXiv.2407.08608</a>.</p><p>Shazeer, Noam. â€œFast Transformer Decoding: One Write-Head Is All YouNeed.â€ arXiv, November 5, 2019. <a href="http://arxiv.org/abs/1911.02150">http://arxiv.org/abs/1911.02150</a>.</p><p>Vaswani, Ashish, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, LlionJones, Aidan N. Gomez, Lukasz Kaiser, and Illia Polosukhin. â€œAttentionIs All You Need.â€ arXiv, August 2, 2023. <a href="https://doi.org/10.48550/arXiv.1706.03762">https://doi.org/10.48550/arXiv.1706.03762</a>.</p><p>Yuan, Jingyang, Huazuo Gao, Damai Dai, Junyu Luo, Liang Zhao,Zhengyan Zhang, Zhenda Xie, et al. â€œNative Sparse Attention:Hardware-Aligned and Natively Trainable Sparse Attention.â€ arXiv,February 16, 2025. <a href="https://doi.org/10.48550/arXiv.2502.11089">https://doi.org/10.48550/arXiv.2502.11089</a>.</p><p>DeepSeek-AI, Aixin Liu, Bei Feng, Bin Wang, Bingxuan Wang, Bo Liu,Chenggang Zhao, et al. â€œDeepSeek-V2: A Strong, Economical, and EfficientMixture-of-Experts Language Model.â€ arXiv, June 19, 2024. <a href="http://arxiv.org/abs/2405.04434">http://arxiv.org/abs/2405.04434</a>.</p><p>DeepSeek-AI, Aixin Liu, Bei Feng, Bing Xue, Bingxuan Wang, Bochao Wu,Chengda Lu, et al. â€œDeepSeek-V3 Technical Report.â€ arXiv, December 27,2024. <a href="https://doi.org/10.48550/arXiv.2412.19437">https://doi.org/10.48550/arXiv.2412.19437</a>.</p><p>Touvron, Hugo, Louis Martin, and Kevin Stone. â€œLlama 2: OpenFoundation and Fine-Tuned Chat Models,â€ n.d.</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Overfitting Testing</title>
      <link href="/2024/09/01/overfit/"/>
      <url>/2024/09/01/overfit/</url>
      
        <content type="html"><![CDATA[<h1 id="overfitting-testing">Overfitting Testing</h1><p>åœ¨LLMç››è¡Œçš„å½“ä¸‹ï¼Œç ”ç©¶äººå‘˜å‡ºå‘ç‚¹éƒ½å˜æˆäº†æ„å»ºä¸€ä¸ªè¶…çº§å¤§çš„æ¨¡å‹ï¼Œå»æ‹Ÿåˆæ•´ä¸ªäººç±»ç¤¾ä¼šçš„æ•°æ®(pre-training)ï¼Œå¹¶é€šè¿‡ä¸€äº›æŠ€æœ¯å‘äººç±»æ¼”åŒ–å‡ºæ¥çš„äº¤äº’æ–¹å¼å»åšalignment(post-training)ã€‚å¤§å®¶ä¼¼ä¹å¯¹äºè¿‡æ‹Ÿåˆè¿™ä¸€ä¸ªåŸæ¥æœºå™¨å­¦ä¹ ä¸­éå¸¸åŸºç¡€çš„è®®é¢˜ä¸å†å…³æ³¨ï¼Œ</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> äººå·¥æ™ºèƒ½ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æœºå™¨å­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Position Based Dynamics</title>
      <link href="/2024/06/01/pbd/"/>
      <url>/2024/06/01/pbd/</url>
      
        <content type="html"><![CDATA[<h1 id="position-based-dynamics">Position Based Dynamics</h1><blockquote><p>ğŸ–Œ PBDè¿™ä¸€ç±»ç‰©ç†æ¨¡æ‹Ÿæ–¹æ³•ï¼Œä¸åŒäºåŸºäºç»å…¸åŠ›å­¦é‚£å¥—æ–¹æ³•ï¼Œå†™å‡ºåŠ¨åŠ›å­¦æ–¹ç¨‹ï¼Œç„¶åæ•°å€¼æ±‚è§£PDEçš„èŒƒå¼ã€‚è€Œæ˜¯ç›´æ¥åªè€ƒè™‘å¤–åŠ›ä½œç”¨ï¼Œå°†å†…åŠ›å…¨éƒ¨å½’ç»“äºä¸åŒçš„çº¦æŸæ¡ä»¶è€ƒè™‘ã€‚ä½¿ç”¨æŠ•å½±çš„æ–¹æ³•å»è§£å†³å¤–åŠ›ä½œç”¨æ›´æ–°ä¹‹åçš„çº¦æŸä¹‹é—´çš„å†²çªé—®é¢˜ã€‚</p></blockquote><h1 id="basic-info">Basic info</h1><blockquote><p>PBD ç›¸å…³çš„ç‰©ç†æ¨¡æ‹Ÿæ–¹æ³•</p></blockquote><ul><li><p><strong>Author: anschen</strong></p></li><li><p><strong>Reading cycle</strong></p><ul><li><strong>Start date 2024/05/23</strong></li><li><strong>End date 2024/06/10</strong></li></ul></li></ul><h1 id="notations">Notations</h1><hr><p>ä¸‰ç»´ç©ºé—´çš„å‘é‡ å¯¹æ—¶é—´æ±‚å…¨å¯¼æ•°</p><p><span class="math display">\[\mathbf{x}\]</span></p><p><span class="math display">\[\dot{x}\]</span></p><hr><h1 id="position-based-dynamics-1">Position Based Dynamics</h1><p>åœ¨è¿™ä¸ªç« èŠ‚ï¼Œæˆ‘ä»¬å°†ä¸»è¦ä»‹ç»åŸå§‹çš„ PBDç®—æ³•çš„ç»†èŠ‚å’ŒåŸç†ï¼Œä»è€Œæ„å»ºä¸€ä¸ªå®Œæ•´çš„ PBD è¿™å¥—æ–¹æ³•è®ºçš„å¤§æ¡†æ¶ã€‚</p><h2 id="model">Model</h2><p>æˆ‘ä»¬è€ƒè™‘å¦‚ä¸‹å»ºæ¨¡åœºæ™¯ï¼Œå¯¹äºä¸€ä¸ªç‰©ä½“ï¼Œæœ‰<span class="math inline">\(N\)</span>ä¸ªé¡¶ç‚¹ï¼Œ <span class="math inline">\(M\)</span>ä¸ªçº¦æŸæ¡ä»¶ï¼Œæ¯ä¸ªé¡¶ç‚¹çš„è´¨é‡ï¼Œä½ç½®ï¼Œé€Ÿåº¦åˆ†åˆ«ä¸º<span class="math inline">\(m_i,\mathbf{x}_i,\mathbf{v}_i\)</span>ã€‚è¿™è¾¹çš„çº¦æŸæ¡ä»¶å¯ä»¥æŒ‰ç…§å¦‚ä¸‹çš„è¯­è¨€æè¿°ï¼š</p><ol type="1"><li>A cardinality <span class="math inline">\(n_j\)</span></li><li>A function <span class="math inline">\(C_j:\mathbb{R}^{3n_j}&nbsp;\to&nbsp;\mathbb{R}\)</span></li><li>A set of indices <span class="math inline">\(\{i_1,&nbsp;\cdots,&nbsp;i_{n_j}\},&nbsp;i_k&nbsp;\in&nbsp;[1, \cdots,N]\)</span></li><li>A stiffness parameter <span class="math inline">\(k_j&nbsp;\in&nbsp;[0,1]\)</span></li><li>A type of <em>equality</em> or <em>inequality </em>, i.e. <span class="math inline">\(C_j(\mathbf{x}_{i_1},\cdots,&nbsp;\mathbf{x}_{i_{n_j}})&nbsp;=&nbsp;0;\)</span>or <span class="math inline">\(C_j(\mathbf{x}_{i_1},\cdots,&nbsp;\mathbf{x}_{i_{n_j}})&nbsp;\ge&nbsp;0\)</span></li></ol><h2 id="algorithm">Algorithm</h2><img src="/2024/06/01/pbd/pbd_algo.png" class="" title="This is an image"><p>ç®—æ³•æ€»ç»“ï¼š</p><ol type="1"><li>ç¬¬ 5 æ­¥ï¼Œåªè€ƒè™‘å¤–åŠ›çš„ä½œç”¨ï¼Œç›¸å¯¹ç®€å•ã€‚</li><li>ç¬¬ 7-8 ä¸¤æ­¥ï¼Œä½¿ç”¨ä¸´æ—¶çš„ä½ç½®å»ç”Ÿæˆæ–°çš„ç¢°æ’çº¦æŸã€‚</li><li>ç¬¬ 9-11æ­¥ï¼Œåˆ™æ˜¯æ•´ä¸ªç®—æ³•çš„æ ¸å¿ƒï¼Œå¦‚ä½•é€šè¿‡æŠ•å½±çš„æ–¹å¼æ¥è§£å†³æ•´ä¸ªçº¦æŸä¹‹é—´çš„å†²çªå…³ç³»ã€‚</li><li>ç¬¬ 12-16æ­¥ï¼Œåˆ™é€šè¿‡ä½¿ç”¨è§£å†³å®Œå†²çªä¹‹åçš„ä½ç½®ï¼Œè®¡ç®—é€Ÿåº¦ï¼Œä»¥æ­¤ä¿è¯æ•´ä¸ªè¿‡ç¨‹çš„ä¸€è‡´æ€§ã€‚</li></ol><h3 id="constraint-projection">Constraint Projection</h3><p>åœ¨è¿™ä¸ªå°èŠ‚ï¼Œæˆ‘ä»¬å°†è¯¦ç»†ä»‹ç»å¦‚ä½•é€šè¿‡è¿­ä»£æŠ•å½±çš„æ–¹æ³•å»è§£å†³çº¦æŸé—®é¢˜ã€‚</p><p>é¦–å…ˆåœ¨ç»è¿‡ç®—æ³•ç¬¬ 5-6æ­¥ä¹‹åï¼Œå¤–åŠ›å¯¹ç³»ç»Ÿçš„å½±å“ï¼Œå·²ç»è¢«å½’çº³è¿›å…¥ä¸´æ—¶çš„ä½ç½®<span class="math inline">\(\mathbf{p}_i\)</span>ï¼Œé‚£ä¹ˆåœ¨çº¦æŸæŠ•å½±è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬éœ€è¦æˆ‘ä»¬çš„ç³»ç»Ÿæ»¡è¶³ä¸‹é¢ä¸¤æ¡ç‰©ç†å®šå¾‹ï¼ˆä¸‹é¢çš„ä¸¤ä¸ªæ–¹ç¨‹éƒ½å¿½ç•¥äº†å›ºå®šæ—¶é—´é—´éš”<span class="math inline">\(\Delta t\)</span>ï¼‰ï¼š</p><ol type="1"><li>åŠ¨é‡å®ˆæ’ <span class="math inline">\(\sum_i&nbsp;m_i&nbsp;\Delta\mathbf{p}_i&nbsp;=&nbsp;0\)</span></li><li>è§’åŠ¨é‡å®ˆæ’ <span class="math inline">\(\sum_i&nbsp;\mathbf{r}_i&nbsp;\times&nbsp;m_i&nbsp;\Delta\mathbf{p}_i&nbsp;=&nbsp;0\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(\mathbf{r}_i\)</span>ä¸º<span class="math inline">\(\mathbf{p}_i\)</span>åˆ°ä»»æ„æ—‹è½¬ä¸­å¿ƒçš„çŸ¢é‡ã€‚</li></ol><p>å¯¹äºåˆšä½“ç³»ç»Ÿï¼Œæˆ‘ä»¬çŸ¥é“ä»»æ„çš„çº¦æŸ<span class="math inline">\(C(\mathbf{p}),&nbsp;\mathbf{p}=(\mathbf{p}_1^T,&nbsp;\cdots,&nbsp;\mathbf{p}_n^T)^T\)</span>éƒ½åº”è¯¥æ»¡è¶³<strong>å¹³ç§»ä¸å˜æ€§</strong>å’Œ<strong>æ—‹è½¬ä¸å˜æ€§</strong>ã€‚å› æ­¤ï¼Œè¿™è¾¹æˆ‘ä»¬å¯ä»¥å€Ÿé‰´ç»å…¸åŠ›å­¦ä¸­çš„è¯ºç‰¹å®šç†[<a href="https://en.wikipedia.org/wiki/Noether%27s_theorem">https://en.wikipedia.org/wiki/Noether%27s_theorem</a>]çš„æ¨å¯¼æ–¹å¼ï¼Œå¾—å‡ºå¦‚ä¸‹é‡è¦çš„ç»“è®ºã€‚</p><blockquote><p>NOTE å¦‚æœæ‰€æœ‰é¡¶ç‚¹çš„è´¨é‡<span class="math inline">\(m_i\)</span>éƒ½ç›¸ç­‰ï¼Œé‚£ä¹ˆæ²¿ç€<span class="math inline">\(\nabla_{\mathbf{p}}C(\mathbf{p})\)</span>æ›´æ–°<span class="math inline">\(\Delta\mathbf{p}\)</span>ï¼Œæ›´æ–°åçš„ç³»ç»Ÿè‡ªåŠ¨æ»¡è¶³åŠ¨é‡å®ˆæ’å’Œè§’åŠ¨é‡å®ˆæ’ã€‚</p></blockquote><p>è¯æ˜åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šåŠ¨é‡å®ˆæ’å’Œè§’åŠ¨é‡å®ˆæ’</p><h4 id="åŠ¨é‡å®ˆæ’">åŠ¨é‡å®ˆæ’</h4><p><span class="math display">\[C(\mathbf{p}+\Delta\mathbf{p})&nbsp;=&nbsp;C(\mathbf{p})&nbsp;+&nbsp;\nabla_{\mathbf{p}}C(\mathbf{p})\Delta\mathbf{p}+o(\Delta\mathbf{p}^2)\]</span></p><p>å¦‚æœ<span class="math inline">\(\Delta\mathbf{p}_i&nbsp;=&nbsp;\delta\mathbf{r},&nbsp;\forall&nbsp;i&nbsp;\in&nbsp;[1,n]&nbsp;\)</span>ï¼Œå³æ‰€æœ‰é¡¶ç‚¹å¹³ç§»ä¸€ä¸ªç›¸åŒçš„æ— é™å°ä½ç§»<span class="math inline">\(\delta\mathbf{r}\)</span>ï¼Œé‚£ä¹ˆå¹³ç§»ä¸å˜æ€§è¦æ±‚å¦‚ä¸‹çš„æ–¹ç¨‹æˆç«‹:</p><p><span class="math display">\[\sum_i&nbsp;\nabla_{\mathbf{p}_i}C(\mathbf{p})\delta\mathbf{r}&nbsp;=&nbsp;0,&nbsp;\forall&nbsp;\delta\mathbf{r}\]</span></p><p>å› æ­¤ï¼Œå¦‚æœ<span class="math inline">\(m_i&nbsp;=&nbsp;m\)</span>ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°åŠ¨é‡å®ˆæ’ï¼š<span class="math inline">\(0 =m\sum_i\nabla_{\mathbf{p}_i}C(p)&nbsp;=&nbsp;\sum_im_i&nbsp;\nabla_{\mathbf{p}_i}C(p)\)</span></p><h4 id="è§’åŠ¨é‡å®ˆæ’">è§’åŠ¨é‡å®ˆæ’</h4><img src="/2024/06/01/pbd/angular.png" class="" title="This is an image"><p>å¯¹äºæ—‹è½¬ä¸å˜æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ä»¿ç…§å¹³ç§»ä¸å˜æ€§ï¼Œå¯¹<span class="math inline">\(C(\mathbf{p})\)</span>æ–½åŠ ä¸€ä¸ªç±»ä¼¼çš„æ— ç©·å°æ—‹è½¬å˜æ¢ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚é‚£ä¹ˆè¿™ä¸ªæ—¶å€™ï¼Œæ— ç©·å°æ—‹è½¬å˜åŒ–çš„å¯¹åº”çš„åç§»çŸ¢é‡<span class="math inline">\(\delta\mathbf{r}=\delta\mathbf{\Theta}&nbsp;\times&nbsp;\mathbf{r}\)</span>ï¼Œå› æ­¤</p><p><span class="math display">\[\sum_i&nbsp;\nabla_{\mathbf{p}_i}C(\mathbf{p})&nbsp;\delta\mathbf{\Theta}&nbsp;\times&nbsp;\mathbf{r}_i&nbsp;=&nbsp;\delta\mathbf{\Theta}&nbsp;\cdot\sum_i&nbsp;\mathbf{r}_i&nbsp;\times&nbsp;\nabla_{\mathbf{p}_i}C(\mathbf{p})&nbsp;=&nbsp;0,&nbsp;\forall&nbsp;\delta\mathbf{\Theta}\]</span></p><p>å› æ­¤ï¼Œå¦‚æœ<span class="math inline">\(m_i&nbsp;=&nbsp;m\)</span>ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°åŠ¨é‡å®ˆæ’ï¼š<span class="math inline">\(0&nbsp;=&nbsp;m&nbsp;\sum_i&nbsp;\mathbf{r}_i&nbsp;\times&nbsp;\nabla_{\mathbf{p}_i}C(\mathbf{p})&nbsp;=&nbsp;\sum_i&nbsp;\mathbf{r}_i&nbsp;\times&nbsp;m_i\nabla_{\mathbf{p}_i}C(\mathbf{p})\)</span></p><h4 id="æ›´æ–°å°ºåº¦">æ›´æ–°å°ºåº¦</h4><p>åœ¨æˆ‘ä»¬ç¡®å®šäº†<span class="math inline">\(\Delta\mathbf{p}\)</span>çš„æ›´æ–°æ–¹å‘ä¹‹åï¼Œæ¥ä¸‹æ¥ç¡®å®šæ›´æ–°çš„æ­¥å¹…åˆ™å¯ä»¥å®Œæˆæ•´ä¸ªæ›´æ–°å·¥ä½œï¼Œæœ€èµ·ç å¯¹äºè´¨é‡æ˜¯ä¸€æ ·çš„æƒ…å†µæ˜¯è¿™æ ·ã€‚è€ƒè™‘equality ç±»å‹çš„çº¦æŸï¼Œå³<span class="math inline">\(C(\mathbf{p}+\Delta\mathbf{p})=0,&nbsp;\Delta\mathbf{p}=\lambda&nbsp;\nabla_{\mathbf{p}}C(p)\)</span>ï¼Œæˆ‘ä»¬å¯ä»¥å®¹æ˜“æ±‚è§£å‡ºæ¥ï¼š</p><p><span class="math display">\[\lambda&nbsp;=&nbsp;-\frac{C(\mathbf{p})}{\|\nabla_\mathbf{p}C(\mathbf{p})\|^2}\]</span></p><h4 id="ä¸åŒè´¨é‡">ä¸åŒè´¨é‡</h4><p>åœ¨ä¸Šé¢çš„è®¨è®ºä¸­ï¼Œæˆ‘ä»¬å®Œæ•´äº†è®¨è®ºäº†ï¼Œå¦‚æœè´¨é‡æ˜¯ç›¸åŒæƒ…å†µï¼ŒæŠ•å½±æ›´æ–°è§„åˆ™ã€‚ä½†æ˜¯å¦‚æœè´¨é‡å„ä¸ç›¸åŒï¼Œåˆ™ä¸Šé¢æ‰€è¯´çš„åŠ¨é‡å’Œè§’åŠ¨é‡å®ˆæ’åˆ™ä¼šè¢«ç ´åã€‚ä»¥åŠ¨é‡å®ˆæ’ä¸ºä¾‹ï¼Œå¹³ç§»ä¸å˜æ€§åªèƒ½å¾—åˆ°<span class="math inline">\(\sum_i\nabla_{\mathbf{p}_i}C(p)=0\)</span>ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å¦‚æœæˆ‘ä»¬ä»ç„¶è¦æ±‚<span class="math inline">\(\sum_im_i&nbsp;\Delta\mathbf{p}_i&nbsp;=&nbsp;0ï¼Œ\Delta\mathbf{p}_i&nbsp;=&nbsp;\lambda_i&nbsp;\nabla_{\mathbf{p}_i}C(\mathbf{p})\)</span>ï¼Œä¸€ä¸ªæ¯”è¾ƒå¥½çš„å¤„ç†æ–¹å¼ï¼šæ ¹æ®å„ä¸ªé¡¶ç‚¹çš„è´¨é‡<span class="math inline">\(m_i\)</span>å»è°ƒæ•´æ›´æ–°çš„æ­¥å¹…<span class="math inline">\(\lambda_i\)</span>ã€‚</p><p><span class="math display">\[\lambda_i&nbsp;=&nbsp;-\frac{w_i C(\mathbf{p})}{\sum_i w_i\|\nabla_{\mathbf{p_i}}C(\mathbf{p})\|^2},w_i=\frac{1}{m_i}\]</span></p><p>å¯¹äºè¿™æ ·çš„æ›´æ–°æ³•åˆ™ï¼Œå¯ä»¥åŒæ—¶ä¿è¯ä¸‰ä»¶äº‹ï¼š</p><ol type="1"><li>åŠ¨é‡å®ˆæ’</li><li>è§’åŠ¨é‡å®ˆæ’</li><li><span class="math inline">\(C(\mathbf{p}+\Delta\mathbf{p})=0\)</span></li></ol><h4 id="inequality-çº¦æŸæ¡ä»¶">Inequality çº¦æŸæ¡ä»¶</h4><p>ä¸Šé¢çš„è®¨è®ºéƒ½æ˜¯é’ˆå¯¹äº† Equality ç±»å‹çš„çº¦æŸæ¡ä»¶è¿›è¡Œçš„ï¼Œå³<span class="math inline">\(C(\mathbf{p}+\Delta\mathbf{p})=0\)</span>ï¼Œå¯¹äºInequality ç±»å‹çš„çº¦æŸæ¡ä»¶ï¼Œæˆ‘ä»¬åˆ™å¯ä»¥æ¯”è¾ƒå¥½çš„å¤„ç†ï¼Œå› ä¸º<span class="math inline">\(\nabla_{\mathbf{p}_i}C(\mathbf{p})\)</span>ä»£è¡¨<span class="math inline">\(C(\mathbf{p})\)</span>å¢åŠ æœ€å¿«çš„æ–¹å‘ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬çš„è¦æ±‚æ˜¯<span class="math inline">\(C(\mathbf{p}+\Delta\mathbf{p})\ge&nbsp;0\)</span>ï¼Œæˆ‘ä»¬åˆ™å¯ä»¥é€‰æ‹©åªå¯¹é‚£äº›çº¦æŸæ¡ä»¶è¿˜å°äº0 çš„çº¦æŸè¿›è¡ŒæŠ•å½±æ›´æ–°ã€‚</p><h4 id="stiffness">Stiffness</h4><p>åˆšåº¦(Stiffness)æ˜¯æŒ‡ç‰©ä½“æŠµæŠ—å½¢å˜çš„èƒ½åŠ›ã€‚åœ¨ç‰©ç†æ¨¡æ‹Ÿä¸­ï¼Œåˆšåº¦å†³å®šäº†ç‰©ä½“åœ¨å—åˆ°å¤–åŠ›ä½œç”¨æ—¶çš„å½¢å˜ç¨‹åº¦ã€‚</p><ul><li><p><strong>é«˜åˆšåº¦</strong>ï¼šå¦‚æœä¸€ä¸ªç‰©ä½“æˆ–ç³»ç»Ÿçš„åˆšåº¦å¾ˆé«˜ï¼Œè¿™æ„å‘³ç€å®ƒä¸å®¹æ˜“å½¢å˜ã€‚åœ¨æ¨¡æ‹Ÿä¸­ï¼Œé«˜åˆšåº¦çš„ç‰©ä½“åœ¨å—åˆ°åŠ›çš„ä½œç”¨æ—¶ä¼šè¡¨ç°å‡ºè¾ƒå°çš„å½¢å˜ï¼Œè¿™ä¼šä½¿å¾—ç‰©ä½“çœ‹èµ·æ¥æ›´ç¡¬æˆ–æ›´ç´§ç»·ã€‚ä¾‹å¦‚ï¼Œä¸€æ ¹ç¡¬æœ¨æ£åœ¨å—åŠ›æ—¶å‡ ä¹ä¸ä¼šå¼¯æ›²ã€‚</p></li><li><p><strong>ä½åˆšåº¦</strong>ï¼šç›¸åï¼Œä½åˆšåº¦çš„ç‰©ä½“åœ¨å—åŠ›æ—¶ä¼šè¡¨ç°å‡ºè¾ƒå¤§çš„å½¢å˜ï¼Œè¿™ä½¿å¾—ç‰©ä½“çœ‹èµ·æ¥æ›´è½¯æˆ–æ›´å®¹æ˜“å¼¯æ›²ã€‚ä¾‹å¦‚ï¼Œä¸€æ ¹æ©¡çš®ç­‹åœ¨æ‹‰ä¼¸æ—¶ä¼šæ˜æ˜¾å»¶é•¿ã€‚å› æ­¤ï¼ŒStiffness å¯¹äºæ•´ä¸ªæ¨¡æ‹Ÿçš„å½±å“ï¼Œå¯ä»¥ç›´æ¥ä½œç”¨åˆ°ä½ç§»<span class="math inline">\(\Delta\mathbf{p}\)</span>ä¸Šé¢ï¼Œå³<span class="math inline">\(\Delta\mathbf{p}&nbsp;\leftarrow&nbsp;k\Delta\mathbf{p}\)</span>ï¼Œä½†æ˜¯å› ä¸ºæˆ‘ä»¬æ•´ä¸ªConstraint Projection æ˜¯ä¸€ä¸ªè¿­ä»£è¿‡ç¨‹ï¼Œå› æ­¤æœ€ç»ˆçš„ Stiffnessçš„å½±å“ï¼Œå˜æˆäº†éçº¿æ€§çš„ã€‚å½“ç„¶åœ¨ PBD åŸæ–‡ä¸­ï¼Œæå‡ºæ¥ç”¨<span class="math inline">\((1-k_s)^{n_{iter}}:=1-&nbsp;k\)</span>æ±‚è§£å‡ºæ¥çš„<span class="math inline">\(k_s\)</span>ä½œä¸ºæ¯ä¸ªè¿­ä»£æ­¥éª¤ä¸­ Stiffnessäº§ç”Ÿçš„å½±å“ã€‚ä¸è¿‡ä¸ªäººå¯¹äºè¿™ä¸ªåšæ³•å¹¶ä¸æ˜¯ç‰¹åˆ«çš„èµåŒï¼š</p><ol type="1"><li><span class="math inline">\(n_{iter}\)</span>å¯¹äºä¸åŒçš„æ¨¡æ‹Ÿå’Œç‰©ä½“ï¼Œä¸ºäº†ä¿è¯æ¨¡æ‹Ÿçš„ç²¾åº¦ï¼Œæ˜¯ä¸€ä¸ªå¯å˜çš„é‡ã€‚</li><li><span class="math inline">\((1-k_s)^{n_{iter}}:=1-&nbsp;k\)</span>çš„ç”±æ¥ï¼Œæ˜¯ä½œè€…è®¤ä¸ºè¯¯å·®é¡¹ä¸º<span class="math inline">\((1-k)^{n_{iter}}\)</span>ï¼Œå¯¹äºè¯¥ç»“è®ºæŒä¿å®ˆè§‚ç‚¹ã€‚</li></ol></li></ul><p><u>ä¸ªäººè§‚ç‚¹ï¼šåŸå§‹çš„ PBDï¼Œå¹¶ä¸èƒ½å¾ˆå¥½åœ°å¤„ç† Stiffnesså¯¹äºæ•´ä¸ªæ¨¡æ‹Ÿçš„å½±å“ï¼Œå°¤å…¶æ˜¯â€œç‰©ç†â€æ„ä¹‰ä¸Šçš„æ­£ç¡®å¤„ç†è¿™ä¸ªè¿‡ç¨‹ã€‚</u></p><h3 id="collision-ç¢°æ’">Collision-ç¢°æ’</h3><p>å¯¹äºç¢°æ’æ¥è¯´ï¼Œä¸€èˆ¬éœ€è¦è€ƒè™‘çš„ç¢°æ’æƒ…å½¢ï¼Œå¯ä»¥ç®€å•åˆ†æˆä¸¤å¤§ç±»ï¼š</p><ol type="1"><li>å’Œé™æ€ç‰©ä½“çš„ç¢°æ’</li><li>å’ŒåŠ¨æ€ç‰©ä½“çš„ç¢°æ’</li></ol><h4 id="é™æ€ç¢°æ’">é™æ€ç¢°æ’</h4><p>é™æ€çº¦æŸç¢°æ’å³æ£€æµ‹è¢«æ¨¡æ‹Ÿå¯¹è±¡å’Œå‘¨å›´ç¯å¢ƒä¸­é™æ€éšœç¢ç‰©ä¹‹é—´çš„ç¢°æ’æƒ…å†µã€‚è¿™ä¸ªè¿‡ç¨‹å¯ä»¥ç®€å•æŠ½è±¡æˆå¦‚ä¸‹çš„æ£€æµ‹ï¼š</p><blockquote><p>å¦‚æœå’Œé™æ€éšœç¢å‘ç”Ÿç¢°æ’ï¼Œåˆ™åœ¨æ¨¡æ‹Ÿè¿‡ç¨‹<span class="math inline">\(\mathbf{x}_i&nbsp;\to&nbsp;\mathbf{p}_i\)</span>çš„æ›´æ–°ç©¿è¿‡ç©¿è¿‡æŸä¸ªæ³•å‘é‡ä¸º<span class="math inline">\(\mathbf{n}_s\)</span>è¡¨é¢ï¼Œå› æ­¤è¯¥çº¦æŸçš„æ•°å­¦è¡¨ç¤ºä¸º: <span class="math inline">\(C(\mathbf{p}_i)&nbsp;=&nbsp;(\mathbf{p}_i -\mathbf{p}_s)&nbsp;\cdot&nbsp;\mathbf{n}_s&nbsp;\ge&nbsp;0\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(\mathbf{p}_s\)</span>ä¸ºå°„çº¿<span class="math inline">\(\mathbf{x}_i&nbsp;\to&nbsp;\mathbf{p}_i\)</span>å’Œé¢çš„æŠ•å½±ã€‚</p></blockquote><h4 id="åŠ¨æ€ç¢°æ’">åŠ¨æ€ç¢°æ’</h4><p>æ‰€è°“åŠ¨æ€ç¢°æ’ï¼Œå³è¢«æ¨¡æ‹Ÿå¯¹è±¡ä¹‹é—´å‘ç”Ÿäº†ç¢°æ’ã€‚è¿™ä¸ªè¿‡ç¨‹å¯ä»¥ç”¨å¦‚ä¸‹çš„è¯­è¨€æè¿°:</p><blockquote><p>å‡è®¾ä¸€ä¸ªç‰©ä½“çš„é¡¶ç‚¹<span class="math inline">\(\mathbf{q}&nbsp;\to&nbsp;\mathbf{p}\)</span>ï¼Œä¸å¦å¤–ä¸€ä¸ªç‰©ä½“å‘ç”Ÿäº†ç¢°æ’ï¼Œåˆ™å¦å¤–ä¸€ä¸ªç‰©ä½“å­˜åœ¨ä¸€ä¸ªä¸‰è§’é¢å…¶é¡¶ç‚¹ä¸º<span class="math inline">\(\mathbf{p}_1,\mathbf{p}_2,\mathbf{p}_3\)</span>è¢«ç©¿è¿‡ï¼Œå…¶æ•°å­¦è¡¨ç¤ºä¸º:<span class="math inline">\(C(\mathbf{p},\mathbf{q},\mathbf{p}_1,\mathbf{p}_2,\mathbf{p}_3)&nbsp;:=&nbsp;\pm&nbsp;(\mathbf{p}-\mathbf{q})\cdot&nbsp;((\mathbf{p}_1-\mathbf{p}_2)\times(\mathbf{p}_1-\mathbf{p_3}))&nbsp;\ge&nbsp;0\)</span>ï¼Œè¿™è¾¹<span class="math inline">\(\pm&nbsp;\)</span>å–å†³äºæœ€ç»ˆæ³•å‘æœå‘è¡¨é¢çš„é‚£ä¸€ä¾§ã€‚</p></blockquote><h3 id="damping">Damping</h3><p>Dampingæ˜¯æŒ‡æŠµæŠ—è¿åŠ¨çš„åŠ›ï¼Œå®ƒæ¶ˆè€—æ‰ç³»ç»Ÿçš„èƒ½é‡ã€‚åœ¨ç‰©ç†æ¨¡æ‹Ÿä¸­ï¼Œé˜»å°¼ç”¨äºæ¨¡æ‹Ÿé‚£äº›å‡ç¼“è¿åŠ¨å’ŒæŒ¯åŠ¨çš„æ•ˆæœã€‚</p><ul><li><strong>é«˜é˜»å°¼</strong>ï¼šé«˜é˜»å°¼æ„å‘³ç€è¿åŠ¨èƒ½é‡ä¼šå¿«é€Ÿæ¶ˆè€—ï¼Œå¯¼è‡´ç‰©ä½“çš„è¿åŠ¨æˆ–æŒ¯åŠ¨å¾ˆå¿«å‡å¼±ç›´è‡³åœæ­¢ã€‚è¿™åœ¨æ¨¡æ‹Ÿå¦‚é˜²éœ‡å™¨æˆ–æ˜¯å…¶ä»–éœ€è¦å¿«é€Ÿå¹³æ¯æŒ¯åŠ¨çš„åœºæ™¯æ—¶éå¸¸æœ‰ç”¨ã€‚</li><li><strong>ä½é˜»å°¼</strong>ï¼šä½é˜»å°¼æ„å‘³ç€è¿åŠ¨èƒ½é‡æ¶ˆè€—å¾—æ…¢ï¼Œç‰©ä½“çš„è¿åŠ¨æˆ–æŒ¯åŠ¨ä¼šæŒç»­è¾ƒé•¿æ—¶é—´ã€‚è¿™å¯ä»¥ç”¨æ¥æ¨¡æ‹Ÿå¦‚å¼¹ç°§æŒ¯åŠ¨ç­‰æŒç»­è¾ƒé•¿æ—¶é—´çš„åŠ¨æ€æ•ˆæœã€‚</li></ul><p>åœ¨åŠ¨åŠ›å­¦æ¨¡æ‹Ÿä¸­ï¼Œé€‚å½“çš„é˜»å°¼å¯ä»¥é˜²æ­¢ç³»ç»Ÿè¿‡åº¦æŒ¯åŠ¨æˆ–â€œçˆ†ç‚¸â€ï¼Œå¸®åŠ©ä¿æŒæ¨¡æ‹Ÿçš„ç¨³å®šæ€§å’ŒçœŸå®æ€§ã€‚</p><p>æ¯”è¾ƒç®€å•æ¥æè¿° Damping çš„æ–¹å¼ï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„ç®—æ³•:</p><img src="/2024/06/01/pbd/damping.png" class="" title="This is an image"><p>å…¶ä¸­<span class="math inline">\(\tilde{\mathbf{r}}_i&nbsp;\in&nbsp;\mathbb{R}^{3\times&nbsp;3},&nbsp;\tilde{\mathbf{r}}_i\mathbf{v}&nbsp;=&nbsp;\mathbf{r}_i\times\mathbf{v}&nbsp;\)</span>ã€‚é‚£ä¹ˆå¯¹äºä¸¤ç§æé™çš„é«˜ä½é˜»å°¼æƒ…å†µ:</p><ol type="1"><li><span class="math inline">\(k_{damping}&nbsp;=&nbsp;0\)</span>æ•´ä¸ªè¿‡ç¨‹ä¿è¯å®Œå…¨æ²¡æœ‰é˜»å°¼ï¼Œæ²¡æœ‰é˜»å°¼è¿™éƒ¨åˆ†çš„æ›´æ–°</li><li><span class="math inline">\(k_{damping}=1\)</span>æ•´ä¸ªè¿‡ç¨‹ï¼Œæ‰€æœ‰é¡¶ç‚¹çš„é€Ÿåº¦ï¼Œéƒ½ä¸ºè´¨å¿ƒå¹³ç§»é€Ÿåº¦åŠ ä¸Šé¡¶ç‚¹çš„è½¬åŠ¨é€Ÿåº¦ï¼Œæ•´ä¸ªæ¨¡å¼è¡¨ç°ä¸ºåˆšä½“æ¨¡å¼ã€‚</li></ol><p>ä»ä¸Šé¢çš„ç®—æ³•ä¸­æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹å‡ºæ¥ï¼Œé˜»å°¼åªæ˜¯åœ¨é™åˆ¶å±€éƒ¨çš„è¿åŠ¨ï¼Œæ•´ä½“çš„è¿åŠ¨å¹¶ä¸å—å½±å“ã€‚</p><h1 id="xpbd">XPBD</h1><p>é€šè¿‡å¯¹ PBD çš„ä»‹ç»å—ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ PBDçš„æ‹¥æœ‰ç®€æ´çš„ç®—æ³•é€»è¾‘ï¼Œä½†æ˜¯æ­£å¦‚å‰é¢æˆ‘ä»¬æåˆ°çš„ï¼ŒPBDè‡³å°‘å­˜åœ¨å¦‚ä¸‹å‡ ä¸ªæ–¹é¢çš„é—®é¢˜ï¼š</p><ol type="1"><li>PBD æ€»ä½“ä¸Šæ˜¯ä¸€ä¸ª explicit çš„ç®—æ³•ï¼Œå› æ­¤éå¸¸ä¾èµ–<span class="math inline">\(\Deltat\)</span>æ˜¯ä¸€ä¸ªéå¸¸å°çš„å€¼ï¼Œå› æ­¤éœ€è¦è¾ƒé•¿çš„æ­¥æ•°</li><li>PBD å¯¹äº stiffnessçš„å¤„ç†ï¼Œç¼ºä¹è¾ƒå¼ºçš„ç‰©ç†ä¾æ®ï¼ŒåŒæ—¶è¿˜æ˜¯ä¾èµ–äºä¸ç¡®å®šçš„å‚æ•° <span class="math inline">\(n_{iter}\)</span></li></ol><p>XPBD çš„æå‡ºï¼Œåˆ™æ˜¯ä¸ºäº†ç¼“è§£ä¸Šé¢ä¸¤ä¸ªé—®é¢˜å¸¦æ¥çš„æ¨¡æ‹Ÿæ•ˆæœé€€åŒ–ã€‚</p><p>XPBDçš„æ€»ä½“æ€è·¯ï¼Œå›å½’äº†åŸå§‹çš„ç‰›é¡¿åŠ›å­¦ï¼Œå³å°†çº¦æŸé‡æ„æˆåŠ¿èƒ½ï¼Œå»æ±‚è§£ç»å…¸åŠ›å­¦çš„æ–¹ç¨‹ã€‚åœ¨PBDä¸­ï¼Œçº¦æŸåªæ˜¯ä½œä¸ºç­‰å¼æˆ–è€…ä¸ç­‰å¼çš„æ•°å­¦æ¡ä»¶å­˜åœ¨ï¼Œåœ¨æ¯æ¬¡æ¨¡æ‹Ÿè¿‡ç¨‹ä¸­ï¼Œé€šè¿‡æ•°å­¦æ›´æ–°å»è®©æ–°çš„ä½ç½®æ»¡è¶³å¯¹åº”çš„çº¦æŸæ¡ä»¶ï¼Œå½“ç„¶è¿™ä¸ªè¿‡ç¨‹ä¸­ä¿è¯äº†ä¸€äº›çš„ç‰©ç†è§„å¾‹ï¼Œä¾‹å¦‚åŠ¨é‡å®ˆæ’ï¼Œè§’åŠ¨é‡å®ˆæ’ç­‰ç­‰ã€‚ä½†æ˜¯æ­£å¦‚ä¸Šé¢æ‰€è¯´ï¼Œè¿˜æ˜¯å­˜åœ¨å¾ˆå¤šæ²¡æœ‰é‚£ä¹ˆç‰©ç†çš„åœ°æ–¹ã€‚</p><h2 id="ç»å…¸åŠ›å­¦ç¦»æ•£åŒ–">ç»å…¸åŠ›å­¦ç¦»æ•£åŒ–</h2><p>åœ¨è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œä½ç½®çš„ä¿¡æ¯ç”¨å¦‚ä¸‹çš„åºåˆ—è¡¨ç¤º<span class="math inline">\(\mathbf{x}^1,&nbsp;\cdots,&nbsp;\mathbf{x}^i,&nbsp;\mathbf{x}^{i+1},\cdots\)</span>ï¼Œé‚£ä¹ˆç‰›é¡¿ç¬¬äºŒå®šå¾‹å¯ä»¥å¾ˆç®€å•åœ°å†™æˆå¦‚ä¸‹å½¢å¼:</p><p><span class="math display">\[\mathbf{M}\frac{\mathbf{x}^{i+1}-2\mathbf{x}^i+\mathbf{x}^{i-1}}{\Deltat^2}=-\nabla U(\mathbf{x}^{i+1})\]</span></p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨æ–¹ç¨‹çš„å³ä¾§æˆ‘ä»¬ä½¿ç”¨äº†<span class="math inline">\(U(\mathbf{x}^{i+1})\)</span>è€Œé<span class="math inline">\(U(\mathbf{x}^i)\)</span>ï¼Œä»¥ä¿è¯æ•´ä¸ªè¿‡ç¨‹æ˜¯ä¸€ä¸ªimplicit çš„è¿‡ç¨‹ï¼Œæ¥ç¼“è§£å¯¹<span class="math inline">\(\Deltat\)</span>è¦æ±‚å¾ˆå°çš„ä¸¥è‹›æ¡ä»¶ã€‚å½“ç„¶è¿™è¾¹çš„åŠ¿èƒ½<span class="math inline">\(U(\mathbf{x})\)</span>æ˜¯ç”¨æ¥æè¿°çº¦æŸæ¡ä»¶çš„ï¼Œå¯ä»¥è¡¨ç¤ºæˆå¦‚ä¸‹å½¢å¼ï¼š</p><p><span class="math inline">\(U(\mathbf{x})&nbsp;=&nbsp;\frac{1}{2}C^T(\mathbf{x})&nbsp;\boldsymbol{\alpha}^{-1}&nbsp;C(\mathbf{x})\)</span>ï¼Œ</p><p>å…¶ä¸­æ˜¯ä¸€ä¸ªå¯¹è§’çŸ©é˜µï¼Œç”¨æ¥æè¿° stffiness å¼ºåº¦çš„å€’æ•°ï¼Œå³æ‰€è°“çš„ compliantmatrix. å› æ­¤ï¼Œ</p><p><span class="math display">\[\mathbf{M}(\mathbf{x}^{i+1}-2\mathbf{x}^i+\mathbf{x}^{i-1})=-\nablaC^T(\mathbf{x}^{i+1})\boldsymbol{\alpha}^{-1}C(\mathbf{x}^{i+1})\Deltat^2&nbsp;:=&nbsp;\nabla C^T(\mathbf{x}^{i+1})&nbsp;\boldsymbol{\lambda}^{i+1}\]</span></p><p>åœ¨ä¸Šé¢çš„æ–¹ç¨‹ä¸­<span class="math inline">\(\boldsymbol{\lambda}:=-\tilde{\boldsymbol{\alpha}}^{-1}C(\mathbf{x})\)</span>ï¼Œ<span class="math inline">\(\mathbf{x}^{i+1},&nbsp;\boldsymbol{\lambda}^{i+1}\)</span>ä¸ºéœ€è¦æ±‚è§£çš„å˜é‡ã€‚åŒæ—¶æˆ‘ä»¬çŸ¥é“<span class="math inline">\(\tilde{\mathbf{x}}^i:=2\mathbf{x}^{i}-\mathbf{x}^{i-1}=\mathbf{x}^i+\mathbf{v}^i\Deltat\)</span>ã€‚æœ€ç»ˆéœ€è¦æ±‚è§£çš„æ–¹ç¨‹ç»„ä¸ºå¦‚ä¸‹ï¼š</p><p><span class="math display">\[\mathbf{M}(\mathbf{x}-\tilde{\mathbf{x}})-\nablaC^T(\mathbf{x})\boldsymbol{\lambda}&nbsp;=&nbsp;0&nbsp;\\C(\mathbf{x})+\tilde{\boldsymbol{\alpha}}\boldsymbol{\lambda}&nbsp;=&nbsp;0\]</span></p><p>å…¶ä¸­<span class="math inline">\(\tilde{\boldsymbol{\alpha}}&nbsp;=&nbsp;\frac{\boldsymbol{\alpha}}{\Deltat^2}\)</span>ï¼ŒåŒæ—¶çœç•¥äº†ä¸Šæ ‡ã€‚å¯¹äºå¦‚ä½•æ±‚è§£ä¸Šé¢çš„æ–¹ç¨‹æœ‰å¾ˆå¤šçš„æ–¹æ³•ï¼Œè¿™è¾¹é‡‡ç”¨æœ€ç®€å•åŸå§‹çš„æ–¹æ³•ï¼Œå³ç‰›é¡¿è¿­ä»£æ³•<a href="https://zh.wikipedia.org/wiki/%E7%89%9B%E9%A1%BF%E6%B3%95%5D">[https://zh.wikipedia.org/wiki/%E7%89%9B%E9%A1%BF%E6%B3%95]</a>,å› æ­¤æˆ‘ä»¬ç›´æ¥çº¿æ€§åŒ–ä¸Šé¢çš„æ–¹ç¨‹ï¼š</p><p><span class="math display">\[\left[\begin{array}{cc}\mathbf{M}&nbsp;-&nbsp;(\nabla\nabla^T)C^T(\mathbf{x}^i)&nbsp;\boldsymbol{\lambda}^i&nbsp;&amp;&nbsp;-\nablaC^T(\mathbf{x}^i)&nbsp;\\&nbsp;\nablaC(\mathbf{x}^i)&nbsp;&amp;&nbsp;\tilde{\boldsymbol{\alpha}}\end{array}\right]\left[\begin{array}{c}\Delta\mathbf{x}\\\Delta\boldsymbol{\lambda}\end{array}\right]=-\left[\begin{array}{c}\mathbf{M}(\mathbf{x}^i-\tilde{\mathbf{x}})-\nablaC^T(\mathbf{x}^i)\boldsymbol{\lambda}^i&nbsp;\\&nbsp;C(\mathbf{x}^i)+\tilde{\boldsymbol{\alpha}}\boldsymbol{\lambda}^i&nbsp;\end{array}\right]\]</span></p><p>XPBD åœ¨å¤„ç†ä¸Šé¢çš„æ–¹ç¨‹ï¼Œä¸ºäº†æ›´åŠ å®¹æ˜“æ±‚è§£ï¼Œå¼•å…¥äº†å¦‚ä¸‹ä¸¤ä¸ªå‡è®¾ï¼š - <span class="math display">\[(\nabla\nabla^T)C^T(\mathbf{x}^i)&nbsp;\boldsymbol{\lambda}^i&nbsp;\approx&nbsp;0\]</span> - <span class="math display">\[\mathbf{M}(\mathbf{x}^i-\tilde{\mathbf{x}})-\nablaC^T(\mathbf{x}^i)\boldsymbol{\lambda}^i&nbsp;\approx&nbsp;0\]</span></p><p>å¯¹äºè¢«å¿½ç•¥çš„ä¸¤é¡¹ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“è¯¯å·®éƒ½åœ¨<span class="math inline">\(o(\Deltat^2)\)</span>è¿™ä¸ªé‡çº§ä¸Šã€‚åŒæ—¶æ•´ä¸ªæ–¹ç¨‹è¢«ç®€åŒ–æˆï¼š</p><p><span class="math display">\[\left[\begin{array}{cc}M&nbsp;&amp;&nbsp;-\nabla C^T(\mathbf{x}^i)&nbsp;\\&nbsp;\nablaC(\mathbf{x}^i)&nbsp;&amp;&nbsp;\tilde{\boldsymbol{\alpha}}\end{array}\right]\left[\begin{array}{c}\Delta\mathbf{x}\\\Delta\boldsymbol{\lambda}\end{array}\right]=-\left[\begin{array}{c}&nbsp;0&nbsp;\\&nbsp;C(\mathbf{x}^i)+\tilde{\boldsymbol{\alpha}}\boldsymbol{\lambda}^i&nbsp;\end{array}\right]\]</span></p><p>ä½¿ç”¨ Shur Complement[<a href="https://en.wikipedia.org/wiki/Schur_complement">https://en.wikipedia.org/wiki/Schur_complement</a>]æˆ‘ä»¬å¯ä»¥è½»æ¾è§£å‡ºä¸Šé¢çš„æ–¹ç¨‹:</p><p><span class="math display">\[\Delta\mathbf{x}=\mathbf{M}^{-1}\nabla&nbsp;C^T(\mathbf{x}^i)\Delta\boldsymbol{\lambda}\\\Delta\boldsymbol{\lambda}=(\nabla C(\mathbf{x}^i)\mathbf{M}^{-1}\nablaC^T(\mathbf{x}^i)+\tilde{\boldsymbol{\alpha}})^{-1}(C(\mathbf{x}^i+\tilde{\boldsymbol{\alpha}}\boldsymbol{\lambda}^i))\]</span></p><h2 id="connection-with-pbd">Connection with PBD</h2><p>ä¸Šé¢ç›´æ¥ç»™å‡ºæ¥äº†<span class="math inline">\(\Delta\mathbf{x},\Delta\boldsymbol{\lambda}\)</span>çš„è§£ææ›´æ–°å…¬å¼ã€‚ä½†æ˜¯å®é™…ä½¿ç”¨æ—¶ï¼Œç›´æ¥å¯¹çŸ©é˜µæ±‚é€†ä¸æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ“ä½œï¼Œæ›´å¤šçš„æ—¶å€™ä¼šé‡‡ç”¨ä¸€äº›å…¶ä»–çš„ç®—æ³•æ¥æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„ï¼Œä¾‹å¦‚ç»å…¸çš„Gauss-Seidel ç®—æ³•ã€‚</p><p>ç„¶è€Œï¼Œåœ¨åŸå§‹è®ºæ–‡é‡Œï¼Œä½œè€…ç›´æ¥å¾—å‡ºäº†å¦‚ä¸‹çš„ç»“è®º:</p><p><span class="math display">\[\Delta\boldsymbol{\lambda}_j=\frac{-C_j(\mathbf{x}^i)-\tilde{\boldsymbol{\alpha}}_j\boldsymbol{\lambda}_j^i}{\nablaC_j(\mathbf{x}^i)M^{-1}\nablaC_j^T(\mathbf{x}^i)+\tilde{\boldsymbol{\alpha}}_j}`\]</span></p><p><strong>è¿™è¾¹æ˜¯ååˆ†ä¸ç†è§£ä¸ºä»€ä¹ˆå¯ä»¥è®²ä¸åŒçº¦æŸä¹‹é—´çš„ç›¸äº’å½±å“ç»™ç‹¬ç«‹å¤„ç†ã€‚</strong></p><p>å½“ç„¶è¿™è¾¹å¦‚æœå¤„ç†å®Œæ¯•ä¹‹åï¼Œæˆ‘ä»¬ä¼šå‘ç°åœ¨<span class="math inline">\(\tilde{\boldsymbol{\alpha}}_j=0\)</span>çš„æƒ…å†µä¸‹é¢ï¼Œæ•´ä¸ªè¿‡ç¨‹é€€åŒ–åˆ°PBD çš„åœºæ™¯äº†ã€‚</p><h2 id="damping-1">Damping</h2><p>XPBD ä¸­ä½¿ç”¨äº† Rayleigh dissipation potentialæ¥å¤„ç†èƒ½é‡è€—æ•£çš„é—®é¢˜ï¼š</p><p><span class="math display">\[D(\mathbf{x}):=\frac{1}{2}\dot{C}^T(\mathbf{x})\boldsymbol{\beta}\dot{C}(\mathbf{x})=\frac{1}{2}\mathbf{v}^T\nablaC^T(\mathbf{x})\boldsymbol{\beta}\nabla C(\mathbf{x})\mathbf{v}\]</span></p><p><span class="math inline">\(\boldsymbol{\beta}\)</span>æ˜¯ä¸€ä¸ªå¯¹è§’çŸ©é˜µï¼Œç”¨æ¥è¡¡é‡å„ä¸ªçº¦æŸå¯¹äºèƒ½é‡è€—æ•£çš„è´¡çŒ®ç¨‹åº¦ã€‚è¿™ç§å½¢å¼çš„è€—æ•£æ˜¯èƒ½äº§ç”Ÿçš„åŠ›çš„ä½œç”¨:</p><p><span class="math display">\[\mathbf{F}=-\nabla_{\mathbf{v}}D&nbsp;=&nbsp;-\nablaC^T(\mathbf{x})\boldsymbol{\beta}\nabla C(\mathbf{x})\mathbf{v}\]</span></p><p>å¦‚æœè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ–°çš„<span class="math inline">\(\boldsymbol{\mu}:=-\tilde{\boldsymbol{\beta}}\nablaC(\mathbf{x})\mathbf{v}\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(\tilde{\boldsymbol{\beta}}=\boldsymbol{\beta}\Deltat^2\)</span>ï¼Œæˆ‘ä»¬å°±ä¼šå‘ç°æ•´ä¸ªè¿‡ç¨‹å’Œä¸Šé¢çš„æ¨å¯¼æ²¡æœ‰æœ¬è´¨çš„åŒºåˆ«ï¼Œåªéœ€è¦å¦‚ä¸‹çš„å˜åŒ–ï¼š</p><p><span class="math display">\[\mathbf{M}(\mathbf{x}-\tilde{\mathbf{x}})-\nablaC^T(\mathbf{x})(\boldsymbol{\lambda}+\boldsymbol{\mu})&nbsp;=&nbsp;0&nbsp;\\C(\mathbf{x})+\tilde{\boldsymbol{\alpha}}\tilde{\boldsymbol{\beta}}\nablaC(\mathbf{x})\mathbf{v}+\tilde{\boldsymbol{\alpha}}(\boldsymbol{\lambda}+\boldsymbol{\mu})&nbsp;=&nbsp;0\]</span></p><p>å¦‚æœæˆ‘ä»¬å°†<span class="math inline">\(\boldsymbol{\lambda}+\boldsymbol{\mu}&nbsp;\to&nbsp;\lambda;&nbsp;\mathbf{v}=\frac{\mathbf{x}-\mathbf{x}_{n}}{\Deltat}\)</span>è¿™æ ·çœ‹å¾…ï¼Œå»çº¿æ€§åŒ–ä¸Šé¢çš„æ–¹ç¨‹åŒæ—¶ä½¿ç”¨ç›¸åŒçš„è¿‘ä¼¼æ¡ä»¶ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°:</p><p><span class="math display">\[\left[\begin{array}{cc}\mathbf{M}&nbsp;&nbsp;&amp;&nbsp;-\nablaC^T(\mathbf{x}^i)&nbsp;\\&nbsp;\nablaC(\mathbf{x}^i)+\tilde{\boldsymbol{\alpha}}\tilde{\boldsymbol{\beta}}\nablaC(\mathbf{x})\frac{1}{\Deltat}&nbsp;&nbsp;&amp;&nbsp;\tilde{\boldsymbol{\alpha}}\end{array}\right]\left[\begin{array}{c}\Delta\mathbf{x}\\\Delta\boldsymbol{\lambda}\end{array}\right]=-\left[\begin{array}{c}0\\&nbsp;C(\mathbf{x}^i)+\tilde{\boldsymbol{\alpha}}\boldsymbol{\lambda}^i+\tilde{\boldsymbol{\alpha}}\tilde{\boldsymbol{\beta}}\nablaC(\mathbf{x}^i)\frac{\mathbf{x}^i-\mathbf{x}_n}{\Deltat}&nbsp;\end{array}\right]\]</span></p><p>å½“ç„¶è¿™ä¸ªæ—¶å€™ï¼Œå¦‚æœç»§ç»­ä½¿ç”¨ä½œè€…ä¸Šé¢å¥‡æ€ªçš„å¤„ç†æ–¹å¼ï¼Œå¯ä»¥å¾—åˆ°<span class="math inline">\(\Delta\boldsymbol{\lambda}\)</span>æ¯ä¸ªåˆ†é‡ä¸Šçš„æ›´ç»†æ³•åˆ™:</p><p><span class="math display">\[\Delta\boldsymbol{\lambda}_j=\frac{-C_j(\mathbf{x}^i)-\tilde{\boldsymbol{\alpha}}_j\boldsymbol{\lambda}_j^i-\boldsymbol{\gamma}_j\nablaC(\mathbf{x}^i)(\mathbf{x}^i-\mathbf{x}_n)}{(1+\boldsymbol{\gamma}_j)\nablaC_j(\mathbf{x}^i)M^{-1}\nablaC_j^T(\mathbf{x}^i)+\tilde{\boldsymbol{\alpha}}_j}\]</span></p><p>è¿™è¾¹<span class="math inline">\(\boldsymbol{\gamma}_j=\frac{\tilde{\boldsymbol{\alpha}_j}\tilde{\boldsymbol{\beta}_j}}{\Deltat}\)</span></p><h1 id="constraints">Constraints</h1><p>è¿™ä¸ªç« èŠ‚ï¼Œæˆ‘ä»¬å°†ä»‹ç»å‡ ç§å¸¸è§çš„çº¦æŸæ¡ä»¶ï¼Œä»¥åŠå…¶å¸¸è§çš„æ›´æ–°æ¡ä»¶ï¼Œå³ä¸»è¦ç»™å‡ºçº¦æŸæ¡ä»¶å…³äºåæ ‡çš„æ¢¯åº¦è¡¨è¾¾å¼ã€‚</p><h2 id="length-constraintstretch-constraint">Length Constraint(StretchConstraint)</h2><p>é•¿åº¦çš„çº¦æŸï¼Œç”¨æ¥ä¿è¯ç›¸é‚»ä¸¤ç‚¹ä¹‹é—´çš„é•¿åº¦å’Œåˆå§‹é•¿åº¦æ¥è¿‘ï¼Œå› æ­¤å¯ä»¥æè¿°æˆå¦‚ä¸‹çš„æ–¹å¼:</p><p><span class="math display">\[C(\mathbf{x}_i,\mathbf{x}_j):=\|\mathbf{x}_i-\mathbf{x}_j\|-l_{ij}&nbsp;=&nbsp;0\]</span></p><blockquote><p><span class="math display">\[\nabla_{\mathbf{x}_i}C(\mathbf{x}_i,\mathbf{x}_j)=\frac{\mathbf{x}_i-\mathbf{x}_j}{\|\mathbf{x}_i-\mathbf{x}_j\|}\]</span></p></blockquote><h2 id="bend-constraint">Bend Constraint</h2><p>Bend Constaint ç”¨æ¥ä¸¤ä¸ªç›¸é‚»ä¸‰è§’å½¢ä¹‹é—´çš„å¤¹è§’æ¥è¿‘åˆå§‹çš„å¤¹è§’ã€‚</p><p>å‡è®¾ä¸¤ä¸ªä¸‰è§’å½¢å…¬å…±çš„è¾¹ä¸º<span class="math inline">\(\mathbf{x}_1\to\mathbf{x}_2\)</span>ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªä¸‰è§’å½¢å¦å¤–ä¸€ä¸ªé¡¶ç‚¹ä¸º<span class="math inline">\(\mathbf{x}_3\)</span>ï¼Œç¬¬äºŒä¸ªä¸‰è§’å½¢çš„å¦å¤–ä¸€ä¸ªé¡¶ç‚¹ä¸º<span class="math inline">\(\mathbf{x}_4\)</span>,é‚£ä¹ˆå¯ä»¥å®šä¹‰æˆ‘ä»¬çš„çº¦æŸæ¡ä»¶ä¸ºä¸‹é¢çš„å½¢å¼:</p><p><span class="math display">\[C(\mathbf{x}_1,\mathbf{x}_2,\mathbf{x}_3,\mathbf{x}_4):=\arccos\left(\frac{\mathbf{p}_2\times\mathbf{p}_3}{\|\mathbf{p}_2\times\mathbf{p}_3\|}\cdot\frac{\mathbf{p}_2\times\mathbf{p}_4}{\|\mathbf{p}_2\times\mathbf{p}_4\|}\right)-\theta:=\arccosI&nbsp;-&nbsp;\theta\]</span></p><p>è¿™è¾¹<span class="math inline">\(\mathbf{p}_2:=\mathbf{x}_2-\mathbf{x}_1,\mathbf{p}_3:=\mathbf{x}_3-\mathbf{x}_1,\mathbf{p}_4:=\mathbf{x}_4-\mathbf{x}_1\)</span>.</p><p>å¯¹äºè¿™ä¸ªå¤æ‚è¡¨è¾¾å¼å­ï¼Œæˆ‘ä»¬è¦æƒ³è·å¾—å…¶å¯¹åº”çš„æ¢¯åº¦ï¼Œæ ¸å¿ƒåˆ™éœ€è¦è®¡ç®—ä¸‹é¢çš„å­è¡¨è¾¾å¼çš„æ¢¯åº¦ï¼Œå…¶ä»–çš„åˆ™ä½¿ç”¨é“¾å¼æ³•åˆ™å°±å¯ä»¥ï¼Œ(è¿™è¾¹ä¸ºäº†æ–¹ä¾¿çœå»äº†ç²—ä½“)ã€‚</p><p><span class="math display">\[\nabla_x&nbsp;\frac{(x\times y)\cdot z}{\|x\timesy\|}=\nabla_x&nbsp;\frac{(y\times z)\cdot x}{\|x\timesy\|}=\left(x\cdot(y\timesz)\right)\left(\nabla_x\frac{1}{\|x\times&nbsp;y\|}\right)+\frac{y\timesz}{\|x\times&nbsp;y\|}\]</span></p><p><span class="math inline">\(\nabla_x\|x\timesy\|=\frac{\nabla_x\left((x\times y)\cdot(x\times y)\right)}{2\|x\timesy\|}=\frac{y\times(x\times&nbsp;y)}{\|x\times y\|}:=y\times n\)</span>è¿™è¾¹æˆ‘ä»¬å®šä¹‰<span class="math inline">\(n:=\frac{x\times y}{\|x\timesy\|}\)</span>ï¼Œé‚£ä¹ˆ</p><p><span class="math display">\[\nabla_x&nbsp;\frac{(x\times y)\cdot z}{\|x\times y\|}=\frac{(n\cdotz)(n\times y)+y\times z}{\|x\times y\|}\]</span></p><p>é‚£ä¹ˆæˆ‘ä»¬å®šä¹‰:</p><p><span class="math display">\[\mathbf{n}_1:=\frac{\mathbf{p}_2\times\mathbf{p}_3}{\|\mathbf{p}_2\times\mathbf{p}_3\|};\mathbf{n}_2:=\frac{\mathbf{p}_2\times\mathbf{p}_4}{\|\mathbf{p}_2\times\mathbf{p}_4\|}\]</span></p><blockquote><ol type="1"><li><span class="math display">\[\nablaC&nbsp;=&nbsp;-\frac{1}{\sqrt{1-I^2}}\nabla I\]</span></li><li><span class="math display">\[\nabla_{\mathbf{x}_3}I=-\frac{I\mathbf{n}_1\times\mathbf{p}_2+\mathbf{p}_2\times\mathbf{n}_2}{\|\mathbf{p}_2\times\mathbf{p}_3\|}\]</span></li><li><span class="math display">\[\nabla_{\mathbf{x}_4}I=-\frac{I\mathbf{n}_2\times\mathbf{p}_2+\mathbf{p}_2\times\mathbf{n}_1}{\|\mathbf{p}_2\times\mathbf{p}_4\|}\]</span></li><li><span class="math display">\[\nabla_{\mathbf{x}_2}I=\frac{I\mathbf{n}_1\times\mathbf{p}_3+\mathbf{p}_3\times\mathbf{n}_2}{\|\mathbf{p}_2\times\mathbf{p}_3\|}+\frac{I\mathbf{n}_2\times\mathbf{p}_4+\mathbf{p}_4\times\mathbf{n}_1}{\|\mathbf{p}_2\times\mathbf{p}_4\|}\]</span></li><li><span class="math display">\[\nabla_{\mathbf{x}_1}I=-\nabla_{\mathbf{x}_2}I-\nabla_{\mathbf{x}_3}I-\nabla_{\mathbf{x}_4}I\]</span></li></ol></blockquote><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> ç‰©ç†æ¨¡æ‹Ÿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç‰©ç†æ¨¡æ‹Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ—¶é—´åºåˆ—é˜…è¯»ç¬”è®°</title>
      <link href="/2023/10/28/brockwell/"/>
      <url>/2023/10/28/brockwell/</url>
      
        <content type="html"><![CDATA[<h1 id="æ—¶é—´åºåˆ—é˜…è¯»ç¬”è®°">æ—¶é—´åºåˆ—é˜…è¯»ç¬”è®°</h1><h2 id="å¼•è¨€">å¼•è¨€</h2><h3 id="é€šç”¨çš„æ—¶é—´åºåˆ—å»ºæ¨¡æ–¹æ³•">é€šç”¨çš„æ—¶é—´åºåˆ—å»ºæ¨¡æ–¹æ³•</h3><p>æ“ä½œæ­¥éª¤ï¼š</p><ul><li>ç”»å‡ºä¸»è¦featureçš„å›¾ï¼Œå¹¶æŸ¥çœ‹<ul><li>æ˜¯å¦æœ‰ä¸€ä¸ªè¶‹åŠ¿(Trend)</li><li>æ˜¯å¦æœ‰å‘¨æœŸçš„æˆåˆ†(Period)</li><li>æ˜¯å¦æœ‰çªå˜(Sharp change)</li><li>æ˜¯å¦æœ‰å¼‚å¸¸å€¼(Outlier)</li></ul></li><li>ç§»é™¤è¶‹åŠ¿å’Œå‘¨æœŸé¡¹ï¼Œè·å¾—ä¸€ä¸ªæ¥è¿‘é™æ€çš„æ—¶é—´åºåˆ—</li><li>å»ºæ¨¡æ‹Ÿåˆå‰©ä½™çš„æ®‹å·®é¡¹</li><li>é¢„æµ‹æ®‹å·®ï¼Œå¹¶åŠ ä¸Šè¶‹åŠ¿å’Œå‘¨æœŸé¡¹ï¼Œè·å¾—æœ€ç»ˆçš„é¢„æµ‹å€¼</li></ul><h3 id="é™æ€æ¨¡å‹">é™æ€æ¨¡å‹</h3><blockquote><p><strong>Def</strong>: Weakly Stationary A time series <span class="math inline">\({X_t}\)</span> is called weakly stationary, if 1.<span class="math inline">\(\mu_X(t)\)</span> is independent of time<span class="math inline">\(t\)</span> 2. <span class="math inline">\(\gamma_X(t+h,t)\)</span> is independent of time<span class="math inline">\(t\)</span> for each <span class="math inline">\(h\)</span>, where <span class="math inline">\(\gamma_X(r, s) = Cov(X_r, X_s)\)</span></p></blockquote><p>å¯¹äºä¸€ä¸ªé™æ€åºåˆ—æ¥è¯´ï¼Œ<span class="math inline">\(\gamma_X(h):=\gamma_X(0,h)=\gamma_X(t,t+h)\)</span>,æ­¤æ—¶ï¼Œæˆ‘ä»¬ç§°<span class="math inline">\(\gamma_X(h)\)</span>ä¸ºè‡ªåæ–¹å·®(auto covariance function).</p><blockquote><p><strong>Def</strong>: AutoCorrelation Function(è‡ªç›¸å…³å‡½æ•°) <span class="math inline">\(\rho_X(h) =\frac{\gamma_X(h)}{\gamma_X(0)}\)</span></p></blockquote><h3 id="ä¼°è®¡è¶‹åŠ¿å’Œå‘¨æœŸ">ä¼°è®¡è¶‹åŠ¿å’Œå‘¨æœŸ</h3><p>å‡è®¾ä¸€ä¸ªæ—¶é—´åºåˆ—ç”±ä¸‰ä¸ªéƒ¨åˆ†æ„æˆï¼š <span class="math display">\[X_t = m_t + s_t + Y_t\]</span> å…¶ä¸­<span class="math inline">\(m_t,s_t\)</span>åˆ†åˆ«è¡¨ç¤ºç¡®å®šæ€§çš„è¶‹åŠ¿é¡¹ï¼Œå‘¨æœŸé¡¹ã€‚<span class="math inline">\(Y_t\)</span>å‰©ä½™çš„ä¸€ä¸ªå¸¦æœ‰éšæœºæ€§çš„é™æ€åºåˆ—ã€‚è¿™èŠ‚æˆ‘ä»¬ç®€å•ä»‹ç»ä¸€ä¸‹ä¸€äº›ç®€å•çš„æ–¹æ³•ä¼°è®¡<span class="math inline">\(m_t, s_t\)</span></p><h4 id="åªæœ‰è¶‹åŠ¿é¡¹çš„æ—¶å€™">åªæœ‰è¶‹åŠ¿é¡¹çš„æ—¶å€™</h4><p>å¦‚æœæˆ‘ä»¬çš„æ¨¡å‹åªæœ‰è¶‹åŠ¿é¡¹ï¼Œå¦‚ä¸‹ <span class="math display">\[X_t = m_t + Y_t\]</span> é‚£ä¹ˆå¸¸è§çš„ç”¨æ¥ä¼°è®¡è¶‹åŠ¿é¡¹çš„æ–¹æ³•ï¼š</p><ul><li>ç§»åŠ¨å¹³å‡å¹³æ»‘<ul><li>ç­‰æƒå¹³å‡</li><li>æŒ‡æ•°å¹³å‡</li></ul></li><li>è¿‡æ»¤é«˜é¢‘æˆåˆ†<ul><li>å‚…ç«‹å¶å˜æ¢</li><li>å…¶ä»–çš„è°±åˆ†ææ–¹æ³•</li></ul></li><li>å‚æ•°åŒ–æ¨¡å‹å¹¶æ‹Ÿåˆ<ul><li>å¤šé¡¹å¼æ‹Ÿåˆ</li><li>æœºå™¨å­¦ä¹ ï¼Œæ·±åº¦å­¦ä¹ æ–¹æ³•</li></ul></li></ul><p>å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åå…¶é“è€Œè¡Œï¼Œé™¤äº†æˆ‘ä»¬é€šè¿‡ä¸Šè¿°çš„æ–¹æ³•ï¼Œå»è·å–ä¸€ä¸ªé¢„æµ‹è¶‹åŠ¿çš„æ¨¡å‹ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è¯•å›¾æ¶ˆé™¤è¶‹åŠ¿ï¼Œç›´æ¥è·å¾—é™æ€åºåˆ—<span class="math inline">\(Y_t\)</span>ã€‚ æ¶ˆé™¤è¶‹åŠ¿æœ€å¸¸è§çš„æ–¹æ³•åˆ™æ˜¯ï¼š -å·®åˆ†</p><blockquote><p><strong>Def</strong>: Lag operator <span class="math display">\[ BX_t= X_{t-1} \]</span></p><p><strong>Def</strong>: Difference operator <span class="math display">\[\nabla = 1 - B\]</span></p></blockquote><p>å› æ­¤å¦‚æœ<span class="math inline">\(m_t\)</span>æ˜¯ä¸€ä¸ª<span class="math inline">\(k\)</span>é˜¶çš„å¤šé¡¹å¼ï¼Œé‚£ä¹ˆ<span class="math inline">\(\nabla^k X_t\)</span> åˆ™è¶³ä»¥æ¶ˆé™¤è¶‹åŠ¿ã€‚</p><h4 id="åŒæ—¶æœ‰è¶‹åŠ¿é¡¹å’Œå‘¨æœŸé¡¹">åŒæ—¶æœ‰è¶‹åŠ¿é¡¹å’Œå‘¨æœŸé¡¹</h4><p>ä¸Šé¢ä»‹ç»å®Œäº†ï¼Œåœ¨åªæœ‰è¶‹åŠ¿é¡¹çš„æ˜¯ï¼Œæˆ‘ä»¬å¦‚ä½•å»å¤„ç†ä¸€ä¸ªæ—¶é—´åºåˆ—ï¼Œè¿™è¾¹æˆ‘ä»¬è€ƒè™‘çš„æ¨¡å‹æ›´åŠ å®Œæ•´ä¸€ç‚¹ï¼Œå³è¶‹åŠ¿é¡¹å’Œå‘¨æœŸé¡¹åŒæ—¶å­˜åœ¨ã€‚å‡è®¾å‘¨æœŸä¸º<span class="math inline">\(d\)</span>,ä¸€èˆ¬æˆ‘ä»¬å¯ä»¥éµä»ä¸‹é¢çš„æ­¥éª¤ï¼š</p><ul><li>ä½¿ç”¨å½“å‰æ—¶é—´ç‚¹é™„è¿‘<span class="math inline">\(d\)</span>ä¸ªæ—¶é—´çš„æ•°æ®åšç§»åŠ¨å¹³å‡ï¼Œå¤§æ¦‚ä¼°è®¡å‡ºä¸€ä¸ª<span class="math inline">\(\hat{m}_t\)</span></li><li>å¯¹äºå‘¨æœŸå†…çš„ä»»æ„ä¸€ä¸ªæ—¶é—´ç‚¹<span class="math inline">\(k, 1 \le k \led\)</span>, è®¡ç®—<span class="math inline">\(\{x_{k+jd}-\hat{m}_{k+jd}\},1 \le k+jd \le n\)</span>çš„å¹³å‡ï¼Œè®¡ä½œ<span class="math inline">\(w_t\)</span>,ä¸ºäº†ä¿è¯å‘¨æœŸéœ‡è¡æ€»ä½“å›´ç»•0ç‚¹éœ‡è¡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<span class="math inline">\(\hat{s}_t = w_t - \frac{1}{d}\sum_{k=1}^dw_k\)</span> ä½œä¸ºä¸€ä¸ªä¸é”™çš„å‘¨æœŸé¡¹ä¼°è®¡</li><li>ç°åœ¨æˆ‘ä»¬è·å¾—äº†<strong>å»å‘¨æœŸ</strong>çš„æ•°æ®<span class="math inline">\(d_t = x_t -\hat{s}_t\)</span>,é—®é¢˜åˆ™å˜æˆäº†ï¼Œä¸Šé¢åªæœ‰è¶‹åŠ¿é¡¹çš„é—®é¢˜äº†ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä¸Šä¸€å°æ®µåˆ—ä¸¾çš„æ–¹æ³•è§£å†³è¿™ä¸ªé—®é¢˜äº†ã€‚</li></ul><h2 id="stationary-process">Stationary Process</h2><blockquote><p><strong>Def</strong>: Nonnegative definite A real-valued function<span class="math inline">\(\kappa\)</span> defined on integers isnon-negative definite, if <span class="math display">\[\sum_{i,j}a_i \kappa(i-j) a_j \ge 0\]</span> for all positive integer <span class="math inline">\(i,j\)</span> and vector <span class="math inline">\(a=(a_1, a_2, \cdots)^T\)</span></p></blockquote><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> äººå·¥æ™ºèƒ½ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°æ®åˆ†æï¼Œæœºå™¨å­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Portfolio Optimization</title>
      <link href="/2023/10/28/port_opt/"/>
      <url>/2023/10/28/port_opt/</url>
      
        <content type="html"><![CDATA[<h1 id="portfolio-optimization">Portfolio Optimization</h1><h2 id="ç®€ä»‹">ç®€ä»‹</h2><p>æŠ•èµ„ç»„åˆçš„ä¼˜åŒ–æ˜¯é‡åŒ–æŠ•èµ„ä¸­éå¸¸é‡è¦çš„ä¸€ä¸ªç¯èŠ‚ã€‚å‡è®¾æˆ‘ä»¬æœ‰<span class="math inline">\(N\)</span>æ”¯èµ„äº§ï¼Œæ¯ä¸ªèµ„äº§æ”¶é›†äº†<span class="math inline">\(T\)</span>æ—¶é—´çš„æ•°æ®ï¼Œç”¨ <span class="math inline">\(X \in \mathrm{R}^{N \times T}\)</span>è¡¨ç¤ºæ•´ä¸ªé£é™©æ”¶ç›Šæ ·æœ¬ã€‚åœ¨é‡åŒ–æŠ•èµ„ä¸­æœ€æ ¸å¿ƒçš„ä¸¤ä¸ªé—®é¢˜å°±æ˜¯ï¼š</p><ul><li>ç»™å®šå†å²è½¨è¿¹çš„æ¡ä»¶ä¸‹ï¼Œé¢„æµ‹æœªæ¥æ—¶é—´çš„æ”¶ç›Š <span class="math inline">\(\mathbb{E}[R_{t+1}|\mathcal{F}_{t}]\)</span>ã€‚</li><li>ç»™å®šå†å²è½¨è¿¹çš„æ¡ä»¶ä¸‹ï¼Œé¢„æµ‹æœªæ¥æ—¶é—´çš„å„ä¸ªèµ„äº§ä¹‹é—´çš„correlation,ä¾‹å¦‚:<span class="math inline">\(\Sigma_{t+1} | \mathcal{F}_{t}\)</span>ã€‚</li></ul><p>å¦‚æœèƒ½å¤Ÿå¾ˆå¥½å¾—å®Œæˆç¬¬ä¸€ä¸ªä»»åŠ¡ï¼Œåˆ™å°±å¯ä»¥è¿½æ±‚åˆ°äººä»¬æ¢¦å¯ä»¥æ±‚çš„è¶…é¢æ”¶ç›Šï¼Œäºæ­¤æˆ‘ä»¬ä¹Ÿå¯ä»¥æƒ³è±¡ç¬¬ä¸€ä¸ªé—®é¢˜çš„éš¾åº¦æ˜¯å¦‚ä½•åœ°é«˜ï¼Œä¹Ÿè¶…è¿‡äº†æœ¬ç¯‡Blogæ‰€æƒ³è¦è®¨è®ºçš„èŒƒç•´ã€‚</p><p>æˆ‘ä»¬è¿™è¾¹ä¸»è¦ä¼šå°†è®¨è®ºçš„å†…å®¹å±€é™åœ¨ç¬¬äºŒä¸ªé—®é¢˜ä¸Šï¼Œå‡è®¾å­˜åœ¨ä¸€ä¸ªä¸Šå¸å·²ç»å¸®åŠ©æˆ‘ä»¬è§£å†³äº†ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œå³æˆ‘ä»¬å·²ç»æ‹¥æœ‰äº†ä¸€ä¸ªç›¸å¯¹ä¸é”™çš„å¯¹æœªæ¥æ”¶ç›Šä¼°è®¡çš„ç®—æ³•ï¼Œä½¿ç”¨è®°å·<span class="math inline">\(\hat{\mu}_{t+1}\)</span> ä»£è¡¨æˆ‘ä»¬å¯¹äº $ [R_{t+1}|_{t}]$ çš„ä¼°è®¡ã€‚é‚£ä¹ˆåœ¨æŠ•èµ„ç»„åˆè¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬å¾€å¾€å…³æ³¨çš„æ˜¯ä¸‹é¢è¿™ä¸ªä¼˜åŒ–é—®é¢˜ï¼Œ<span class="math display">\[\max_{w} \hat{\mu}_{t+1}^T w, \\f_i(\hat{\mu}_{t+1}, \hat{\Sigma}_{t+1}, w) \le 0, i = 1,2,\cdots, k \\g_j(\hat{\mu}_{t+1}, \hat{\Sigma}_{t+1}, w) = 0, j = 1,2,\cdots, l\]</span></p><p>ç”¨é€šä¿—çš„è¯­è¨€æè¿°ï¼Œå°±æ˜¯åœ¨é£é™©å¯æ§å¹¶ä¸”ç¬¦åˆæ³•è§„(ä¾‹å¦‚åªå…è®¸åšå¤š)çš„æ¡ä»¶ä¸‹ï¼Œå»æœ€å¤§åŒ–é¢„æœŸæ”¶ç›Šã€‚æƒ³è¦æ§åˆ¶çš„é£é™©å’Œå…¶ä»–ç›¸å…³çš„çº¦æŸéƒ½æ˜¯ç”¨<span class="math inline">\(f,g\)</span>ä¸¤ç§å½¢å¼æè¿°ã€‚é‚£ä¹ˆä¸ºäº†å¾ˆå¥½åœ°è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¾ˆæ˜æ˜¾æˆ‘ä»¬æœ‰ä¸¤ä¸ªé—®é¢˜éœ€è¦è§£å†³ï¼š</p><ul><li>å‡†ç¡®ä¼°è®¡ <span class="math inline">\(\hat{\Sigma}_{t+1}\)</span>ï¼Œå³ä¸Šé¢çš„ç¬¬äºŒä¸ªä»»åŠ¡</li><li>å¼€å‘ä¸€ä¸ªé«˜æ•ˆçš„ä¼˜åŒ–ç®—æ³•ï¼Œè§£å†³ä¸Šé¢è¿™ä¸ªä¼˜åŒ–é—®é¢˜ã€‚</li></ul><h2 id="correlationä¼°è®¡">Correlationä¼°è®¡</h2><p>åœ¨è¿™ä¸ªéƒ¨åˆ†æˆ‘ä»¬å°†ä¼šä»‹ç»ä¸€ä¸‹ï¼Œå…³äºCorrelationä¼°è®¡çš„ä¸€äº›åŸºæœ¬çš„ç®—æ³•ã€‚é’ˆå¯¹è¿™ä¸ªé—®é¢˜çš„å»ºæ¨¡å‡è®¾ï¼Œä¹Ÿæ˜¯è¢«åˆ†æˆäº†ä¸¤éƒ¨åˆ†ã€‚ç¬¬ä¸€ï¼Œå‡è®¾Correlationæ˜¯é™æ€çš„ï¼›ç¬¬äºŒï¼Œå‡è®¾Correlationæ˜¯åŠ¨æ€ã€‚ç¬¬ä¸€ç§æƒ…å†µä¸‹é¢ï¼Œæˆ‘ä»¬æ‹¥æœ‰ä¸€äº›æ¯”è¾ƒè‰¯å¥½çš„æ•°å­¦ä¿éšœï¼Œä½†æ˜¯å’Œç°å®èƒŒç¦»å¾—ç¨å¾®è¿œä¸€ç‚¹ã€‚ç¬¬äºŒç§æƒ…å†µï¼Œåˆ™æ˜¯å’Œç°å®æ›´è¿‘ï¼Œä½†æ˜¯è§£å†³è¯¥é—®é¢˜çš„éš¾åº¦ä¹Ÿä¼šé«˜ä¸Šå¾ˆå¤šã€‚</p><h3 id="é™æ€correlationä¼°è®¡">é™æ€Correlationä¼°è®¡</h3><p>å¯¹äºé™æ€çš„Correlationçš„ä¼°è®¡ï¼Œé¦–å…ˆæˆ‘ä»¬ä¼šæƒ³åˆ°ä¸€ä¸ªæœ€åŸºæœ¬çš„æ–¹æ³•ï¼Œå°±æ˜¯ç”¨æ ·æœ¬çš„åæ–¹å·®çŸ©é˜µä¼°è®¡å…¨ä½“çš„åæ–¹å·®çŸ©é˜µã€‚æ‰€è°“çš„æ ·æœ¬åæ–¹å·®çŸ©é˜µï¼Œå¯ä»¥å†™æˆä¸‹é¢çš„å½¢å¼:<span class="math display">\[S = \frac{1}{T}(XX^T - \frac{1}{T}X\mathbf{1}\mathbf{1}^TX) =\frac{1}{T}X(\mathbf{I} - \frac{1}{T}\mathbf{1}\mathbf{1}^T)X^T\]</span> ä»è¿™ä¸ªè¡¨è¾¾å¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥çœ‹å‡ºæ¥ä¸€ä¸ªè¾ƒä¸ºä¸¥é‡çš„é—®é¢˜, <span class="math inline">\(S\)</span>çš„rankä¸ä¼šé«˜äº<span class="math inline">\(\mathbf{I} -\frac{1}{T}\mathbf{1}\mathbf{1}^T\)</span>, å³ä¸ä¼šé«˜äº<span class="math inline">\(T\)</span>ã€‚é‚£ä¹ˆå½“ä½ æ‰€é‡‡é›†åˆ°çš„æ•°æ®æ—¶é—´çª—å£<span class="math inline">\(T\)</span>å’Œ<span class="math inline">\(N\)</span>åœ¨åŒä¸€ä¸ªé‡çº§ï¼Œç”šè‡³æ›´ä½çš„æ—¶å€™ï¼Œè¯¥ä¼°è®¡çŸ©é˜µå¾ˆæœ‰å¯èƒ½æ˜¯singluarçš„ï¼Œè¿™ä¼šæå¤§çš„å½±å“åˆ°åç»­ä¼˜åŒ–é—®é¢˜çš„æ±‚è§£ã€‚è¯¥é—®é¢˜åœ¨ç°å®æŠ•èµ„ä¸­è¿˜æ˜¯æ¯”è¾ƒæ˜æ˜¾çš„ï¼Œå°¤å…¶æ˜¯å½“ä½ çš„æŠ•èµ„é¢‘ç‡è¾ƒä½æ—¶ï¼Œè¯¥é—®é¢˜ä¼šè¶Šå‘æ˜¾è‘—ã€‚é‚£ä¹ˆä¸»æµçš„è§£å†³ä¸Šé¢è¿™ä¸ªé—®é¢˜çš„æ–¹æ³•ä¹Ÿåˆ†æˆä¸¤å¤§ä¸»æµçš„æµæ´¾ï¼Œå½“ç„¶è¿™ä¸¤ä¸ªæµæ´¾ä¹Ÿä¸å®Œå…¨ç‹¬ç«‹ï¼Œä¹Ÿæ˜¯å¯ä»¥æ··åˆä½¿ç”¨ã€‚</p><ul><li>Shrinkageæ–¹æ³•</li><li>Multi-factorä¼°è®¡æ–¹æ³•</li></ul><h4 id="shrinkage">Shrinkage</h4><p>Shrinkageçš„æƒ³æ³•éå¸¸çš„ç®€å•ï¼Œå°±æ˜¯æ—¢ç„¶<span class="math inline">\(S\)</span>æœ¬èº«ä½œä¸º<span class="math inline">\(\Sigma\)</span>çš„ä¼°è®¡åœ¨ä¸Šè¿° <span class="math inline">\(N,T\)</span>æ¯”è¾ƒæ¥è¿‘çš„æ—¶å€™æœ‰ä¸€äº›é—®é¢˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å†é¢å¤–å¦å¤–ä¸€ä¸ªä¼°è®¡ <span class="math inline">\(F\)</span>, ä½¿ç”¨è¿™ä¸¤ä¸ªä¼°è®¡çš„ç»„åˆï¼Œä¾‹å¦‚<span class="math inline">\((1-\delta)S + \delta F\)</span>, ä½œä¸º<span class="math inline">\(\Sigma\)</span>çš„ä¼°è®¡å‘¢ï¼Œè¿™è¾¹ <span class="math inline">\(\delta\)</span>æ˜¯ä¸€ä¸ªæè¿°shrinkageç¨‹åº¦çš„å‚æ•°ã€‚åœ¨å…·ä½“è®¨è®ºè¿™ä¸ª<span class="math inline">\(F\)</span>ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥æ€è€ƒä¸€ä¸‹å¼•å…¥è¿™ä¸ª<span class="math inline">\(F\)</span>, æˆ‘ä»¬éœ€è¦è§£å†³ä»€ä¹ˆï¼Œå³æœŸæœ›<span class="math inline">\(F\)</span>èƒ½å¤Ÿæ‹¥æœ‰å“ªäº›æ€§è´¨ã€‚ä¸‹é¢æ˜¯æˆ‘è‡ªå·±ä¸ªäººçš„ä¸€äº›æƒ³æ³•ï¼š</p><p><strong><em>é¦–å…ˆï¼Œ<span class="math inline">\(S\)</span>çŸ©é˜µå¯¹äº<span class="math inline">\(\Sigma\)</span>çš„ä¼°è®¡æ— åçš„ï¼Œä½†æ˜¯å¦‚æœæ ·æœ¬é‡ä¸å¤Ÿçš„æƒ…å†µä¸‹é¢ï¼Œå…¶ä¼šå…·æœ‰å¾ˆé«˜çš„varianceï¼Œå³ç»Ÿè®¡å­¦ä¹ é‡Œï¼Œå¸¸è¯´çš„ bias-variance tradeoffã€‚é‚£ä¹ˆå¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬æ˜¯å¸Œæœ›å¼•å…¥çš„<span class="math inline">\(F\)</span>å¯¹äº biasnessçš„å®¹å¿åº¦å¯ä»¥é«˜ä¸€ç‚¹ï¼Œä½†æ˜¯å¸Œæœ›å…¶æœ‰æ›´ä½çš„ varianceã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬æœŸæœ›<span class="math inline">\(F\)</span>çš„å¼•å…¥å¯ä»¥ç¼“è§£ singularityçš„é—®é¢˜ã€‚</em></strong></p><p>è™½ç„¶<span class="math inline">\(F\)</span>ç¡®å®æ„é€ çš„è‡ªç”±åº¦å¾ˆé«˜ï¼Œä½ å¯ä»¥é€‰æ‹©ä»»ä½•çš„æ–¹æ³•å»æ„é€ ä¸€ä¸ªåˆé€‚çš„ä¼°è®¡ç®—å­ï¼Œä½†æ˜¯å°±ä¸ªäººç†è§£æ¥è¯´ï¼Œä¸Šé¢è¿™æ®µè¯åº”å½“åšä¸€ä¸ªåŸºæœ¬çš„å‚è€ƒå‡†åˆ™ã€‚æˆ‘æƒ³è¿™ä¹Ÿæ˜¯Ledoit,Wolfåœ¨ä»–ä»¬æœ€åˆçš„ä¸¤ä¸ªå·¥ä½œé‡Œé€‰æ‹© <span class="math inline">\(F\)</span>çš„åŸåˆ™<a href="#ledoit-1"><sup>1,<sup></sup></sup></a><a href="#ledoit-2"><sup>2<sup></sup></sup></a></p><ul><li>è®¤ä¸ºä»»ä½•ä¸¤ä¸ªè‚¡ç¥¨ä¹‹é—´çš„correlationéƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œé‡‡å–å…¨å±€å¹³å‡çš„ç›¸å…³ç¨‹åº¦ä½œä¸º<span class="math inline">\(F\)</span></li><li>é‡‡ç”¨å•å› å­æ¨¡å‹å»ä¼°è®¡åæ–¹å·®çŸ©é˜µ</li></ul><h5 id="æœ€ä¼˜çš„-delta">æœ€ä¼˜çš„ <span class="math inline">\(\delta\)</span></h5><p>è¿™è¾¹æˆ‘ä»¬ä¼šä»‹ç»ä¸€ä¸‹å¦‚ä½•è·å–æœ€ä¼˜çš„ <span class="math inline">\(\delta\)</span>ã€‚æ ¹æ®ä¸Šé¢çš„ä»‹ç»ï¼Œæˆ‘ä»¬çŸ¥é“æ‰¾åˆ°æœ€ä¼˜çš„<span class="math inline">\(\delta^*\)</span> ç­‰ä»·äºæ±‚è§£ä¸‹é¢è¿™ä¸ªé—®é¢˜<span class="math display">\[\min_{\delta} \mathbb{E}\|(1-\delta) S + \delta F - \Sigma\|_2^2\]</span> è¯¥é—®é¢˜çš„è§£ä¸º <span class="math display">\[\delta^* = \frac{\sum_{ij}\mathbb{Var}[s_{ij}]- \mathbb{Cov}[f_{ij},s_{ij}]}{\sum_{ij}\mathbb{Var}[s_{ij}-f_{ij}] +(\phi_{ij}-\sigma_{ij})^2}\]</span> å…¶ä¸­ <span class="math inline">\(\Phi\)</span>ä¸ºæ„é€ å‡ºæ¥çš„ä¼°è®¡ç®—å­ <span class="math inline">\(F\)</span>çš„çœŸå®å€¼ã€‚å…·ä½“å¯ä»¥å‚è€ƒé™„å½•<a href="#opt_delta">1</a></p><p>å¾ˆæ˜¾ç„¶è¿™ä¸ªå¼å­æœ‰ä¸¤ä¸ªé—®é¢˜ï¼š</p><ul><li>ä¾èµ–<span class="math inline">\(F,S\)</span>çš„çœŸå®ç»Ÿè®¡ï¼Œæ–¹å·®å’Œåæ–¹å·®</li><li>ä¾èµ–çœŸå®æœªçŸ¥çš„ <span class="math inline">\(\Sigma,(\sigma_{ij})\)</span></li></ul><p>å¯¹äºç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬è€ƒè™‘åœ¨<span class="math inline">\(T\)</span>æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼ŒçœŸå®ç»Ÿè®¡å’Œæ ·æœ¬ä¼°è®¡ä¹‹é—´çš„è¯¯å·®æ˜¯ä»€ä¹ˆæ ·å­çš„ã€‚å¦‚æœè¯¯å·®è¾ƒå°ï¼Œé‚£ä¹ˆæˆ‘ä»¬åˆ™å¯ä»¥å¯¹äº<span class="math inline">\(\delta^*\)</span> æ„é€ ä¸€ä¸ªæ¸è¿›æœ‰æ•ˆçš„è¡¨è¾¾å¼ã€‚é¦–å…ˆå¯¹äºç¬¬ä¸€ä¸ªé—®é¢˜æ¥è¯´ï¼Œä¸­å¿ƒæé™å®šç†çš„ç›´è§‰å‘Šè¯‰æˆ‘ä»¬ï¼Œæ— è®ºæ˜¯<span class="math inline">\(\mathbb{Var}[s_{ij}],\mathbb{Cov}[f_{ij}, s_{ij}],\mathbb{Var}[s_{ij}-f_{ij}]\)</span> å…¶ä¸­å“ªä¸€ä¸ªï¼Œä»–è·Ÿéš<span class="math inline">\(T\)</span>çš„scalingåº”è¯¥éƒ½æ˜¯åœ¨ <span class="math inline">\(\frac{1}{T}\)</span> è¿™é‡çº§ä¸Šï¼Œä¹Ÿæ˜¯å°±è¯´ <span class="math inline">\(\delta^* \propto \frac{\alpha}{T}\)</span>,é‚£ä¹ˆä¸€ä¸ªæœ€åˆç†ï¼Œä¹Ÿæ˜¯æœ€ç¬¦åˆç›´è§‰çš„çŒœæµ‹ï¼Œå°±æ˜¯æˆ‘ä»¬å¯ä»¥è®¤ä¸ºï¼š <span class="math display">\[\delta^* = \frac{1}{T}\frac{\pi - \rho}{\gamma} + o(\frac{1}{T^2})\]</span> è¿™è¾¹, <span class="math display">\[\pi = \lim_{T \to \infty} \sum_{ij} \mathbb{Var}[\sqrt{T}s_{ij}],\\\rho = \lim_{T \to \infty} \sum_{ij} \mathbb{Cov}[\sqrt{T}f_{ij},\sqrt{T}s_{ij}],\\\gamma = \sum_{ij}(\phi_{ij} - \sigma_{ij})^2\]</span> ä¸¥æ ¼çš„æ•°å­¦åˆ†æå¯ä»¥å‚è€ƒé™„å½•<a href="#opt_delta">1</a>ã€‚</p><p>è¿™è¾¹æˆ‘ä»¬å¯¹ <span class="math inline">\(\delta^*\)</span>åšä¸€äº›ç®€è¦çš„è¯´æ˜ï¼Œå› ä¸º <span class="math inline">\(\delta^* \sim\frac{1}{T}\)</span>, é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥çŸ¥é“ <span class="math inline">\(T \to\infty\)</span> çš„æ—¶å€™ï¼Œ<span class="math inline">\(\delta^* \to0\)</span>, æ•´ä¸ªä¼°è®¡æ”¶æ•›åˆ° <span class="math inline">\(S\)</span>,è¿™ä¹Ÿæ˜¯å’Œæˆ‘ä»¬ç»Ÿè®¡å­¦ä¸Šæ‰€å­¦åˆ°çš„çŸ¥è¯†æ˜¯å»åˆçš„ã€‚å½“æˆ‘ä»¬æ‹¥æœ‰è¶³å¤Ÿå¤šçš„æ ·æœ¬æ˜¯ï¼Œä½¿ç”¨æ ·æœ¬åæ–¹å·®çŸ©é˜µä½œä¸ºçœŸå®åæ–¹å·®çŸ©é˜µçš„ä¼°è®¡æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ä¼°è®¡ã€‚</p><h4 id="multi-factor">Multi-factor</h4><h3 id="åŠ¨æ€correlationä¼°è®¡">åŠ¨æ€Correlationä¼°è®¡</h3><h2 id="ä¼˜åŒ–ç®—æ³•">ä¼˜åŒ–ç®—æ³•</h2><h2 id="é™„å½•">é™„å½•</h2><h3 id="opt_delta">æœ€ä¼˜çš„ <span class="math inline">\(\delta\)</span></h3><p><span class="math display">\[\|(1-\delta) S + \delta F - \Sigma\|_2^2 = \sum_{i,j=1}^N\left((1-\delta) s_{ij} + \delta f_{ij} - \sigma_{ij}\right)^2 \\= \sum_{i,j=1}^N \delta^2 \left(s_{ij}^2 + f_{ij}^2 -2s_{ij}f_{ij}\right) - 2\delta \left(s_{ij}^2 +f_{ij}\sigma_{ij}-s_{ij}\sigma_{ij}-s_{ij}f_{ij}\right) + C\]</span>å› ä¸ºä¸Šå¼ä¸ºä¸€ä¸ªå¼€å£å‘ä¸Šçš„äºŒæ¬¡å‡½æ•°ï¼Œæœ€åä¸€é¡¹è·Ÿæå€¼ç‚¹æ²¡æœ‰å¤ªå¤§å…³ç³»ã€‚åŒæ—¶æˆ‘ä»¬å¯ä»¥å‘ç°<span class="math display">\[\delta^* = \frac{\sum_{ij}\mathbb{E}\left[s_{ij}^2 + f_{ij}\sigma_{ij}-s_{ij}\sigma_{ij}-s_{ij}f_{ij}\right]}{\sum_{ij}\mathbb{E}[s_{ij}^2 +f_{ij}^2 - 2s_{ij}f_{ij}]}\]</span> å› ä¸º<span class="math inline">\(S\)</span>æ˜¯ä¸€ä¸ªæ— åçš„ä¼°è®¡,å› æ­¤ <span class="math inline">\(\mathbb{E}[S] = \Sigma\)</span>,åŒæ—¶æˆ‘ä»¬å‡è®¾æ„é€ å‡ºæ¥çš„ä¼°è®¡ <span class="math inline">\(F\)</span>åœ¨ç»Ÿè®¡æ„ä¹‰ä¸Šä¹Ÿä¼šæ”¶æ•›åˆ° <span class="math inline">\(\Phi\)</span>ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œ <span class="math display">\[\delta^* = \frac{\sum_{ij}\mathbb{Var}[s_{ij}]- \mathbb{Cov}[f_{ij},s_{ij}]}{\sum_{ij}\mathbb{Var}[s_{ij}-f_{ij}] +(\phi_{ij}-\sigma_{ij})^2}\]</span> ä¸‹é¢æˆ‘ä»¬å°†ä»¥ <span class="math inline">\(\sum_{ij}\mathbb{Var}[\sqrt{T}s_{ij}]\)</span>ä¸ºä¾‹è¯æ˜å…¶æ¸è¿‘æ”¶æ•›åˆ° <span class="math inline">\(\pi\)</span>ï¼Œä»¥æ­¤è¯´æ˜ä¸‰ä¸ªäºŒæ¬¡é¡¹çš„scalingå‡ä¸º<span class="math inline">\(\frac{1}{T}\)</span>ã€‚ æ˜¾ç„¶<span class="math inline">\(s_{ij}=\frac{1}{T}\sum_t x_{it}x_{jt} -\frac{1}{T}\sum_tx_{it}\frac{1}{T}\sum_{t}x_{jt}\)</span>ã€‚å¯¹äºç¬¬äºŒé¡¹ï¼Œä¸­å¿ƒæé™å®šç†å‘Šè¯‰æˆ‘ä»¬<span class="math inline">\(\sqrt{T}(\frac{1}{T}\sum_{t}x_{it} -\mathbb{E}[x_i]) \to \mathcal{N}(0, \mathbb{Var}[x_i])\)</span>,å‡è®¾<span class="math inline">\(X\)</span>ä¸­çš„æ‰€æœ‰çš„éšæœºå˜é‡éƒ½æ˜¯æœ‰é™çš„4é˜¶ä»¥ä¸‹çš„momentï¼Œé‚£ä¹ˆå¯¹äº<span class="math inline">\(\sqrt{T}s_{ij}\)</span>ä¸­çš„ç¬¬äºŒé¡¹åœ¨<span class="math inline">\(T\)</span>å¾ˆå¤§çš„æ—¶å€™ï¼Œåˆ™ä¸ä¼šæœ‰å®è´¨çš„è´¡çŒ®ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦æŠŠé‡ç‚¹æ”¾åœ¨ç¬¬ä¸€é¡¹ã€‚å¯¹äºç¬¬ä¸€é¡¹ï¼Œæˆ‘ä»¬è¿˜çŸ¥é“<span class="math inline">\(\sigma_{ij}=\mathbb{E}[x_ix_j]-\mathbb{E}[x_i]\mathbb{E}[x_j]\)</span>æ˜¯ä¸€ä¸ªç¡®å®šæ€§çš„æ•°å­—ï¼Œå¯¹æ¯”ä¸¤é¡¹çš„å·®è·ï¼Œæˆ‘ä»¬å‘ç°åªè¦åˆ†æ<span class="math inline">\(\frac{1}{T}\sum_{t}x_{it}x_{ij} -\mathbb{E}[x_i]\mathbb{E}[x_j]\)</span>çš„æ€§è´¨ã€‚åŒæ ·ï¼Œä¸­å¿ƒæé™å®šç†å‘Šè¯‰æˆ‘ä»¬<span class="math inline">\(\sqrt{T}(\frac{1}{T}\sum_{t}x_{it}x_{ij} -\mathbb{E}[x_i]\mathbb{E}[x_j] - \sigma_{ij}) \to \mathcal{N}(0,\rho_{ij})\)</span></p><h2 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h2><div id="ledoit-1"><div><ul><li>[1] Ledoit, O., &amp; Wolf, M. (2003). <i>Honey, I Shrunk the SampleCovariance Matrix</i>. http://www.ledoit.net/honey.pdf</li></ul><div id="ledoit-2"><div><ul><li>[2] Ledoit, O., &amp; Wolf, M. (2003). Improved estimation of thecovariance matrix of stock returns with an application to portfolioselection. <i>Journal of Empirical Finance</i>, <i>10</i>(5), 603â€“621.https://doi.org/10.1016/S0927-5398(03)00007-0</li></ul></div></div></div></div><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> æŠ•èµ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é‡åŒ–æŠ•èµ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Successful Algorithm Trading è¯»åæ„Ÿ</title>
      <link href="/2023/10/28/successful_trading/"/>
      <url>/2023/10/28/successful_trading/</url>
      
        <content type="html"><![CDATA[<h1 id="successful-algorithm-trading-è¯»åæ„Ÿ">Successful AlgorithmTrading è¯»åæ„Ÿ</h1><h2 id="æ¦‚è§ˆ">æ¦‚è§ˆ</h2><h3 id="ç®—æ³•äº¤æ˜“å’Œä¸»è§‚äº¤æ˜“çš„å¯¹æ¯”">ç®—æ³•äº¤æ˜“å’Œä¸»è§‚äº¤æ˜“çš„å¯¹æ¯”</h3><p>ä¼˜ç‚¹:</p><ul><li>æé«˜äº†æŠ•ç ”æ•ˆç‡</li><li>æ²¡æœ‰ä¸»è§‚è¾“å…¥ï¼Œå—æƒ…ç»ªå½±å“è¾ƒå°</li><li>è¯„ä»·æŒ‡æ ‡æ›´åŠ å¤šç»´</li><li>æ›´é«˜çš„äº¤æ˜“é¢‘ç‡ï¼Œäººå·¥æ“ä½œä¸æ¥</li></ul><p>ç¼ºç‚¹:</p><ul><li>éœ€è¦ä¸€å®šçš„èµ„é‡‘é‡</li><li>éœ€è¦è¾ƒé«˜çš„ç§‘å­¦ç´ å…»å’Œç¼–ç¨‹æ°´å¹³</li></ul><h3 id="æ•£æˆ·å’Œæœºæ„çš„å¯¹æ¯”">æ•£æˆ·å’Œæœºæ„çš„å¯¹æ¯”</h3><p>æ•£æˆ·çš„ä¼˜åŠ¿:</p><ul><li>å°èµ„é‡‘é‡æ›´åŠ çµæ´»</li><li>å¯¹å†²åŸºé‡‘ä¹‹é—´äººå‘˜æµåŠ¨ï¼Œä¼šå¯¼è‡´ç­–ç•¥è¶‹åŒï¼Œé€ æˆäº¤æ˜“æ‹¥æŒ¤ï¼Œæ•£æˆ·çš„äº¤æ˜“ç³»ç»Ÿå’Œè¿™äº›å…³è”è¾ƒå°</li><li>æ•£æˆ·çš„äº¤æ˜“å¯¹å¸‚åœºä»·æ ¼çš„å†²å‡»å¯ä»¥å¿½ç•¥</li></ul><p>æ•£æˆ·çš„åŠ£åŠ¿:</p><ul><li>å¯¹æ æ†çš„ä½¿ç”¨æœ‰æ›´å¤šçš„é™åˆ¶</li><li>æ•£æˆ·çš„äº¤æ˜“åœ¨åˆ¸å•†çš„æ’é˜Ÿå¾€å¾€ä¼˜å…ˆçº§è¾ƒä½ï¼Œè¿™ä¼šé€ æˆå®ç›˜å’Œå›æµ‹æœ‰è¾ƒå¤§å·®è·</li><li>ä¿¡æ¯æ•°æ®æ»å</li></ul><p>æ•£æˆ·å¯¹äºé£é™©ç®¡ç†ç›¸æ¯”äºåŸºé‡‘æ¥è¯´ï¼Œä¼šæ›´åŠ è‡ªç”±ï¼Œå®Œå…¨å–å†³äºä¸ªäººçš„é£é™©åå¥½ã€‚è¿™æœ‰å¥½æœ‰åï¼Œå¾€å¾€è¿™ä¹Ÿä¼šè®©æ•£æˆ·å¿½ç•¥é£é™©ç®¡ç†ï¼ŒæŠŠç»å¤§éƒ¨åˆ†æ—¶é—´æ”¾åœ¨æ„å»ºäº¤æ˜“ç­–ç•¥ä¸Šã€‚</p><p>æ•£æˆ·ä¸éœ€è¦å…³æ³¨äº¤æ˜“æ›²çº¿ï¼Œä¸éœ€è¦å’ŒæŠ•èµ„è€…æ‰“äº¤é“ï¼Œä¸éœ€è¦å®šæœŸå…¬å¸ƒäº‹é¡¹æ»¡è¶³ç›‘ç®¡ï¼Œä¸éœ€è¦å’ŒåŒè¡Œæ¯”ï¼Œä¸éœ€è¦å’Œè¢«åŠ¨æŠ•èµ„æ¯”ã€‚æ•£æˆ·åªéœ€è¦å…³æ³¨çš„å°±æ˜¯ç»å¯¹æ”¶ç›Šã€‚</p><h2 id="å›æµ‹">å›æµ‹</h2><h3 id="ä¸ºä»€ä¹ˆéœ€è¦å›æµ‹">ä¸ºä»€ä¹ˆéœ€è¦å›æµ‹</h3><p>å›æµ‹å¯ä»¥å¸®åŠ©åšåˆ°ä¸‹é¢å‡ ç‚¹ï¼š</p><ul><li>ç­›é€‰ï¼šå¯ä»¥å¿«é€Ÿå¸®æˆ‘ç­›é€‰ç­–ç•¥</li><li>å»ºæ¨¡ï¼šå¯ä»¥å¿«é€ŸéªŒè¯å¯¹å¸‚åœºçš„æƒ³æ³•</li><li>ä¼˜åŒ–ï¼šå¯ä»¥ç²¾ç»†æ‰“ç£¨è‡ªå·±çš„ç­–ç•¥</li></ul><h3 id="å›æµ‹è¿‡ç¨‹ä¸­å¸¸è§çš„åå·®bias">å›æµ‹è¿‡ç¨‹ä¸­å¸¸è§çš„åå·®(Bias)</h3><p>æˆ‘ä»¬é€šè¿‡å›æµ‹æ…¢æ…¢è¿­ä»£è‡ªå·±çš„ç­–ç•¥çš„æ—¶å€™ï¼Œå¾€å¾€ä¹Ÿå¼•å…¥äº†å¾ˆå¤šçš„åå·®(Bias)ï¼Œå¸¸è§çš„æœ‰ï¼š</p><ul><li>ä¼˜åŒ–åå·®(Optimisation Bias)<ul><li>è¿‡æ‹Ÿåˆæ•°æ®ï¼ŒåŒ…æ‹¬æ¨¡å‹ï¼Œç­–ç•¥è¶…å‚æ•°ç­‰ç­‰</li></ul></li><li>æœªæ¥ä¿¡æ¯(Look ahead Bias)</li><li>å¹¸å­˜åå·®(Survivorship Bias)<ul><li>æ¯å¹´æœ‰å¤§é‡çš„è‚¡ç¥¨é€€å¸‚ï¼Œä½†æ˜¯å¾€å¾€æ•°æ®é›†é‡Œé¢åªä¼šåŒ…å«å­˜æ´»è‡³ä»Šçš„è‚¡ç¥¨æ•°æ®</li></ul></li><li>ä¸»è§‚åå·®(Cognitive Bias)<ul><li>é¢å¯¹å›æµ‹æ›²çº¿é‡Œé¢æœ€å¤§å›æ’¤åœ¨25%ï¼Œå¯èƒ½è¾ƒå®¹æ˜“æ¥å—ã€‚ä½†æ˜¯å®ç›˜é¢å¯¹å¦‚æ­¤çš„å›æµ‹å¾€å¾€éš¾ä»¥å¿å—ï¼Œå› æ­¤å¾ˆå¤šç­–ç•¥ç»ˆæ­¢åœ¨ä½ç‚¹ã€‚</li></ul></li></ul><h3 id="äº¤æ˜“æŸè€—">äº¤æ˜“æŸè€—</h3><p>äº¤æ˜“è¿‡ç¨‹ä¸­å¸¦æ¥çš„æŸè€—åŒ…æ‹¬ä½†ä¸é™äºï¼š</p><ul><li>æ‰‹ç»­è´¹<ul><li>å°èŠ±ç¨</li><li>ä½£é‡‘</li><li>...</li></ul></li><li>æ»‘ç‚¹(Slippage)<ul><li>äº¤æ˜“ä¿¡å·å¯¹åº”çš„ä»·æ ¼å’Œå®é™…ä»·æ ¼ä¹‹é—´çš„å·®è·</li><li>ä¸»è¦å› ç´ åŒ…æ‹¬ï¼šæ³¢åŠ¨æ€§ï¼Œå»¶è¿Ÿï¼Œäº¤æ˜“é¢‘ç‡</li></ul></li><li>å¸‚åœºå†²å‡»</li></ul><h3 id="äº¤æ˜“é£æ ¼">äº¤æ˜“é£æ ¼</h3><p>åœ¨ç¡®å®šè‡ªå·±çš„äº¤æ˜“é£æ ¼ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ä»ä¸‹é¢å‡ ä¸ªæ–¹é¢å‡ºå‘ï¼š -ä½ çš„æ€§æ ¼æ˜¯ä»€ä¹ˆæ ·å­çš„ - ä½ æ‰€å…è®¸çš„äº¤æ˜“æ—¶é—´æ˜¯æ€ä¹ˆæ ·çš„</p><h2 id="æ—¶é—´åºåˆ—åˆ†æ">æ—¶é—´åºåˆ—åˆ†æ</h2><p>è¿™ä¸€èŠ‚å…³äºæ—¶é—´åºåˆ—åˆ†æçš„ç›¸å…³ç®—æ³•ï¼Œä½œè€…è®²å¾—éå¸¸ç®€æ´ï¼Œä¸å€¼å¾—è®°å½•ã€‚</p><h2 id="é¢„æµ‹">é¢„æµ‹</h2><p>è¿™è¾¹ä½œè€…åªæ˜¯ç®€å•å‡å°‘äº†ä¸€äº›å¸¸è§çš„æœºå™¨å­¦ä¹ ç®—æ³•ï¼Œä¾‹å¦‚é€»è¾‘å›å½’ï¼Œçº¿æ€§å›å½’ï¼Œæ”¯æŒå‘é‡æœºï¼Œéšæœºæ£®æ—ç­‰ç­‰ï¼Œä»¥åŠæœºå™¨å­¦ä¹ å½“ä¸­å¸¸è§çš„å¯¹äºç»“æœåˆ¤åˆ«çš„æ–¹æ³•ã€‚</p><h2 id="ä¸šç»©å½’å› -é£é™©ç®¡ç†">ä¸šç»©å½’å›  &amp;&amp; é£é™©ç®¡ç†</h2><p>ä»å„ä¸ªlevelçš„ä¸šç»©å½’å› ï¼Œå¯ä»¥æ›´å¥½åœ°å›æº¯æ•´ä¸ªäº¤æ˜“ç³»ç»Ÿçš„é—®é¢˜ã€‚ä¸€èˆ¬å¯ä»¥ä»å¦‚ä¸‹å‡ ä¸ªæ–¹é¢çœ‹å¾…æ•´ä¸ªä¸šç»©çš„è¡¨ç°:</p><ul><li>ç­–ç•¥<ul><li>ç­–ç•¥åœ¨å›æµ‹ä¸­çš„æ¨¡æ‹Ÿ</li><li>ç­–ç•¥åœ¨æ¨¡æ‹Ÿç›˜ä¸­çš„è¡¨ç°(æ¨¡æ‹Ÿç›˜äº¤æ˜“è¯¯å·®å‡ ä¹å¯ä»¥å¿½ç•¥)</li></ul></li><li>äº¤æ˜“æ‰§è¡Œ<ul><li>è¡¡é‡ç­–ç•¥æä¾›çš„äº¤æ˜“ä¿¡å·å’Œç°å®äº¤æ˜“æ‰§è¡Œäº§ç”Ÿçš„è¯¯å·®</li></ul></li><li>æŠ•èµ„ç»„åˆç®¡ç†<ul><li>æ˜¯å¦å­˜åœ¨æ›´åŠ åˆç†çš„æŠ•èµ„ç»„åˆç®¡ç†ï¼Œå¯ä»¥é™ä½äº¤æ˜“çš„æŸè€—</li></ul></li></ul><p>é‚£ä¹ˆä½•ä¸ºä¸Šè¿°æ‰€è¯´çš„"ä¸šç»©"å‘¢ï¼Œä¸€èˆ¬æˆ‘ä»¬éœ€è¦ä»ä¸‹é¢å‡ ä¸ªè§’åº¦å»è€ƒè™‘:</p><ul><li>æ”¶ç›Š<ul><li>æ€»æ”¶ç›Š: è®¡ç®—çš„æ—¶å€™éœ€è¦è€ƒè™‘æ æ†ï¼Œåšç©ºç­‰ç­‰å› ç´ </li><li>å¤åˆå¹´åŒ–æ”¶ç›Š</li></ul></li><li>é£é™©<ul><li>å›æ’¤(DrawDown)</li><li>æ”¶ç›Šçš„æ³¢åŠ¨ç‡</li></ul></li><li>é£é™©æ”¶ç›Š<ul><li>Sharpe Ratio: <span class="math inline">\(\sqrt{N}\frac{\mathbb{E}[R_{\alpha}-R_{\beta}]}{\sqrt{\mathbb{Var}[R_{\alpha} - R_{\beta}]}}\)</span>,è¿™è¾¹<span class="math inline">\(N\)</span>ä¸ºä¸€å¹´å†…äº¤æ˜“æ—¥æ•°ç›®ï¼Œå¦‚æœä½ çš„æ”¶ç›Šæ˜¯æŒ‰ç…§å¤©è®¡ç®—çš„è¯ã€‚<span class="math inline">\(R_{\alpha} - R_{\beta}\)</span>ä»£è¡¨è¶…é¢æ”¶ç›Šã€‚å…¶ä¸­Benchmarkå¯ä»¥é€‰æ‹©ä¸ºå¯¹åº”çš„ETF.</li><li>Sortino Ratio: <span class="math inline">\(\sqrt{N}\frac{\mathbb{E}[R_{\alpha}-R_{\beta}]}{\sqrt{\mathbb{Var}[R_{\alpha} - R_{\beta}]}_d}\)</span>.è¿™è¾¹çš„ä¸‹æ ‡<span class="math inline">\(d\)</span>ä»£è¡¨æˆ‘ä»¬åªè€ƒè™‘ï¼Œå½“è¶…é¢æ”¶ç›Šä¸ºè´Ÿçš„æ—¶å€™æ³¢åŠ¨ç‡ï¼Œå› ä¸ºäºæŸçš„æ³¢åŠ¨ï¼Œæ›´åŠ å®¹æ˜“äº¤æ˜“æƒ…ç»ªçš„æ³¢åŠ¨ã€‚</li><li>Calmar Ratio: <span class="math inline">\(\sqrt{N}\frac{\mathbb{E}[R_{\alpha}-R_{\beta}]}{\max \mathbf{drawdown}}\)</span>.</li></ul></li><li>äº¤æ˜“æŒ‡æ ‡<ul><li>PnL</li><li>Average Period PnL</li><li>Maximum Period Profit</li><li>Maximum Period Loss</li><li>Average Period Profit</li><li>Average Period Loss</li><li>Wining Period</li><li>Losing Period</li><li>Percentage Win/Loss Periods</li></ul></li></ul><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> æŠ•èµ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é‡åŒ–æŠ•èµ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Replicator Dynamics and reinforcement learning</title>
      <link href="/2023/01/01/ess_rl/"/>
      <url>/2023/01/01/ess_rl/</url>
      
        <content type="html"><![CDATA[<object data="./ess_rl.pdf" type="application/pdf" width="100%" height="877px"><a id="more"></a></object><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> äººå·¥æ™ºèƒ½ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¼ºåŒ–å­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linux/macå·¥ä½œç¯å¢ƒé…ç½®</title>
      <link href="/2023/01/01/prepare_env/"/>
      <url>/2023/01/01/prepare_env/</url>
      
        <content type="html"><![CDATA[<h1 id="prepare-work-env-for-linux">Prepare Work Env for Linux</h1><p>Prepare your work environment for linux system <a id="more"></a> ##Software install</p><h3 id="git">git</h3><p>Use git with ssh style: - generate private and public key:</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd ~/.ssh &amp;&amp; ssh-keygen -o</span><br></pre></td></tr></tbody></table></figure><p></p><pre><code>- now github only support sha-2, we could use the following code to generate ```ssh-keygen -t ecdsa -b 521 -C "your_email"```</code></pre><ul><li>check whether it does generate <em>id_rsa</em> and<em>id_rsa.pub</em></li><li>copy your <em>id_rsa.pub</em> to your git account setting</li></ul><p><strong><em>Note</em></strong> If you use <code>git clone</code>timeouts, you can use <code>ssh -vT git_url</code> to check port orother information</p><h3 id="zsh">zsh</h3><p>install oh my zsh - install zsh <code>yum install zsh</code> - changeshell to zsh <code>chsh -s /bin/zsh</code> - install oh-my-zsh</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh -c "$(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)"</span><br></pre></td></tr></tbody></table></figure><h3 id="gcc">gcc</h3><p>update gcc version #### centos under 7.6</p><ul><li><p>install <code>yum install centos-release-scl</code></p></li><li><p>find gcc related <code>yum list dev\*gcc</code></p></li><li><p>install gcc related<code>yum install devtoolset-x-gcc devtoolset-x-gcc-c++</code></p></li><li><p>valid temporarily<code>source /opt/rh/devtoolset-x/enable</code></p></li><li><p>check <code>gcc -v</code> and <code>g++ -v</code></p></li><li><p>valid permanently add<code>source /opt/rh/devtoolset-x-gcc-c++</code> to your bashrc orzshrc</p></li></ul><h4 id="cento-beyond-7.6">cento beyond 7.6</h4><p>Note that <code>devtools-x-gcc</code> has been renamed as<code>gcc-toolset-x</code> - check<code>yum list | grep gcc-toolset</code></p><ul><li><p>use dnf to install<code>dnf install gcc-toolset-x</code></p></li><li><p>source to activate<code>source /opt/rh/gcc-toolset-x/enable</code></p></li></ul><h3 id="conda">conda</h3><p>follow the instruction <a href="https://docs.anaconda.com/anaconda/install/linux/">Install CondaLinux</a></p><h3 id="go">go</h3><p>install golang - download<code>wget https://go.dev/dl/go1.18.3.linux-amd64.tar.gz</code> - removethe oldest go - use <code>which go</code> to find the current go -remove <code>rm -rf $cur_go_dir</code> such as<code>rm -rf /usr/local/go</code> - decompress<code>tar -C /usr/local -xzf go1.18.3.linux-amd64.tar.gz</code> - envvariable <code>export PATH=$PATH:/usr/loca/go/bin</code>, add to zshrcmake permanently - remove source file<code>rm go1.18.3.linux-amd64.tar.gz</code></p><h3 id="protobuf">protobuf</h3><ul><li>download the particular version <figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget  https://github.com/protocolbuffers/protobuf/releases/download/v3.7.1/protobuf-cpp-3.7.1.tar.gz</span><br></pre></td></tr></tbody></table></figure></li><li><code>tar -xzvf protobuf-cpp-3.7.1.tar.gz</code></li><li>install <figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd protobuf-3.7.1</span><br><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">make check</span><br><span class="line">sudo make install</span><br><span class="line">sudo ldconfig</span><br></pre></td></tr></tbody></table></figure></li><li>to support golang<code>go install google.golang.org/protobuf/cmd/protoc-gen-go@latest</code></li></ul><h3 id="tmux">tmux</h3><p>If you want to install tmux2, just use <code>yum</code> or<code>dnf</code></p><p>Install tmux 3.0 - install deps </p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install libtermcap-devel ncurses-devel libevent-devel readline-devel</span><br></pre></td></tr></tbody></table></figure> <figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/tmux/tmux.git</span><br><span class="line">cd ./tmux</span><br><span class="line">git checkout 3.0</span><br><span class="line">sh autogen.sh</span><br><span class="line">./configure &amp;&amp; make</span><br><span class="line">sudo make install</span><br></pre></td></tr></tbody></table></figure><p></p><h3 id="vim">vim</h3><p>follow the instruction by <a href="git@github.com:anschen1994/vimrc.git">url</a></p><h3 id="tldr">tldr</h3><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dnf install nodejs</span><br><span class="line">npm install tldr</span><br></pre></td></tr></tbody></table></figure><h3 id="tensorflow">tensorflow</h3><p><strong><em>tensoflow 1.15 is not supported by python3.8 and laterversion. If you want to install 1.15, pls installpython3.7</em></strong></p><h3 id="docker">docker</h3><p>remove images store position</p><h3 id="vscode">vscode</h3><h4 id="vscode-free-key-pass">vscode free key pass</h4><ul><li>local generate ssh-key <code>ssh-keygen -o</code></li><li>copy <code>id_rsa.pub</code> to your remote server<code>id_rsa.pub</code> and <code>authorized_keys</code></li></ul><h1 id="ä»é›¶é…ç½®mac">ä»é›¶é…ç½®mac</h1><h2 id="ç³»ç»Ÿ">ç³»ç»Ÿ</h2><p>ç³»ç»Ÿå¿«æ·é”®: </p><figure class="highlight plain"><figcaption><span>```Setting```-&gt;```Keyboard```-&gt;```Keyboard Shorcuts```-&gt;```Modifier Keys```</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Safariåœ°å€æ æœç´¢å¼•æ“ä¿®æ”¹ï¼š```Safari```-&gt;```Setting```-&gt;```Search</span><br></pre></td></tr></tbody></table></figure><p></p><h2 id="vscode-1">VSCode</h2><ol type="1"><li>é€‰æ‹©ä½¿ç”¨<code>github</code>è´¦å·åŒæ­¥</li><li><code>vim</code>æ’ä»¶ï¼Œrepeated keys, è¿è¡Œä¸‹é¢çš„æŒ‡ä»¤: <figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">defaults write com.microsoft.VSCode ApplePressAndHoldEnabled -bool false              # For VS Code</span><br><span class="line">defaults write com.microsoft.VSCodeInsiders ApplePressAndHoldEnabled -bool false      # For VS Code Insider</span><br><span class="line">defaults write com.visualstudio.code.oss ApplePressAndHoldEnabled -bool false         # For VS Codium</span><br><span class="line">defaults write com.microsoft.VSCodeExploration ApplePressAndHoldEnabled -bool false   # For VS Codium Exploration users</span><br><span class="line">defaults delete -g ApplePressAndHoldEnabled</span><br></pre></td></tr></tbody></table></figure>å¹¶ä¸”å¯ä»¥åœ¨å…‰æ ‡ç§»åŠ¨çš„é€Ÿåº¦:<code>System Preference</code>-&gt;<code>Keyboard</code></li></ol><h2 id="terminal">Terminal</h2><ol type="1"><li>å®‰è£…<code>iterm2</code></li><li>å®‰è£…<code>homebrew</code></li><li>å®‰è£…<code>oh-my-zsh</code><ul><li>å®‰è£…æ’ä»¶<code>https://mdnice.com/writing/6774c6693d374e548b0a4434f85dceb6</code></li></ul></li><li>å®‰è£…<code>tldr</code>: <code>brew install tldr</code></li><li><code>LazyVim</code>é…ç½®:<ul><li><code>brew install neovim</code></li><li>Follow <code>https://www.lazyvim.org/installation</code></li></ul></li><li>å®‰è£…<code>tmux</code><ul><li><code>brew install tmux</code></li><li>æ‹·è´é…ç½®æ–‡ä»¶<code>mac_tmux.conf</code></li></ul></li><li>é…ç½®vimæ¨¡å¼:åœ¨<code>.zshrc</code>çš„pluginä¸­åŠ å…¥<code>vi-mode</code>æ’ä»¶</li></ol><h2 id="python">Python</h2><ol type="1"><li>å®‰è£…<code>miniconda</code></li></ol><h2 id="git-1">git</h2><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd ~/.ssh &amp;&amp; ssh-keygen -t ecdsa -b 521 -C "your_email"</span><br></pre></td></tr></tbody></table></figure><h2 id="zsh-1">zsh</h2><p>æ’ä»¶ -<code>zsh-autosuggestions` -</code>zsh-syntax-highlighting`</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> CSå·¥ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è½¯ä»¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¿æ€§å›å½’æ¼«è°ˆ</title>
      <link href="/2022/09/11/linear_regression/"/>
      <url>/2022/09/11/linear_regression/</url>
      
        <content type="html"><![CDATA[<h1 id="çº¿æ€§å›å½’æ¼«è°ˆ">çº¿æ€§å›å½’æ¼«è°ˆ</h1><p>çº¿æ€§å›å½’æ˜¯ä¸€é¡¹å‡è®¾å› æœçº¿æ€§çš„æ•°æ®æ‹Ÿåˆæ–¹æ³•ï¼Œå¦‚ä»Šä¹Ÿæ˜¯è¢«å¤§å®¶å¹¿æ³›ä½¿ç”¨ã€‚ä½†æ˜¯å…¶ä¸­å¯¹åº”underlyingçš„æ¡ä»¶å‡è®¾éƒ½è¢«å¤§å®¶å¿½ç•¥äº†ï¼Œè¿™ç¯‡æ–‡ç« å°è¯•è¯¦ç»†æ•´ç†çº¿æ€§å›å½’çš„æ–¹æ–¹é¢é¢ï¼Œæ–¹ä¾¿ä¹‹åå›é¡¾å’Œå‚è€ƒã€‚å¤§éƒ¨åˆ†çš„èµ„æ–™éƒ½å¯ä»¥åœ¨å‚è€ƒæ–‡çŒ®ä¸­æ‰¾åˆ°ã€‚<a id="more"></a></p><h2 id="ç›®å½•">ç›®å½•</h2><p>[TOC] ## å‡è®¾é¦–å…ˆæˆ‘ä»¬å°†å„ä¸ªåç»­ä½¿ç”¨åˆ°çš„å‡è®¾æ¡ä»¶åœ¨è¿™ä¸ª<code>section</code>åˆ—ä¸¾å‡ºæ¥:</p><blockquote><p><strong>Assumption1: Linearity</strong><span id="A1"> <span class="math display">\[Y = X\beta + \epsilon, Y \in \mathbb{R}^{N \times 1}, X \in\mathbb{R}^{N \times (K+1)}, \beta \in \mathbb{R}^{(K+1) \times 1},\epsilon \in \mathbb{R}^{N \times 1}\]</span></span></p></blockquote><p>è¿™ä¸ªå‡è®¾æ˜¯æˆ‘ä»¬é‡‡å–é™æ€§å›å½’çš„åŸºç¡€ï¼Œå³å‡è®¾å› æœå…³ç³»ç¬¦åˆç°è¡Œè¡¨è¾¾ã€‚<span class="math inline">\(N\)</span>ä»£è¡¨ç€æ ·æœ¬æ•°é‡ï¼Œ<span class="math inline">\(K+1\)</span>ä»£è¡¨å› å˜é‡çš„ä¸ªæ•°<span class="math inline">\(K\)</span>åŠ ä¸Š<span class="math inline">\(1\)</span>ä¸ª<code>biasness</code>ã€‚<span class="math inline">\(\epsilon\)</span>æ˜¯æˆ‘ä»¬ä¿—ç§°çš„æ®‹å·®é¡¹ï¼Œå½“ç„¶åœ¨é‡‘èé¢†åŸŸï¼Œå¾ˆå¤šäººä¹Ÿç§°ä¹‹ä¸ºç‰¹å¼‚æ€§è¯¯å·®ã€‚</p><blockquote><p><strong>Assumption2: Strict Exogenity</strong> <span class="math display">\[\mathbb{E}[\epsilon | X] = 0\]</span></p></blockquote><p>è¿™å‡è®¾å‘Šè¯‰æˆ‘ä»¬ï¼Œ<span class="math inline">\(Y\)</span>èƒ½å¤Ÿè¢«<span class="math inline">\(X\)</span>çš„çº¿æ€§è¡¨ç¤ºå……åˆ†è¡¨è¾¾ã€‚åŒæ—¶è¿™ä¸ªå‡è®¾ä¹Ÿæ„å‘³ç€,<span class="math display">\[\mathbb{E}[\epsilon] = 0, \mathbb{E}[\epsilon X] = 0,\mathbb{Cov}[\epsilon, X] = 0\]</span></p><blockquote><p><strong>Assumption3: Conditional Homoskedasticity</strong> <span class="math display">\[\mathbb{Var}[\epsilon | X] = \sigma_{\epsilon}^2 I\]</span></p></blockquote><blockquote><p><strong>Assumption4: Conditionally Uncorrelated</strong> <span class="math display">\[\mathbb{Cov}(\epsilon_i, \epsilon_j | X) = 0, \forall i \neq j\]</span></p></blockquote><p>å€¼å¾—æ³¨æ„çš„æ˜¯å‡è®¾2-4ï¼Œä¸‰ä¸ªå‡è®¾æ˜¯éå¸¸å¼ºçš„å‡è®¾ã€‚ä»–ä»¬éƒ½è¦æ±‚åœ¨ä»»æ„ç»™å®šçš„<span class="math inline">\(X\)</span>æ¡ä»¶ä¸‹ï¼Œ<span class="math inline">\(\epsilon\)</span>çš„ä¸€é˜¶å’ŒäºŒé˜¶ç»Ÿè®¡é‡æ»¡è¶³ä¸€äº›æ¡ä»¶ï¼Œè¿™å°±æ„å‘³ç€<span class="math inline">\(\epsilon\)</span>æœ¬èº«ä¹Ÿéœ€è¦æ»¡è¶³è¿™äº›æ¡ä»¶ï¼Œä½†æ˜¯åä¹‹å´ä¸ç„¶ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œ<span class="math inline">\(\mathbb{E}[f(\epsilon)] = \mathbb{E}_X\left[\mathbb{E}[f(\epsilon)|X]\right]\)</span>, å½“<span class="math inline">\(\mathbb{E}[f(\epsilon)|X]\)</span>æ˜¯ä¸€ä¸ª<span class="math inline">\(X\)</span>æ— å…³çš„é‡çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥claim<span class="math inline">\(\mathbb{E}[f(\epsilon)]\)</span>ä¹Ÿæ»¡è¶³çš„ç›¸åŒçš„æ€§è´¨ï¼Œä½†æ˜¯åè¿‡æ¥ï¼Œ<span class="math inline">\(\mathbb{E}[f(\epsilon)]\)</span>æ»¡è¶³æŸä¸ªæ€§è´¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸èƒ½claim <span class="math inline">\(\mathbb{E}[f(\epsilon|X)]\)</span>ä¹Ÿæ»¡è¶³æ”¹æ€§è´¨</p><blockquote><p><strong>Assumption5: Linear Independence</strong> <span class="math display">\[\sum_{k=1}^K c_{k}X_{ik} = 0, \forall i=1,\cdots, N \Leftrightarrow c_k= 0, \forall k = 1, \cdots, K\]</span></p></blockquote><p>è¯¥å‡è®¾åˆ™ä¿è¯æ¨¡å‹é€‰å–çš„å› å˜é‡æ˜¯çº¿æ€§ç‹¬ç«‹çš„ï¼Œå³æˆ‘ä»¬æ²¡æœ‰é€‰å–â€œé‡å¤â€çš„å› å˜é‡ã€‚è¯¥å‡è®¾ä¹Ÿä¿è¯äº†çº¿æ€§å›å½’æ¨¡å‹åœ¨æ•°å­¦ä¸Šçš„å¯æ±‚è§£æ€§ï¼Œå› ä¸ºå®ƒæ„å‘³ç€ï¼Œ<span class="math display">\[rank(X) = k + 1, \\\det{X^T X} \neq 0\]</span></p><blockquote><p><strong>Assumption6: Gaussional Res</strong> <span class="math display">\[\epsilon | X \sim \mathcal{N}(0, \sigma_\epsilon^2 I)\]</span></p></blockquote><p>æ®‹å·®ç¬¦åˆé«˜æ–¯åˆ†å¸ƒè¿™ä¸ªå‡è®¾åˆ™æ˜¯æ›´åŠ å¼ºäºå‡è®¾2-4ï¼Œæˆ‘ç›¸ä¿¡æœ‰ä¸€éƒ¨åˆ†äººä¼šè®¤ä¸ºè¯¥å‡è®¾æ˜¯çº¿æ€§å›å½’çš„underlyingçš„å‡è®¾ã€‚æˆ‘ä»¬åç»­å›æ­æ™“è¿™ä¸ªå‡è®¾å…¶å®å¯¹äºçº¿æ€§å›å½’æ²¡æœ‰ä»»ä½•çš„ä½œç”¨ã€‚</p><p><em>ä¸‹é¢æˆ‘ä»¬è¯¦ç»†è®¨è®ºè¿™äº›å‡è®¾åœ¨çº¿æ€§å›å½’æ¨¡å‹çš„åº”ç”¨ï¼Œå¹¶ä¸”è¯•å›¾æ…¢æ…¢æŠ¹å»å…¶ä¸­çš„ä¸€äº›ï¼Œç„¶åæ¥çœ‹çœ‹å…¶å¸¦æ¥çš„å½±å“ï¼Œä»¥åŠæ–°çš„æ±‚è§£æ–¹æ³•</em></p><h2 id="ols">OLS</h2><h3 id="estimator">Estimator</h3><p>å‡è®¾æˆ‘ä»¬éœ€è¦çš„è§£å†³çš„é—®é¢˜æ»¡è¶³<strong>Assumption 1-5</strong>ã€‚<strong>Assumption2-4</strong> å‘Šè¯‰æˆ‘ä»¬å¯ä»¥é€‰å–<span class="math inline">\(\mathcal{L}_{OLS}:=\mathbb{E}[\epsilon^T\epsilon]\)</span> ä½œä¸ºä¼˜åŒ–çš„ç›®æ ‡å‡½æ•°æ˜¯åˆé€‚ï¼Œå³æˆ‘ä»¬éœ€è¦è§£å†³ä¸‹é¢çš„é—®é¢˜:<span class="math display">\[\min_{\beta} \mathcal{L}_{OLS} = \min_{\beta}\mathbb{E}\left[Y^TY-Y^TX\beta - \beta^T X^TY + \beta^T X^TXY\right]\]</span> æˆ‘ä»¬å¯ä»¥å‘ç°<span class="math inline">\(\frac{\partial\mathcal{L}_{OLS}}{\partial \beta} = -2X^T + 2X^TX\beta\)</span>,å› æ­¤ï¼Œ</p><blockquote><p><strong>OLS estimator</strong> <span class="math display">\[\hat{\beta} = (X^TX)^{-1} X^T Y\]</span></p></blockquote><p>å›é¡¾ä¹‹å‰çš„Assumptionï¼Œæˆ‘ä»¬ä¼šå‘ç°<strong>Assumption5</strong>åœ¨è¿™ä¸ªæ—¶å€™ä¿è¯äº†å¯è§£æ€§ã€‚è¯´åˆ°äº†è¿™è¾¹ï¼Œæˆ‘ä»¬æ˜¯æ—¶å€™å¼•å…¥çº¿æ€§å›å½’ä¸­ä¸€ä¸ªæœ€é‡è¦çš„(ä¸ªäººè§‚ç‚¹)çš„å®šç†:<strong>Gauss-Markov Theorem</strong></p><blockquote><p><strong>Theorem: Gauss-Markov</strong>åœ¨<strong>Assumption1-5</strong>éƒ½æˆç«‹çš„æ¡ä»¶ä¸‹ï¼ŒOLSestimatoræ„æˆä¸€ä¸ª<strong>consistent BLUE</strong>(Best Linear UnbiasedEstimator).</p></blockquote><p>æˆ‘ä»¬åœ¨é™„å½•é‡Œï¼Œå¤§æ¦‚å±•å¼€äº†å…¶è¯æ˜çš„ä¸€äº›å…³é”®ã€‚</p><h3 id="è¡¡é‡ols">è¡¡é‡OLS</h3><p>ä¸Šé¢çš„è®¨è®ºï¼Œéƒ½æ˜¯åœ¨æ¯”è¾ƒçš„ç†æƒ³çš„æƒ…å†µä¸‹ï¼Œæœ€ä¼˜çš„estimatoråº”è¯¥é•¿æˆOLSè¿™ä¸ªæ ·å­ã€‚ä½†æ˜¯åœ¨å®é™…ä¸­ï¼Œæˆ‘ä»¬è·å–çš„æ•°æ®ç»ˆç©¶å’Œç†æƒ³ä¼šæœ‰ä¸€äº›åå·®ï¼Œé‚£ä¹ˆè¿™ä¸ªåº”è¯¥æ–¹æ³•æ¥è¡¡é‡OLSåœ¨è¿™äº›æƒ…å†µä¸‹çš„è¡¨ç°ã€‚</p><h4 id="hypothesis-testing">Hypothesis Testing</h4><p>æ£€éªŒOLSæ‰€è·å¾—å¾—<span class="math inline">\(\hat{\beta}\)</span>çš„ä¼˜åŠ£ï¼Œæœ€ç®€å•çš„æ–¹å¼å°±æ˜¯å‡è¯´æ£€éªŒäº†ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦åˆ©ç”¨åˆ°<strong>Assumption6</strong>,å³ <span class="math display">\[\hat{\beta}|X \sim \mathcal{N}(\beta,\sigma^2(X^TX)^{-1})\]</span> æ—¢ç„¶<span class="math inline">\(\hat{\beta}|X\)</span>æœä»é«˜æ–¯åˆ†å¸ƒï¼Œé‚£ä¹ˆå°±ç»å…¸çš„t-æ£€éªŒ(å•å› å­åˆ†æ)æˆ–è€…F-æ£€éªŒ(å¤šå› å­åˆ†æ)æ¥åšå‡è¯´æ£€éªŒã€‚</p><h5 id="å•å› å­">å•å› å­</h5><p>å¦‚æœ<span class="math inline">\(\hat{\beta}\)</span>åªæœ‰ä¸€ç»´ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥ä½¿ç”¨t-æ£€éªŒï¼Œæ£€éªŒ<span class="math inline">\(\hat{\beta}\)</span>æœ¬èº«ã€‚å½“ç„¶è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦ä¼°è®¡çš„<span class="math inline">\(\hat{\sigma}\)</span>å»ä»£æ›¿<span class="math inline">\(\sigma\)</span>ã€‚è¿™æ ·<span class="math inline">\(t:=\frac{\hat{\beta}-\beta}{\hat{\sigma}{(X^TX)^{-\frac{1}{2}}}}\)</span>æœä»t-åˆ†å¸ƒã€‚è€Œè¿™è¾¹<span class="math inline">\(\hat{\sigma}^2\)</span>åˆ™æ˜¯å¯¹äº<span class="math inline">\(\mathbb{Var}[\epsilon]\)</span>çš„ä¼°è®¡ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨æœ€ç®€å•çš„æ–¹æ³•æ¥ä¼°è®¡ï¼Œ<span class="math display">\[\hat{\sigma}^2 = \frac{1}{N-(k+1)}\sum_{i=1}^N (Y_i - X_i \hat{\beta})^2\]</span> è¿™è¾¹<span class="math inline">\(N-(k+1)\)</span>åˆ™æ˜¯<code>Bessel correction</code>ã€‚æœ‰äº†è¿™äº›ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®Œæ•´çš„å‡è¯´æ£€éªŒæè¿°æˆï¼š</p><blockquote><p><strong>Single Factor</strong> <span class="math display">\[H_0: \hat{\beta} = \beta_0 \\H_1:\hat{\beta} \neq \beta_0\]</span></p><p>If <span class="math inline">\(t &lt; t_{\frac{\alpha}{2}}\)</span>or <span class="math inline">\(t &gt; t_{1-\frac{\alpha}{2}}\)</span>,We can reject <span class="math inline">\(H_0\)</span>, where <span class="math inline">\(\alpha\)</span> is tolerance.</p></blockquote><h5 id="å¤šå› å­">å¤šå› å­</h5><h4 id="r-square">R-square</h4><blockquote><p><strong>R-square</strong> <span class="math display">\[R^2 := \frac{\mathrm{ESS}}{\mathrm{TSS}} = \frac{\sum_{i=1}^N (\hat{Y}_i- \bar{Y})^2}{\sum_{i=1}^N (Y_i-\bar{Y})^2} = 1 -\frac{\mathrm{RSS}}{\mathrm{TSS}} = 1 - \frac{\sum_{i=1}^N\hat{\epsilon}_i^2}{\sum_{i=1}^N (Y_i-\bar{Y})^2}\]</span> R-square is also called <strong>coefficient ofdetermination</strong>.</p></blockquote><p>ä»ä¸Šé¢è¿™ä¸ªè¡¨è¾¾å¼ï¼Œæˆ‘ä»¬å¯ä»¥ä»å‡ ä½•çš„è§’åº¦å¤§æ¦‚ç†è§£äº†ä¸€ä¸‹ï¼Œ<span class="math inline">\(R^2\)</span>æ˜¯è¡¡é‡ä¸ªä»€ä¹ˆã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°<span class="math inline">\(\hat{\epsilon}\)</span>è¡¨è¾¾çš„æ„æ€ï¼Œå°±æ˜¯<span class="math inline">\(N\)</span>ç»´ç©ºé—´é‡Œçš„ä¸€ä¸ªç‚¹<span class="math inline">\(Y\)</span>åˆ°<span class="math inline">\(\{X_{:,0},X_{:,1},X_{:,2},\cdots,X_{:,K}\}\)</span>æ„æˆçš„ç©ºé—´æœ€è¿‘çš„æ¬§å¼è·ç¦»ã€‚é‚£ä¹ˆå¾ˆæ˜æ˜¾ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å…³äº<span class="math inline">\(R^2\)</span>çš„å‡ ä¸ªç»“è®º: - <span class="math inline">\(R^2\)</span>éšç€<span class="math inline">\(K\)</span>çš„å¢å¤§è€Œå¢å¤§ - <span class="math inline">\(K\geN-1\)</span>ï¼Œå¹¶ä¸”åœ¨æ»¡è¶³<strong>Assumption5</strong>çš„æ—¶å€™ï¼Œ<span class="math inline">\(R^2=1\)</span> å› æ­¤ï¼Œåœ¨ä½¿ç”¨<span class="math inline">\(R^2\)</span>å»è¯„ä»·ä¸€ä¸ªå› å­å¯¹ç›®æ ‡çš„è´¡çŒ®çš„æ—¶å€™ï¼Œæ°¸è¿œéƒ½ä¼šå¾—åˆ°ä¸€ä¸ªéè´Ÿçš„ç»“æœï¼Œè€Œè¿™ä¸ªç»“æœå¯èƒ½æ˜¯ç”±äºè¿‡æ‹Ÿåˆå¯¼è‡´çš„ï¼Œå¹¶ä¸æ˜¯è¯¥å› å­ä¸€å®šåšå‡ºæ¥çœŸæ­£æ„ä¹‰ä¸Šçš„è´¡çŒ®äº†ã€‚</p><p>ä¸ºäº†è§£å†³ä¸Šé¢çš„è¿™ä¸ªé—®é¢˜ï¼Œæœ‰äººæå‡ºäº†ä¸€ä¸ªè°ƒæ•´åçš„<span class="math inline">\(R^2\)</span>ï¼Œç§°ä¹‹ä¸º<span class="math inline">\(R_{adj}^2\)</span> &gt; <strong>AdjustedR-square</strong> &gt; <span class="math display">\[R_{adj}^2 := 1 - \frac{\mathrm{RSS}/(N-K-1)}{\mathrm{TSS}/(N-1)}= 1 -(1-R^2)\frac{N-1}{N-K-1}&gt; \]</span></p><p>è¿™è¾¹å…¶å®å€Ÿé‰´äº†F-testçš„æ€æƒ³ã€‚<span class="math inline">\(\mathrm{RSS}\)</span>å…¶å®æœ‰<span class="math inline">\(N-(K+1)\)</span>ä¸ªâ€œéšæœºè‡ªç”±åº¦â€(<span class="math inline">\(K+1\)</span>ä¸ªç»´åº¦è¢«<span class="math inline">\(X\)</span>æ‰€è§£é‡Šäº†)ã€‚<span class="math inline">\(\mathrm{TSS}\)</span>æœ‰<span class="math inline">\(N-1\)</span>ä¸ªâ€œéšæœºè‡ªç”±åº¦â€(<span class="math inline">\(\bar{Y}\)</span>çº¦æŸäº†å…¶ä¸­ä¸€ä¸ªç»´åº¦)ã€‚</p><p>æœ€åæˆ‘ä»¬è€ƒè™‘ä¸€ä¸‹<span class="math inline">\(R^2,R^2_{adj}\)</span>ç­‰äº0çš„æƒ…å†µï¼Œé‚£å°±æ˜¯æˆ‘ä»¬ä¸é‡‡å–ä»»ä½•å…¶ä»–çš„å› å­å»è§£é‡Š<span class="math inline">\(Y\)</span>ï¼Œæ°¸è¿œå°±ç”¨æ ·æœ¬çš„å¹³å‡<span class="math inline">\(\bar{Y}\)</span>å»ä½œä¸º<span class="math inline">\(Y\)</span>çš„ä¼°è®¡å€¼ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œ<span class="math inline">\(\mathrm{RSS}=\mathrm{TSS},K=1\)</span>ã€‚</p><h4 id="aic-bic">AIC &amp;&amp; BIC</h4><p><span class="math inline">\(R^2_{adj}\)</span>å¯¹äº<span class="math inline">\(R^2\)</span>çš„è°ƒæ•´ï¼Œå°±æ˜¯æœŸæœ›æˆ‘ä»¬åœ¨æœ€å°åŒ–<span class="math inline">\(\mathrm{RSS}\)</span>çš„è¿‡ç¨‹ä¸­ï¼Œå¯¹äºå› å­çš„ä¸ªæ•°æœ‰ä¸€å®šçš„æƒ©ç½šã€‚è¿™ä¸ªå’Œç°åœ¨æœºå™¨å­¦ä¹ é‡Œæ­£åˆ™åŒ–çš„æ€æƒ³æˆ‘è®¤ä¸ºä¹Ÿæ˜¯å¤§åŒå°å¼‚ã€‚é‚£ä¹ˆ<span class="math inline">\(\mathrm{AIC}\)</span>å’Œ<span class="math inline">\(\mathrm{BIC}\)</span>ä¸¤ç§<code>information criterion</code>åˆ™æ˜¯å°†è¿™ä¸ªçº¦æŸå˜å¾—æ›´åŠ æœ‰æ•°å­¦æ„ä¹‰ç‚¹ã€‚</p><blockquote><p><strong>AIC and BIC</strong> <span class="math display">\[\mathrm{AIC} = N + N\log2\pi + N \log \frac{\mathrm{RSS}}{N} + 2(K+1),\\\mathrm{BIC} = N + N\log 2\pi + N \log \frac{\mathrm{RSS}}{N} +(K+1)\log N\]</span></p></blockquote><h4 id="out-of-sample-rmse">Out-of-Sample RMSE</h4><p>æœ€åè¿™ç§ï¼Œåˆ™æ˜¯ç›®å‰æœºå™¨å­¦ä¹ ä¸­ï¼Œç›¸å¯¹ä¸»æµçš„æ–¹æ³•ï¼Œå¯¹äºä¸€ä¸ªå›å½’é—®é¢˜ï¼Œä½¿ç”¨æ ·æœ¬å¤–çš„å‡æ–¹å·®æ¥è¯„ä»·æ¨¡å‹çš„å¥½åã€‚</p><h2 id="rls">RLS</h2><p>åœ¨è€ƒè™‘å®Œç®€å•çš„OLSä¹‹åï¼Œæˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªè·Ÿå®é™…æ›´åŠ æ¥è¿‘çš„æ¨¡å‹ï¼Œå³åœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œæˆ‘ä»¬çœŸå®çš„<span class="math inline">\(\beta\)</span>å¾€å¾€ä¸æ˜¯å¯ä»¥åœ¨ç©ºé—´é‡Œä»»æ„é€‰æ‹©ï¼Œè€Œæ˜¯ä»…ä»…åªä¼šä½äºæŸäº›æ›´åŠ ä½ç»´çš„ç©ºé—´é‡Œé¢ï¼Œå³æˆ‘ä»¬éœ€è¦è§£å†³ä¸‹é¢çš„é—®é¢˜,<span class="math display">\[Y = X\beta + \epsilon, \\L\beta = r, L \in \mathbb{R}^{M\times {K=1}}, r \in \mathbb{R}^{M\times1}\]</span> å½“ç„¶è¿™è¾¹<span class="math inline">\(M &lt;K+1\)</span>,å¦åˆ™å°±æ²¡æœ‰è‡ªç”±åº¦ä¾›æˆ‘ä»¬å»ä¼˜åŒ–<span class="math inline">\(\hat{\beta}\)</span>äº†ã€‚å¯¹äºRLSçš„è§£ï¼Œæˆ‘ä»¬å€ŸåŠ©æ‹‰æ ¼æœ—æ—¥æ–¹æ³•å¯ä»¥æ±‚è§£å¾—åˆ°ï¼Œç»†èŠ‚è§é™„å½•</p><blockquote><p><strong>RLS estimator</strong> <span class="math display">\[\hat{\beta}^{RLS} = \hat{\beta}^{OLS}-(X^TX)^{-1}L^T\left(L(X^TX)^{-1}L^T\right)^{-1}(L\hat{\beta}^{OLS}-r)\]</span></p></blockquote><h3 id="è¡¡é‡rls">è¡¡é‡RLS</h3><p>é€šè¿‡å¯¹æ„é€ å‡ºæ¥çš„ä¼˜åŒ–é—®é¢˜çš„æ±‚è§£ï¼Œæˆ‘ä»¬å¾—åˆ°äº†<span class="math inline">\(\hat{\beta}^{RLS}\)</span>ï¼Œé‚£ä¹ˆæˆ‘ä¹Ÿéœ€è¦å»ä»å„ä¸ªæ–¹é¢å»è¯„ä»·å…¶çš„å¥½åã€‚é¦–å…ˆå°±æ˜¯ï¼Œæˆ‘ä»¬éœ€è¦è¯æ˜çš„<span class="math inline">\(\hat{\beta}^{RLS}\)</span>éœ€è¦æ»¡è¶³ç»™å®šçš„é™åˆ¶æ¡ä»¶<span class="math inline">\(L\hat{\beta}^{RLS} =r\)</span>ï¼Œè¿™ç‚¹ä»å…¶è¡¨è¾¾å¯ä»¥ç›´æ¥çœ‹å‡ºæ¥ã€‚ å†ä¹‹ï¼Œæˆ‘ä»¬å¯ä»¥æ£€æŸ¥ä¸€ä¸‹<span class="math inline">\(\hat{\beta}^{RLS}\)</span>ä½œä¸ºä¸€ä¸ªä¼°è®¡ç®—å­ï¼Œæ˜¯å¦æ˜¯æ— åçš„å¹¶ä¸”ä¸€è‡´çš„ã€‚å¯¹äºåç½®ï¼Œæˆ‘ä»¬è®¡ç®—ä¸€ä¸‹æœŸæœ›<span class="math inline">\(\mathbb{E}[\hat{\beta}^{RLS}]\)</span>. å› ä¸º<span class="math inline">\(\mathbb{E}[\hat{\beta}^{OLS}] =\beta\)</span>(Assumption2), æˆ‘ä»¬å¾ˆå®¹æ˜“å¾—å‡ºæ¥ï¼Œ<span class="math inline">\(\hat{\beta}^{RLS}\)</span>ä¹Ÿæ˜¯ä¸€ä¸ªæ— åä¼°è®¡ã€‚å¯¹äºä¸€è‡´æ€§ï¼Œå› ä¸º<span class="math inline">\(\mathbb{Var}[\hat{\beta}^{OLS}] = \sigma^2(X^TX)^{-1}\)</span>, å½“<span class="math inline">\(N\to\infty\)</span>,<span class="math inline">\(\mathbb{Var}[\hat{\beta}^{OLS}] \to0\)</span>, ä¹Ÿå°±æ˜¯<span class="math inline">\(\hat{\beta}^{OLS} \to\beta\)</span>, é‚£ä¹ˆæˆ‘ä»¬ä¹Ÿå¾ˆå®¹æ˜“å‘ç°<span class="math inline">\(\hat{\beta}^{RLS} \to\beta\)</span>ã€‚æ€»ç»“ä¸€ä¸‹,</p><p>é‚£ä¹ˆ<span class="math inline">\(\hat{\beta}^{RLS}\)</span>çš„æ•ˆç‡å¦‚ä½•å‘¢ï¼Œåœ¨å¯¹<span class="math inline">\(\beta\)</span>æœ‰é™åˆ¶çš„å‰æä¸‹ï¼Œ<span class="math inline">\(\hat{\beta}^{RLS}\)</span>ä¼šä¸ä¼šæ¯”<span class="math inline">\(\hat{\beta}^{OLS}\)</span>ä¼°è®¡æ›´åŠ çš„é«˜æ•ˆå‘¢ï¼Œé‚£ä¹ˆåªéœ€è¦ä¸¤ä¸ªä¼°è®¡ç®—çš„åæ–¹å·®<span class="math inline">\(\mathbb{Var}[\hat{\beta}^{RLS}]\)</span>å’Œ<span class="math inline">\(\mathbb{Var}[\hat{\beta}^{OLS}]\)</span>,é€šè¿‡ä¸€äº›ç®€å•çš„è®¡ç®—ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°, <span class="math display">\[\mathbb{Var}[\hat{\beta}^{OLS}] - \mathbb{Var}[\hat{\beta}^{RLS}] =\sigma^2(X^TX)^{-1}L^T\left(L(X^TX)^{-1}L^T\right)^{-1}L(X^TX)^{-1} \ge0\]</span></p><blockquote><p><strong>RLS Summary</strong> If the restrictions are correct, <span class="math inline">\(L\beta = r\)</span>, and all assumptions satisfiesthen: - <span class="math inline">\(\hat{\beta}^{RLS}\)</span> isunbiased - <span class="math inline">\(\hat{\beta}^{RLS}\)</span> ismore efficient than <span class="math inline">\(\hat{\beta}^{OLS}\)</span> - <span class="math inline">\(\hat{\beta}^{RLS}\)</span> is BLUE <span class="math inline">\(\hat{\beta}^{RLS}\)</span> is consistent <span class="math inline">\(\hat{\beta}^{RLS}\)</span> is asymptoticallynormally distributed: <span class="math display">\[\hat{\beta}^{RLS} \sim \mathcal{N}\left(\beta,\sigma^2D(X^TX)^{-1}\right),\]</span> where <span class="math inline">\(D=I-(X^TX)^{-1}L^T\left(L(X^TX)^{-1}L^T\right)^{-1}L\)</span></p><p>If the restrictions are wrong, <span class="math inline">\(L\beta =r\)</span>, then: <span class="math inline">\(\hat{\beta}^{RLS}\)</span>is biased(no longer BLUE) <span class="math inline">\(\hat{\beta}^{RLS}\)</span> is remains moreefficient than <span class="math inline">\(\hat{\beta}^{OLS}\)</span><span class="math inline">\(\hat{\beta}^{RLS}\)</span> isinconsistent</p></blockquote><p>è¿™è¾¹æˆ‘ä»¬éœ€è¦è¯´æ˜çš„ï¼Œ<span class="math inline">\(\hat{\beta}^{RLS}\)</span>çš„æ–¹å·®ä¸€ç›´æ¯”<span class="math inline">\(\hat{\beta}^{OLS}\)</span>è¦å°ï¼Œæ— è®ºé™åˆ¶æ¡ä»¶æ˜¯å¦æ»¡è¶³ï¼Œä½†æ˜¯è¿™å¹¶ä¸å½±å“<span class="math inline">\(\hat{\beta}^{OLS}\)</span>æ˜¯<code>BLUE</code>åœ¨æ²¡æœ‰é™åˆ¶æ¡ä»¶çš„ä¸‹ï¼Œå› ä¸ºä¸€æ—¦é™åˆ¶æ¡ä»¶è¢«ç ´åï¼Œ<span class="math inline">\(\hat{\beta}^{RLS}\)</span>è™½ç„¶æ•ˆç‡æ›´åŠ é«˜ï¼Œä½†æ˜¯å®ƒä¸å†æ˜¯ä¸€ä¸ªæ— åçš„ä¼°è®¡ç®—å­äº†ã€‚</p><p>æ—¢ç„¶å…ˆéªŒçš„æ¡ä»¶ï¼Œå¯¹äºä¸€ä¸ªä¼°è®¡ç®—å­æ¥è¯´æ˜¯å¼‚å¸¸ä¹‹é‡è¦ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é‡‡ç”¨ä¼ ç»Ÿçš„å‡è¯´æ£€éªŒï¼Œæ¥å¸®åŠ©æˆ‘ä»¬éªŒè¯å…ˆéªŒçš„æ­£ç¡®æ€§ã€‚<span class="math display">\[H_0: L\beta = r, H_1 : L\beta \neq r\]</span> é‡‡ç”¨F-testå»åšå‡è¯´æ£€éªŒçš„è¯ï¼Œåªéœ€è¦è®¡ç®—ï¼Œ <span class="math display">\[F := \frac{(\mathrm{RSS}_R -\mathrm{RSS}_{UR})/M}{\mathrm{RSS}_{UR}/(N-(k+1))}\]</span></p><h2 id="å…±çº¿æ€§">å…±çº¿æ€§</h2><p>ä¸Šé¢ä¸¤ä¸ªé—®é¢˜ï¼Œæ— è®ºæ˜¯OLSè¿˜æ˜¯RLSï¼Œè¦æƒ³æ±‚è§£éƒ½ç¦»ä¸å¼€<strong>Assumption5</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬éœ€è¦<span class="math inline">\((X^TX)\)</span>è¿™ä¸ªçŸ©é˜µæ˜¯å¯é€†çš„ï¼Œæˆ–è€…å°±æ˜¯æˆ‘ä»¬ç»™å‡ºå› å­ä¹‹é—´ä¸è¦å­˜åœ¨çº¿æ€§å…³è”ã€‚ä½†æ˜¯åœ¨å®é™…å»ºæ¨¡ä¸­ï¼Œå°¤å…¶æ˜¯é¢å¯¹å¯è§£é‡Šæ€§æ²¡æœ‰é‚£ä¹ˆå¼ºçš„å› å­æ—¶ï¼Œè¿™ä¸ªæ¡ä»¶å¾€å¾€ä¸æˆç«‹ï¼Œæˆ–è€…è¯´æˆ‘ä»¬å¾ˆéš¾å‡†ç¡®åœ°åˆ¤æ–­è¿™ä¸ªæ¡ä»¶æ˜¯ä¸æ˜¯æˆç«‹ã€‚å› æ­¤åœ¨å®é™…ä¸­ä½¿ç”¨çš„æ—¶å€™ï¼Œå› æ­¤æ•°æ®æˆ–å¤šæˆ–å°‘å­˜åœ¨ä¸€äº›å™ªå£°ï¼Œæ±‚è§£å™¨å¾€å¾€ä¸ä¼šç›´æ¥æŠ›å‡º<span class="math inline">\((X^TX)\)</span>ä¸å¯é€†çš„é”™è¯¯ï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶ä¸èƒ½å¿½ç•¥å…±çº¿æ€§å¸¦æ¥çš„å½±å“ã€‚</p><p>æˆ‘ä»¬å¾ˆå®¹æƒ³åˆ°çš„é—®é¢˜å°±æœ‰ï¼š</p><ul><li>ä¼°è®¡ç®—å­çš„æ–¹å·®<span class="math inline">\(\sigma^2(X^TX)^{-1}\)</span>ä¼šå¾ˆå¤§ï¼Œå¾ˆä¸ç¨³å®š</li><li>åœ¨åšé¢„æµ‹çš„æ—¶å€™ï¼Œå› å­çš„å¾®ç¬‘å˜åŒ–ï¼Œç”šè‡³è¯¥å˜åŒ–æ˜¯æ¥æºè‡ªå™ªå£°ï¼Œä¹Ÿå¯èƒ½å¯¼è‡´<span class="math inline">\(Y\)</span>çš„å·¨å¤§å·®å¼‚</li><li><span class="math inline">\(R^2\)</span>è¿œè¶…é¢„æœŸçš„å¤§ï¼Œï¼ˆè¿™ç‚¹æˆ‘è§‰å¾—å› ç´ å¤ªå¤šï¼Œæœªå¿…æ˜¯å…±çº¿æ€§å¯¼è‡´çš„ï¼‰</li><li>è¿‡æ‹Ÿåˆï¼Œå› ä¸ºå…±çº¿æ€§çš„å› å­åŒ…å«çš„ä¿¡æ¯å…¶å®å°±æ˜¯é‚£ä¹ˆå¤šï¼Œä½†æ˜¯å› å­ä¸ªæ•°å´åœ¨å¢åŠ ï¼Œå› æ­¤å¾ˆå®¹æ˜“é€ æˆè¿‡æ‹Ÿåˆï¼Œè¿™ç‚¹å’Œ<span class="math inline">\(R^2\)</span>è¶…é¢„æœŸä¹Ÿæ˜¯ç±»ä¼¼</li></ul><p>é‚£ä¹ˆå¦‚ä½•å»æ£€éªŒæˆ‘ä»¬å› å­ä¸­æ˜¯å¦å­˜åœ¨ä¸¥é‡çš„å…±çº¿æ€§ï¼Œåˆ™æ˜¯åœ¨åšçº¿æ€§å›å½’çš„æ—¶å€™ï¼Œä¸€ä¸ªå‰ç½®é—®é¢˜ã€‚ä¸€èˆ¬å¯èƒ½ä¼šæœ‰ä¸¤ç§æ–¹æ³•</p><h3 id="variance-inflation-factorvif">Variance InflationFactor(VIF)</h3><p>VIFçš„æƒ³æ³•åˆ™æ˜¯ååˆ†ç®€å•çš„ï¼Œå¦‚æœè¢«æ£€æµ‹çš„å› å­<span class="math inline">\(X_{:,j}\)</span>æ˜¯ä¸€ä¸ªè¿ç»­å˜é‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç›´æ¥ç”¨å‰©ä½™çš„å› å­å¯¹å…¶åšä¸€ä¸ªçº¿æ€§å›å½’ï¼Œå¹¶ä¸”è®¡ç®—å…¶å¯¹åº”çš„<span class="math inline">\(R^2_j\)</span>, å¦‚æœ<span class="math inline">\(R_j^2\)</span>è¿‡å¤§ï¼Œåˆ™è®¤ä¸ºè¯¥å› å­å’Œå…¶ä»–å› å­å­˜åœ¨æ¯”è¾ƒä¸¥é‡çš„å…±çº¿æ€§ã€‚<span class="math display">\[X_{:,j} = \sum_{k\neq j}X_{:,k}\alpha_k + e_j\]</span>å½“ç„¶è¿™è¾¹ä¸ºäº†å’Œä¹‹åå®šä¹‰çš„<code>GVIF</code>æœ‰ä¸ªå¯¹åº”çš„å…³ç³»ï¼Œä¸€èˆ¬æ£€æµ‹çš„æ˜¯ä¸‹é¢è¿™ä¸ªå€¼</p><blockquote><p><strong>VIF</strong> <span class="math display">\[\mathrm{VIF}_j := \frac{1}{1-R_j^2}\]</span></p></blockquote><h3 id="generalized-variance-inflation-factorgvif">Generalized VarianceInflation Factor(GVIF)</h3><p>VIFè¦æ±‚æˆ‘ä»¬æ„å»ºå‡ºä¸€ä¸ªçº¿æ€§å›å½’é—®é¢˜ï¼Œä½†æ˜¯åœ¨æœ‰äº›æ—¶å€™çº¿æ€§å›å½’é—®é¢˜å¹¶ä¸æ˜¯å¯ä»¥æ„é€ çš„ï¼Œä¾‹å¦‚è¢«æ£€æµ‹å› å­å’Œå…¶ä»–å› å­å­˜åœ¨å¤šé¡¹å¼å…³ç³»ï¼Œæˆ–è€…è¢«æ£€æµ‹å› å­æ˜¯ä¸€ä¸ªç±»åˆ«æ€§è´¨çš„å› å­ã€‚é‚£ä¹ˆè¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦å°†è¢«æ£€æµ‹çš„å› å­å½’å…¥åˆ°ä¸€ä¸ªé›†åˆå†…ï¼Œæ¯”å¦‚ï¼Œ- å¤šé¡¹å› å­ï¼š<span class="math inline">\(\mathcal{F}=(x_1, x_1^2, x_1^3,\cdots)\)</span> - ç±»åˆ«å“‘å˜é‡ï¼š<span class="math inline">\(\mathcal{F}=(1_{x\in C_1}, 1_{x\in C_2},\cdots)\)</span></p><p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬çš„å› å­è¢«åˆ†æˆä¸¤ä¸ªé›†åˆ<span class="math inline">\(\mathcal{F}, \mathcal{F}_C\)</span>,é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è®¡ç®—ä»–ä»¬çš„correlation matrixã€‚</p><blockquote><p><strong>GVIF</strong> <span class="math display">\[\mathrm{GVIF} := \frac{\det \mathbb{Cov}(\mathcal{F}) \det\mathbb{Cov}(\mathcal{F}_C)}{\det \mathbb{Cov}(\mathcal{F} \cup\mathcal{F}_C)}\]</span></p></blockquote><h3 id="å¤„ç†å…±çº¿æ€§">å¤„ç†å…±çº¿æ€§</h3><p>å¤„ç†å…±çº¿æ€§çš„æ–¹æ³•ï¼š</p><ul><li>è­¦æƒ•<em>å“‘å˜é‡é™·é˜±</em>ï¼Œå³å½“ä½ å¯¹ç±»åˆ«å› å­é‡‡ç”¨å“‘å˜é‡çš„æ—¶å€™ï¼Œå¦‚æœè¿™ä¸ªæ—¶å€™è¿˜æœ‰ä¸€ä¸ªåç½®é¡¹ï¼Œé‚£ä¹ˆåç½®å’Œå“‘å˜é‡åˆ™å¿…ç„¶æ„æˆå…±çº¿æ€§ã€‚</li><li>é€šè¿‡ä¸Šè¿°æ£€æµ‹æ–¹æ³•ï¼Œå‰”é™¤å…±çº¿æ€§å¼ºçƒˆçš„å› å­ï¼Œä½†æ˜¯å¦‚æœç›®æ ‡ä¸æ˜¯åšå› å­æ£€æµ‹ï¼Œè€Œæ˜¯å•çº¯çš„æƒ³å»é¢„æµ‹<span class="math inline">\(Y\)</span>,å‰”é™¤å¹¶ä¸æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ–¹æ³•ï¼Œå› ä¸ºæˆ‘ä»¬ä¼šä¸¢å¤±å¯¹<span class="math inline">\(Y\)</span>çš„ä¿¡æ¯ã€‚è¿™ä¸ªæ—¶å€™ï¼Œæœ€å¥½çš„æ–¹æ³•å»å¯»æ‰¾è§„é¿è¿‡æ‹Ÿåˆçš„æ–¹æ³•</li><li>é˜²æ­¢è¿‡æ‹Ÿåˆ<ul><li>å¢åŠ æ­£åˆ™é¡¹</li><li>è·å–æ›´å¤šçš„æ•°æ®ï¼Œç¼“è§£è¿‡æ‹Ÿåˆå’Œå…±çº¿æ€§å¸¦æ¥çš„å½±å“</li><li>æœ‰é™boundçš„å› å­ï¼Œé€‰æ‹©åˆé€‚çš„normarlizeæŠ€æœ¯</li></ul></li></ul><h2 id="gls">GLS</h2><p>åœ¨å…±çº¿æ€§éƒ¨åˆ†ï¼Œæˆ‘ä»¬è€ƒè™‘äº†relax <strong>Assumption5</strong>çš„å„ä¸ªæ–¹é¢ã€‚é‚£ä¹ˆåœ¨<code>GLS</code>è¿™ä¸ªéƒ¨åˆ†ï¼Œæˆ‘ä»¬è€ƒè™‘çš„æ˜¯relax<strong>Assumption 3-4</strong>ã€‚<strong>Assumption3-4</strong>è¦æ±‚çš„æ˜¯å¯¹äºéšæœºå˜é‡<span class="math inline">\(\epsilon\)</span>,å®ƒä»¬ä¹‹é—´çš„åæ–¹å·®çŸ©é˜µæ˜¯ä¸€ä¸ªæ­£æ¯”äºå•ä½çŸ©é˜µçš„é‡ï¼Œä¹Ÿæ˜¯ä¿è¯å„ä¸ªerrorä¹‹é—´æ˜¯ç›¸äº’æ— å…³è€Œä¸”å„å‘åŒæ€§ã€‚é‚£ä¹ˆå½“ç„¶ï¼Œè¿™è¾¹æŠ¹é™¤è¿™ä¸ªå‡è®¾ï¼Œåˆ™æ˜¯æˆ‘ä»¬è®¤ä¸ºåæ–¹å·®å¯ä»¥å†™æˆä¸€ä¸ªé€šç”¨çš„å½¢å¼ï¼Œ<span class="math display">\[\mathbb{Cov}(\epsilon, \epsilon) = \sigma^2 \Omega\]</span> è¿™è¾¹<span class="math inline">\(\Omega\)</span>æ˜¯ä¸€ä¸ªåŠæ­£å®šçŸ©é˜µã€‚</p><h3 id="olsè¡¨ç°">OLSè¡¨ç°</h3><p>æˆ‘ä»¬å¯ä»¥å…ˆçœ‹ä¸€ä¸‹<span class="math inline">\(\hat{\beta}^{OLS}\)</span>åœ¨è¿™ä¸ªåœºæ™¯ä¸‹é¢çš„è¡¨ç°ã€‚é¦–å…ˆå› ä¸º<strong>Assumption2</strong>çš„æˆç«‹ï¼Œå› æ­¤<span class="math inline">\(\hat{\beta}^{OLS}\)</span>ä¾ç„¶æ˜¯æ— åçš„ï¼Œè€Œä¸”å¾ˆå®¹æ˜“è®¡ç®—ï¼Œ<span class="math display">\[\mathbb{Cov}(\hat{\beta}^{OLS}, \hat{\beta}^{OLS}) = \sigma^2(X^TX)^{-1}X^T\Omega T (X^TX)^{-1} \neq \sigma^2 (X^TX)^{-1}\]</span> ä»ä¸Šé¢çš„è¡¨ç¤ºï¼Œæˆ‘ä»¬ä¾ç„¶å¯ä»¥çœ‹åˆ°<span class="math inline">\(N\to\infty, \mathbb{Cov}(\hat{\beta}^{OLS},\hat{\beta}^{OLS}) \to 0\)</span>, å› æ­¤ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹é¢ï¼Œ <strong><span class="math inline">\(\hat{\beta}^{OLS}\)</span>ä»ç„¶æ˜¯ä¸€ä¸ªæ— åå¹¶ä¸”ä¸€è‡´çš„ä¼°è®¡ç®—å­</strong></p><p>ä½†æ˜¯æˆ‘ä»¬ä¸Šé¢çš„ç»Ÿè®¡æ¨æ–­çš„å¾ˆå¤šæ–¹æ³•åœ¨è¿™è¾¹éƒ½ä¸å†ä½¿ç”¨äº†ï¼Œå› ä¸ºåœ¨æ²¡æœ‰å…³è”å¹¶ä¸”å„å‘åŒæ€§çš„è¯¯å·®å‡è®¾ï¼Œæˆ‘ä»¬é‡‡ç”¨äº†<span class="math inline">\(\hat{\epsilon}^T\hat{\epsilon}\)</span>æ¥ä¼°è®¡<span class="math inline">\(\hat{\sigma}^2\)</span>ï¼Œé‚£ä¹ˆæ˜¾ç„¶åœ¨è¿™è¾¹<span class="math inline">\(\hat{\epsilon}^T\hat{\epsilon}=\frac{1}{N-(K+1)}((Y-X\hat{\beta}^{OLS})^T(Y-X\hat{\beta}^{OLS}))\)</span>æ˜¯ä¸€ä¸ªæœ‰åå¹¶ä¸”ä¸ä¸€è‡´çš„ä¼°è®¡äº†ã€‚</p><h3 id="é€šç”¨çš„ä¼°è®¡ç®—å­">é€šç”¨çš„ä¼°è®¡ç®—å­</h3><p>åŸºæœ¬çº¿æ€§ä»£æ•°æ–¹æ³•ï¼Œå‘Šè¯‰æˆ‘ä»¬å¯¹äºç›¸å…³çš„éšæœºå˜é‡çš„åæ–¹å·®çŸ©é˜µï¼Œè¦å¯¹è¿™äº›éšæœºå˜é‡è¿›è¡Œè§£è€¦ï¼Œæœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨æ­£äº¤çŸ©é˜µç›´æ¥å¯¹è§’åŒ–è¿™ä¸ªåæ–¹å·®çŸ©é˜µã€‚ç„¶åä¸ºäº†ä¿è¯å„ä¸ªæ–¹å‘çš„å„å‘åŒæ€§ï¼Œæˆ‘ä»¬å†åœ¨æ–°çš„åæ ‡ç³»ä¸‹è¿›è¡Œä¸€äº›ç®€å•çš„ä¼¸ç¼©å˜æ¢å°±å¯ä»¥äº†ã€‚ç»¼åˆä¸Šé¢ä¸¤æ­¥ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªä¸‰è§’çŸ©é˜µ<span class="math inline">\(U\)</span>ï¼Œæ»¡è¶³ <span class="math display">\[\Omega^{-1} = UU^T\]</span>é‚£ä¹ˆå¾ˆå®¹æ˜“æˆ‘ä»¬å¯ä»¥å°†é€šè¿‡ä¸‹é¢çš„å˜æ¢<code>GLS</code>è½¬åŒ–æˆ<code>OLS</code><span class="math display">\[\tilde{Y} = \tilde{X} \beta + \tilde{\epsilon}, \tilde{Y}:=U^TY,\tilde{X}:=U^TX, \tilde{\epsilon}:=U^T \epsilon\]</span> å› æ­¤</p><blockquote><p><strong>GLS Estimator</strong> <span class="math display">\[\hat{\beta}^{GLS} = (X^TUU^TX)^{-1}X^TUU^TY =(X^T\Omega^{-1}X)^{-1}X^T\Omega^{-1}Y\]</span></p></blockquote><h3 id="summary">Summary</h3><p>é€šè¿‡<span class="math inline">\(U\)</span>å˜æ¢ä¹‹åï¼Œ<code>OLS</code>çš„é‚£äº›åˆ†æéƒ½å¯ä»¥æ‹“å±•åˆ°<code>GLS</code>ä¸­æ¥ï¼Œè¿™è¾¹åªæ˜¯æ€»ç»“ä¸€ä¸‹æœ€ç»ˆçš„ç»“æœï¼Œå…·ä½“å¯è‡ªè¡Œæ ¹æ®ä¸Šé¢çš„å†…å®¹æ¨å¯¼.</p><blockquote><p><strong>GLS Summary</strong> - The error variance <span class="math display">\[\hat{\sigma}^2=\frac{1}{N-(K+1)}(\tilde{Y}-\tilde{X}\hat{\beta}^{GLS})^T(\tilde{Y}-\tilde{X}\hat{\beta}^{GLS})\\ =\frac{1}{N-(K+1)}((Y-X\hat{\beta}^{GLS})^T)\Omega^{-1}(Y-X\hat{\beta}^{GLS})\]</span><span class="math inline">\(\hat{\sigma}^2\)</span>æ˜¯å¯¹<span class="math inline">\(\sigma^2\)</span>çš„ä¸€ä¸ªæ— åï¼Œä¸€è‡´çš„ä¼°è®¡ã€‚ - <span class="math inline">\(\hat{\beta}^{GLS}\)</span> æ˜¯ä¸€ä¸ªæ— åçš„ä¼°è®¡, <span class="math inline">\(\mathbb{E}[\hat{\beta}^{GLS}] = \beta\)</span> -åæ–¹å·®çŸ©é˜µä¸º<span class="math inline">\(\mathbb{Cov}(\hat{\beta}^{GLS},\hat{\beta}^{GLS}) = \sigma^2(X^T\Omega^{-1}X)^{-1}\)</span> -å¦‚æœ<strong>Assumption5</strong>æˆç«‹ï¼Œé‚£ä¹ˆ<span class="math inline">\(\hat{\beta}^{GLS} | X \sim \mathcal{N}(\beta,\sigma^2(X^T\Omega^{-1}X)^{-1})\)</span> - <span class="math inline">\(\hat{\beta}^{GLS}\)</span> is BLUE</p></blockquote><h3 id="ç°å®ä¸ç†æƒ³">ç°å®ä¸ç†æƒ³</h3><p>æˆ‘ä»¬å¯ä»¥å‘ç°ä¸Šé¢çš„æ‰€æœ‰å…³ç³»ï¼Œä»çº¿æ€§å˜æ¢å¼€å§‹ï¼Œéƒ½éšå«å‡è®¾äº†æˆ‘ä»¬çŸ¥é“äº†<span class="math inline">\(\Omega\)</span>è¿™ä¸ªçŸ©é˜µã€‚å½“ç„¶åœ¨ç°å®ä¸­ï¼Œæˆ‘ä»¬æœ‰çš„æƒ…å†µæ˜¯çŸ¥é“<span class="math inline">\(\Omega\)</span>çš„ï¼Œæ¯”å¦‚Barraçº¯å› å­æ¨¡å‹ä¸­ï¼Œå‡è®¾äº†æ³¢åŠ¨å’Œè‚¡ç¥¨å¸‚å€¼çš„å¹³æ–¹æ ¹æˆæ­£æ¯”ï¼Œä»è€Œè®¤ä¸ºçš„æ„é€ å‡ºäº†ä¸€ä¸ª<span class="math inline">\(\Omega\)</span>ã€‚ä½†æ˜¯åœ¨ç»å¤§éƒ¨åˆ†æ•°å­¦åˆ†æçš„å·¥ä½œä¸­ï¼Œ<span class="math inline">\(\Omega\)</span>éƒ½æ˜¯æœªçŸ¥çš„ã€‚å› æ­¤å¦‚ä½•å»æ„é€ ä¸€ä¸ª<span class="math inline">\(\Omega\)</span>çš„ä¼°è®¡<span class="math inline">\(\hat{\Omega}\)</span>æ‰æ˜¯æ•´ä¸ªå»ºæ¨¡çš„å…³é”®ã€‚</p><!-- åœ¨è¿™èŠ‚æˆ‘ä»¬åŒæ—¶æ‰“ç ´äº†å‡è®¾**Assumption3**å’Œ**Assumption4**ç›´æ¥é€ æˆäº†ç°å®ä¸ç†æƒ³å¦‚æ­¤å·¨å¤§çš„é¸¿æ²Ÿã€‚æ¥ä¸‹æ¥ä¸¤èŠ‚ï¼Œæˆ‘ä»¬å°†æ‘’å¼ƒè¿™å­£åº¦è¿½æ±‚æ™®é€‚æ€§çš„åšæ³•ï¼Œåˆ†åˆ«åˆ†æåœ¨æ‰“ç ´è¿™ä¸¤ä¸ªå‡è®¾å…¶ä¸­ä¹‹ä¸€çš„æƒ…å†µã€‚## å„å‘åŒæ€§åœ¨è¿™èŠ‚ä¸­ï¼Œ**Assumption3**è¢«æ‰“ç ´ï¼Œ**Assumption4**ä»ç„¶æˆç«‹ã€‚ --><h2 id="é™„å½•">é™„å½•</h2><h3 id="gauss-markov-theorem">Gauss-Markov Theorem</h3><p>ä»»ä½•ä¸€ä¸ªçº¿æ€§çš„estimator <span class="math inline">\(\tilde{\beta} = MY\)</span>, æˆ‘ä»¬éœ€è¦è¯æ˜çš„ <span class="math inline">\(\hat{\beta}\)</span>åœ¨æ‰€æœ‰çš„<span class="math inline">\(\tilde{\beta}\)</span>ä¸­æ‹¥æœ‰æœ€å°çš„ä¼°è®¡æ–¹å·®ï¼Œä»¥åŠå…¶èƒ½ä¿è¯ä¸€è‡´æ€§ã€‚å¯¹äºä¸€è‡´æ€§æ¥è¯´ï¼Œæˆ‘ä»¬éœ€è¦è¯æ˜<span class="math inline">\(\mathbb{E}[\hat{\beta}]=\beta\)</span>. <span class="math display">\[\mathbb{E}[\hat{\beta}] = \mathbb{E}_X\left[\beta |X +(X^TX)^{-1}X^T\mathbb{E}[\epsilon | X]\right] = \beta\]</span> å½“ç„¶ä»ä¸Šé¢çš„å¼å­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹å‡ºæ¥ <span class="math display">\[\mathbb{E}[\hat{\beta}|X] = \beta\]</span> è¿™è¾¹æˆ‘ä»¬åªç”¨åˆ°äº†<strong>Assumption2</strong></p><p>ä¸‹é¢æˆ‘ä»¬å¼€å§‹è¯æ˜ï¼ŒOLSå…·æœ‰æœ€å°çš„æ¡ä»¶åæ–¹å·®çŸ©é˜µï¼Œå³ <span class="math inline">\(\mathbb{Cov}(\hat{\beta}, \hat{\beta} | X) \le\mathbb{Cov}(\tilde{\beta}, \tilde{\beta} | X)\)</span>. ä»¤<span class="math inline">\(M = D + (X^TX)^{-1}X^T\)</span>,æˆ‘ä»¬å¾ˆå®¹æ˜“è®¡ç®—å‡ºæ¥ï¼Œ <span class="math display">\[\mathbb{Cov}(\tilde{\beta}, \tilde{\beta} | X ) = DYY^TD^T +\mathbb{Cov}{(\hat{\beta}, \hat{\beta} | X)}\]</span> QED</p><h3 id="rlsé—®é¢˜">RLSé—®é¢˜</h3><p>å¯¹äºRLSçš„æ‹‰æ ¼æœ—æ—¥é‡å¯ä»¥å†™æˆï¼Œ <span class="math display">\[\mathcal{L}(\beta, \lambda) = (Y-X\beta)^T(Y-X\beta) + 2\lambda^T(L\beta-r)\]</span> å…¶å¯¹åº”çš„å¯¼æ•°ä¸º <span class="math display">\[\frac{\partial \mathcal{L}}{\partial \beta} = -2X^TY + 2X^TX\beta +2L^T\lambda = 0 \\\frac{\partial \mathcal{L}}{\partial \lambda} = 2L\beta - 2r = 0\]</span> é‚£ä¹ˆ<span class="math inline">\(\beta,\lambda\)</span>åˆ™æ˜¯ä¸‹é¢çº¿æ€§æ–¹ç¨‹ç»„çš„è§£, <span class="math display">\[\left(\begin{array}{cc}X^TX &amp; L^T \\ L &amp; 0\end{array}\right)\left(\begin{array}{c}\beta \\ \lambda\end{array}\right) =\left(\begin{array}{c}X^TY \\ r\end{array}\right)\]</span> é€šè¿‡æ±‚é€†ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å¾—åˆ° <span class="math display">\[\hat{\beta}^{RLS} = \hat{\beta}^{OLS}-(X^TX)^{-1}L^T\left(L(X^TX)^{-1}L^T\right)^{-1}(L\hat{\beta}^{OLS}-r),\\\lambda = \left(L(X^TX)^{-1}L^T\right)^{-1}\left(L\hat{\beta}^{OLS} -r\right)\]</span></p><h2 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h2><ol type="1"><li>Book, Element of statistical learning</li><li>https://papers.ssrn.com/sol3/papers.cfm?abstract_id=1601414</li><li>http://web.vu.lt/mif/a.buteikis/wp-content/uploads/PE_Book/</li></ol><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> äººå·¥æ™ºèƒ½ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°å­¦ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Time Series Analysis</title>
      <link href="/2022/07/25/time_series/"/>
      <url>/2022/07/25/time_series/</url>
      
        <content type="html"><![CDATA[<h1 id="time-series-analysis">Time Series Analysis</h1><p>This is unfinised time series analysis note, which is wished to bedone around 2023 March <a id="more"></a></p><h2 id="arma">ARMA</h2><blockquote><p>Definition[White Noise] We call a sequence of r.v <span class="math inline">\(\{e_t\}\)</span> as white noise, if <span class="math inline">\(\mathrm{E}[e_t]=0, \mathrm{E}[e_t^2] = \sigma^2,\mathrm{E}[e_te_s] = 0, \forall t \neq s\)</span></p></blockquote><blockquote><p>Definition[strictly stationary] A process <span class="math inline">\(\{y_t\}\)</span> is called strictly stationary iffor each <span class="math inline">\(t,k,n\)</span> <span class="math inline">\(y_t, \cdots, y_{t+k}\}\)</span> has the samedistribution as <span class="math inline">\(\{y_{t+n}, \cdots,y_{t+n+k}\}\)</span></p></blockquote><blockquote><p>Definition[weakly stationary] A process <span class="math inline">\(\{y_t\}\)</span> is called weakly stationary iffor each <span class="math inline">\(k,t\)</span> <span class="math inline">\(\mathrm{E}[y_t], \mathrm{E}[y_t^2],\mathrm{E}[y_ty_{t+k}]\)</span> is independent of <span class="math inline">\(t\)</span></p></blockquote><blockquote><p>Definition[Lag Operator] Lag operator is defined as <span class="math inline">\(Ly_t = y_{t-1}\)</span></p></blockquote><blockquote><p>Corollary - Lag polynomial defined as <span class="math inline">\(a(L;p):=\sum_{i=0}^{p}a_i L^i\)</span> hascommuted multiplication, i.e. <span class="math inline">\(a(L; p)b(L; q)= b(L; q)a(L; p)\)</span> - If the roots of <span class="math inline">\(a(L)\)</span> are out of unit circle, then it isinvertible.</p></blockquote><p>Here, we demonstrate a simple example of the second point. For apolynomial $a(L; 1) = 1 - L $, whose root is out of unit circle when<span class="math inline">\(|\lambda| &lt; 1\)</span>, its inverse canbe represented as, <span class="math display">\[a^{-1}(L,1) = \sum_{i=0}^{+\infty}\lambda^i L^i\]</span></p><h3 id="simple-processes">Simple Processes</h3><blockquote><p>Definition[<strong>AR</strong>] Auto regressive process with order<span class="math inline">\(p\)</span> is defined as <span class="math display">\[a(L;p)y_t = e_t\]</span></p></blockquote><blockquote><p>Definition[<strong>MA</strong>] Moving Averaging Process with order<span class="math inline">\(q\)</span> is defined as <span class="math display">\[y_t = b(L;q)e_t\]</span></p></blockquote><blockquote><p>Definition[<strong>ARMA</strong>] The <span class="math inline">\((p,q)\)</span> order of ARMA is, <span class="math display">\[a(L;q)y_t = b(L;q)e_t\]</span></p></blockquote><p><strong>AR</strong> is regression, since we can expand the definitionas <span class="math inline">\(a_0 y_t = \sum_{i=1}^p(-a_i)y_{t-i} +e_t\)</span>, which is just we do regression of <span class="math inline">\(y_t\)</span> in terms of <span class="math inline">\(y_{t-1}, \cdots, y_{t-i}\)</span></p><p>The intution of <strong>MA</strong> is more direct, that is, <span class="math display">\[y_t = \sum_{i=0}^q b_i e_{t-i}\]</span> we use weights <span class="math inline">\(\{b_i\}\)</span> toaverage another stochastic process.</p><p>Hence, <strong>ARMA</strong> just tries to find a linear combinationof signal sequences <span class="math inline">\(y_t\)</span> to fit thelinear of combination of noise sequence <span class="math inline">\(e_t\)</span>.</p><blockquote><p>Corollary Combing with the above invertible conditions, we claim thatthere exists a bridge between <strong>AR</strong> and<strong>MA</strong>.</p></blockquote><p>For example, <strong>AR</strong><span class="math inline">\((p)\)</span> has an equivalent representation of<strong>MA</strong><span class="math inline">\((\infty)\)</span> if<span class="math inline">\(a(L;p)\)</span> is invertible. The reversedclaim for <strong>MA</strong><span class="math inline">\((q)\)</span>and <strong>AR</strong><span class="math inline">\((\infty)\)</span> isalso correct.</p><h3 id="covariance">Covariance</h3><blockquote><p>Definition[auto-covariance] <span class="math inline">\(\gamma_k :=\mathrm{Cov}(y_t, y_{t+k})\)</span> for weakly stationary process</p></blockquote><blockquote><p>Definition[auto-correlation] <span class="math inline">\(\rho_k : =\frac{\gamma_k}{\gamma_0}\)</span> for weakly stationary process</p></blockquote><blockquote><p>Definition[covariance function] <span class="math inline">\(\tilde{\gamma}(\xi) :=\sum_{i=-\infty}^{+\infty}\gamma_i \xi^i\)</span></p></blockquote><blockquote><p>Corollary[<strong>ARMA</strong> covariance function] The covariancefunction of <strong>ARMA</strong> is <span class="math display">\[\tilde{\gamma}(\xi) = \frac{b(\xi)b(\xi^{-1})}{a(\xi)a(\xi^{-1})}\sigma^2\]</span></p></blockquote><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> äººå·¥æ™ºèƒ½ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°å­¦ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Diffusion Map Method</title>
      <link href="/2022/07/03/diffusion_map/"/>
      <url>/2022/07/03/diffusion_map/</url>
      
        <content type="html"><![CDATA[<h1 id="diffusion-map-method">Diffusion map method</h1><p>æœ¬ç¯‡ä»‹ç»ä¸€ç§åŠç›‘ç£çš„ç®—æ³•ï¼Œä»¥åŠå…¶åœ¨ç†è®ºç‰©ç†é‡Œé¢çš„åº”ç”¨ <a id="more"></a></p><h2 id="å¼•è¨€">å¼•è¨€</h2><p>è¿™ç¯‡çš„Blogçš„æºäºï¼Œæœ€è¿‘è¯»åˆ°äº†ä¸€ç¯‡<strong>PRL</strong>çš„paperã€ŠUnsupervisedmachine learning of quantum phase transitions using diffusion mapsã€‹(https://arxiv.org/pdf/2003.07399.pdf)ã€‚è¿™ç¯‡æ–‡ç« ä½¿ç”¨äº†<code>DMM</code>ï¼ˆdiffusion mapmethodï¼‰æ¥åˆ†æé‡å­ç›¸å˜çš„ä¸€äº›ç‰¹æ€§ï¼Œè¿˜æ˜¯è›®æœ‰æ„æ€çš„ï¼Œæˆ‘ä¼šåœ¨è¿™è¾¹Blogä»‹ç»å®Œ<code>DMM</code>æ–¹æ³•ä¹‹åï¼Œå¤§æ¦‚è¯´ä¸€ä¸‹å…¶ä¸­çš„ä¸€äº›æƒ³æ³•ã€‚</p><p>åœ¨æ‰“å¼€è¿™ç¯‡paperä¹‹å‰ï¼Œåœ¨æˆ‘é™ˆæ—§çš„æœºå™¨å­¦ä¹ çŸ¥è¯†æ¡†æ¶é‡Œï¼Œç¡®å®æ²¡æœ‰<code>DMM</code>è¿™ä¸ªä¸œè¥¿ï¼Œç„¶åæˆ‘å°±å»å¥½å¥‡å»Googleäº†ä¸€ä¸‹ï¼Œå¤§æ¦‚å‘ç°äº†ä¸¤ç¯‡æœ‰ç”¨çš„paperã€‚</p><ul><li>ç¬¬ä¸€ç¯‡æ˜¯2005å¹´<strong>PNAS</strong>ï¼ˆhttps://www.pnas.org/doi/epdf/10.1073/pnas.0500334102)ï¼Œç”±Yaleå‡ ä½ç§‘å­¦å®¶æå‡ºæ¥çš„ï¼Œå°†<code>DMM</code>ç”¨æ¥åšè°ƒå’Œåˆ†æçš„å·¥å…·ã€‚</li><li>ç¬¬äºŒç¯‡(https://inside.mines.edu/~whereman/papers/delaPorte-Herbst-Hereman-vanderWalt-PRASA-2008.pdf)æ˜¯ä¸€ç¯‡ä¸é”™çš„tutorialæ€§è´¨çš„æ–‡ç« ã€‚</li></ul><p>è¯»å®Œè¿™äº›ï¼Œ<code>DMM</code>è¿™ä¸ªæ–¹æ³•è®©æˆ‘æƒŠè‰³çš„åœ°æ–¹ï¼Œä¸€å¥è¯å¤§æ¦‚æ˜¯ï¼š</p><blockquote><p>NOTE ä»å±€éƒ¨æ€§è´¨è¡ç”Ÿå…¨å±€æ€§è´¨ï¼Œè¿›è€Œè¿›è¡Œåˆ†æçš„ä¸€ç§ç®—æ³•</p></blockquote><p>æ­£å¦‚ç¬¬ä¸€ç¯‡PNASä¸­æ‰€è¯´ï¼š</p><p><em>The process of iterating or diffusing the Markov matrix is seenas a generalization of some aspects of the Newtonian paradigm, in whichlocal infinitesimal transitions of a systemlead to global macroscopicdescriptions by integration.</em></p><h2 id="dmmdifussion-map-method">DMM(Difussion map method)</h2><p>ç®—æ³•<code>DMM</code>å¤§æ¦‚ç”¨ä¸¤ç§ç”¨é€”ï¼š</p><ul><li>æ•°æ®é™ç»´</li><li>èšç±»</li></ul><p>å½“ç„¶ä¸€ä¸ªç®—æ³•å¦‚æœèƒ½å¾ˆå¥½åœ°å¯¹æ•°æ®è¿›è¡Œé™ç»´ï¼Œé¢å¤–åšæ•°æ®çš„èšç±»ä¹Ÿæ˜¯ä¸€ä¸ªç®€å•çš„ä»»åŠ¡ï¼Œæ¯”å¦‚ç»“åˆK-Meansç­‰ç­‰è¿™ç§å¸¸è§„ç®—æ³•ã€‚ä¸‹é¢æˆ‘ä»¬å°±ä¸»è¦ä»‹ç»é™ç»´æ–¹é¢çš„ä¸€äº›æƒ³æ³•</p><h3 id="ç°æœ‰çš„ç®—æ³•">ç°æœ‰çš„ç®—æ³•</h3><h4 id="pca">PCA</h4><p>æåˆ°æ•°æ®é™ç»´ï¼Œæˆ‘æƒ³ä½œä¸ºç‚¼ä¸¹å¸ˆï¼Œä¸€ä¸‹èƒ½å¤Ÿæƒ³åˆ°å¾ˆå¤šå‡ºåçš„ç®—æ³•ï¼Œå…¶ä¸­ä¸å¾—ä¸è¯´ï¼Œé<code>PCA</code>(principalcomponentanalysis)è«å±ã€‚å½“ç„¶<code>PCA</code>æ˜¯ä¸€ä¸ªçº¿æ€§ç®—æ³•ã€‚è¿™å¯ä»¥ä»å‡ æ–¹é¢æ¥ç†è§£ã€‚- ä»ä»£æ•°çš„è§’åº¦ï¼Œ<code>PCA</code>ç®—æ³•ç”¨åˆ°çš„æ“ä½œéƒ½æ˜¯ä¸€ä¸ªçº¿æ€§ç©ºé—´çš„çº¿æ€§æ“ä½œ -ä»å‡ ä½•çš„è§’åº¦ï¼Œ<code>PCA</code>åªæ˜¯é€šè¿‡æ—‹è½¬åæ ‡è½´çš„ï¼Œæ‰¾åˆ°é‚£äº›æ•°æ®é«˜åŒºåˆ†åº¦çš„åæ ‡è½´è¿›è¡Œä¿ç•™ã€‚</p><p>è¿™å…¶ä¸­æœ€å…³é”®çš„ï¼Œæ‰€è°“çš„åœ¨çº¿æ€§ç©ºé—´è¿›è¡Œçº¿æ€§æ“ä½œï¼Œæ— è®ºæ€ä¹ˆæï¼Œåæ ‡è½´æ°¸è¿œæ˜¯â€œç›´â€çš„ã€‚ä½†æ˜¯æˆ‘ä»¬çŸ¥é“ï¼Œæ¯”å¦‚æˆ‘ç©ºé—´é‡Œä¸€æ¡æ›²çº¿ï¼Œåœ¨â€œç›´â€çš„åæ ‡ç³»ä¸‹é¢ä»ç„¶éœ€è¦ä¸‰ä¸ªåæ ‡å»æè¿°ï¼Œä½†æ˜¯å®é™…ä¸Šï¼Œä¸€æ¡æ›²çº¿çš„æœ‰æ•ˆçš„ç»´åº¦æ°¸è¿œæ˜¯ä¸€ç»´çš„ï¼ˆå½“ç„¶è¿™è¾¹æè¿°ä¸å¤Ÿä¸¥è°¨ï¼Œæ¯”å¦‚ä¹Ÿæ˜¯æœ‰ä¸€äº›å¥‡æ€ªçš„æ›²çº¿ç»´åº¦æ˜¯åˆ†æ•°ç»´çš„ï¼Œè¿™è¾¹åªæ˜¯å¯¹äºé‚£ç§æ™®é€šçš„æ›²çº¿ï¼Œä¾›å¤§å®¶ç†è§£ï¼‰ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢è¿™æ¡æ›²çº¿ä¸Šï¼Œæˆ‘ç”¨ä¸‰ç§é¢œè‰²è¡¨ç¤ºäº†ä¸‰ä¸ªèšç±»ï¼Œåœ¨è¿™ç§æ•°æ®ä¸‹ï¼Œæˆ‘ä»¬æ˜¯æ²¡æœ‰åŠæ³•ä½¿ç”¨PCAå»åšæ•°æ®é™ç»´æˆ–è€…èšç±»åˆ†æã€‚<img src="/2022/07/03/diffusion_map/original.png" class="" title="This is an image"></p><h4 id="mdsmutidimensional-scaling">MDS(Mutidimensional Scaling)</h4><p>ç®—æ³•<code>MDS</code>çš„ideaï¼Œæˆ‘è§‰å¾—æ˜¯éå¸¸æ£’çš„ï¼Œæ¯”<code>PCA</code>æ›´åŠ è‡ªç„¶ï¼Œä¹Ÿæ˜¯å¦‚æœä¸€ä¸ªæ²¡æœ‰å­¦è¿‡æœºå™¨å­¦ä¹ çš„äººï¼Œè®©ä»–æ¥åšæ•°æ®é™ç»´ï¼Œæœ€å®¹æ˜“æƒ³åˆ°çš„ä¸€ä¸ªåšæ³•ã€‚è¿™è¾¹æˆ‘ä»¬ç®€å•æè¿°è¿™ä¸ªæƒ³æ³•ï¼š</p><blockquote><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸ª<span class="math inline">\(N\)</span>ä¸ªæ•°æ®ç‚¹<span class="math inline">\(x_i\)</span>ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾ä¸€ä¸ªmapï¼Œå°†æ¯ä¸ª<span class="math inline">\(x_i\)</span>æ˜ å°„åˆ°<span class="math inline">\(y_i\)</span>ï¼Œè¿˜å°½å¯èƒ½ä¿ç•™æ•°æ®ä¹‹é—´çš„"å…³ç³»"ã€‚æ¯”å¦‚æ‰¾åˆ°ä¸€ç§æ•°æ®æè¿°<span class="math inline">\(d_X,d_Y\)</span>æ¥å»ºæ¨¡è¿™ç§"å…³ç³»"ã€‚é‚£ä¹ˆå¯¹äºä»»æ„<span class="math inline">\(d_X(x_i,x_j)\)</span>ï¼Œ æˆ‘ä»¬å¸Œæœ›<span class="math inline">\(d_X(x_i,x_j)\)</span>å°(å¤§)çš„ï¼Œæ˜ å°„ä¹‹åå¯¹åº”çš„å…³ç³»<span class="math inline">\(d_Y(y_i,y_j)\)</span>ä¹Ÿå°(å¤§)ã€‚</p></blockquote><p>å½“ç„¶<code>MDS</code>é‡‡ç”¨äº†æ¬§å¼è·ç¦»æ¥å»ºæ¨¡è¿™ç§â€œå…³ç³»â€ï¼Œè¿™ä¹Ÿæ˜¯è¿™ä¸ªæ–¹æ³•çš„å±€é™ï¼Œæ¯•ç«Ÿæ¬§å¼è·ç¦»åšä¸ºçº¿æ€§ç»“æ„çš„åº¦é‡æ˜¯ä¸é”™çš„ï¼Œä½†æ˜¯å¦‚æœæ•°æ®ä¹‹é—´çš„å…³ç³»æ˜¯éçº¿æ€§çš„ï¼Œé‚£ä¹ˆæ¬§å¼è·ç¦»åªæ˜¯åœ¨é‚»åŸŸå†…çœ‹ä½œæ˜¯ä¸€ä¸ªç›¸å¯¹æœ‰æ•ˆçš„è¡¨è¾¾ã€‚</p><h4 id="dmm">DMM</h4><p>é‚£ä¹ˆåœ¨æˆ‘ä»¬ä¸çŸ¥é“æ•°æ®çš„å‡ ä½•ç»“æ„çš„æ—¶å€™ï¼ˆå¦‚æœçŸ¥é“ï¼Œåªéœ€è¦æ‹Ÿåˆå³å¯ï¼Œé—®é¢˜å°±ä¼šç®€å•äº†ï¼‰ï¼Œæˆ‘ä»¬å¦‚æœæ‰èƒ½å¦‚ä½•æœ‰æ•ˆåœ°è¡¨è¾¾å‡º<span class="math inline">\(d_X,d_Y\)</span>å‘¢ã€‚<code>DMM</code>æå‡ºäº†ä¸€ä¸ªæ ¸å¿ƒæƒ³æ³•ï¼š</p><blockquote><p>é€šè¿‡æ‰©æ•£è¿‡ç¨‹ï¼Œè¡”æ¥å±€éƒ¨æ€§è´¨å’Œå…¨å±€æ€§è´¨</p></blockquote><p>è¿™ç§æƒ³æ³•åœ¨ç‰©ç†ç ”ç©¶å…¶å®å¾ˆå¸¸è§ï¼š</p><ul><li>ç‰›é¡¿åŠ›å­¦æˆ–æ˜¯é‡å­åŠ›å­¦éƒ½æ˜¯é€šè¿‡å»ºç«‹å¾®åˆ†æ–¹ç¨‹(å±€éƒ¨)ï¼Œç„¶åç§¯åˆ†æ±‚è§£ï¼Œå¾—åˆ°ä¸€äº›å®è§‚çš„å¯è§‚æµ‹é‡(å…¨å±€)</li><li>è’™ç‰¹å¡æ´›æ¨¡æ‹Ÿï¼Œä¹Ÿæ˜¯ä½¿ç”¨å±€éƒ¨çš„æ¦‚ç‡è¿›è¡Œæ¨¡æ‹Ÿï¼Œé€šè¿‡Hamiltonianå¸¦æ¥çš„ç›¸äº’ä½œç”¨ï¼Œå°†æ•´ä¸ªå½±å“ä¼ æ’­è‡³å…¨å±€ï¼Œæœ€åå¾—ä¸€ä¸ªå¹³è¡¡æ€ã€‚</li><li>ç­‰ç­‰</li></ul><p>åœ¨<code>DMM</code>ç®—æ³•ä¸­é€šè¿‡ä¸€ä¸ªæ ¸å‡½æ•°<span class="math inline">\(k(x_i,x_j)\)</span>æ¥æ¨¡æ‹ŸåŸå§‹æ•°æ®ä¹‹é—´çš„å±€éƒ¨å…³ç³»ï¼Œæ¯”å¦‚å¸¸ç”¨çš„é«˜æ–¯æ ¸<span class="math inline">\(k(x_i,x_j) =e^{-\frac{\|x_i-x_j\|^2}{2\epsilon}}\)</span>ã€‚æ‹¥æœ‰äº†æ ¸å‡½æ•°å¯¹åº”çš„çŸ©é˜µ<span class="math inline">\(K_{ij}:=k(x_i,x_j)\)</span>ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æ¯ä¸€è¡Œè¿›è¡Œå½’ä¸€åŒ–ï¼Œå¾—åˆ°ä¸€ä¸ªç¬¦åˆè½¬ç§»çŸ©é˜µçš„è¦æ±‚çŸ©é˜µ<span class="math inline">\(P:=D^{-1}K\)</span>ï¼Œè¿™è¾¹<span class="math inline">\(D\)</span>æ˜¯ä¸€ä¸ªå¯¹è§’çŸ©é˜µï¼Œæ¯ä¸ªå…ƒç´ æ˜¯å¯¹åº”è¡Œçš„<span class="math inline">\(K\)</span>çŸ©é˜µçš„å…ƒç´ ä¹‹å’Œã€‚é‚£ä¹ˆè¿™ä¸ªæ‰©æ•£è¿‡ç¨‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡<span class="math inline">\(P, P^2, P^3, \cdots, P^t,\cdots\)</span>æ¥æ¨¡æ‹Ÿã€‚å‡è®¾æˆ‘ä»¬æ¨¡æ‹Ÿäº†<span class="math inline">\(t\)</span>æ­¥ï¼Œæ¦‚ç‡æµåœ¨è¿™ä¸ªå›¾ä¸­æµæ·Œäº†ä¸€æ®µæ—¶é—´ï¼Œå±€éƒ¨çš„æ€§è´¨é€šè¿‡è¿™ç§æµæ·Œï¼Œæ…¢æ…¢å…¨å±€åŒ–ã€‚é‚£ä¹ˆè¿™æ—¶å€™éœ€è¦ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨è¿™ç§å»ºæ¨¡çš„æƒ…å†µï¼Œæˆ‘ä»¬å¦‚ä½•å»æè¿°ç¬¬<span class="math inline">\(i\)</span>å’Œ<span class="math inline">\(j\)</span>æ•°æ®ä¹‹é—´çš„å…³ç³»å‘¢ï¼Ÿå›ç­”å¥½è¿™ä¸ªé—®é¢˜ï¼Œé‚£ä¹ˆ<code>DMM</code>çš„ç®—æ³•å°±å®Œæ¯•äº†ï¼Œå‰©ä½™çš„åªæ˜¯ä¸€äº›ä¸é‚£ä¹ˆå…³é”®çš„æ•°å­¦æ¨å¯¼äº†ã€‚åœ¨å½“å‰çš„å»ºæ¨¡æƒ…å†µï¼Œ<span class="math inline">\(P\)</span>çŸ©é˜µçš„ç¬¬<span class="math inline">\(i\)</span>è¡Œè¡¨ç¤ºçš„ç¬¬<span class="math inline">\(i\)</span>ç»„æ•°æ®å’Œå…¶ä»–æ•°æ®ä¹‹é—´çš„è½¬ç§»æ¦‚ç‡ã€‚é‚£ä¹ˆæè¿°<span class="math inline">\(i\)</span>å’Œ<span class="math inline">\(j\)</span>çš„ç›¸ä¼¼åº¦ï¼Œå…¶å®å°±å˜å¾—å¾ˆç®€å•äº†ï¼Œå°±æ˜¯æè¿°ä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒä¹‹é—´çš„ç›¸ä¼¼åº¦ã€‚æœ€å¸¸è§çš„ä¸¤ç§å°±æ˜¯ï¼š</p><ul><li>L2 <span class="math inline">\(\sum_k|P^t_{ik}-P^t_{jk}|^2\)</span></li><li>CrossEntropy <span class="math inline">\(-\sum_k P^t_{ik}\logP^t_{jk}\)</span></li></ul><p>å½“ç„¶åœ¨<code>DMM</code>ç®—æ³•ä¸­ä»–é€‰æ‹©äº†ç¬¬ä¸€ç§æè¿°å…³ç³»ï¼Œè¿™æ˜¯ä¸ºäº†ä»–åšæ•°æ®é™ç»´æ–¹ä¾¿è€Œåšçš„é€‰æ‹©ã€‚æ­£å¦‚æˆ‘ä»¬ä¹‹å‰è¯´çš„L2æ˜¯ä¸€ä¸ªæè¿°çº¿æ€§ç»“æ„çš„åº¦é‡æ–¹å¼ï¼Œé€‰æ‹©äº†<span class="math inline">\(L2\)</span>å°±æ˜¯é‡‡ç”¨æ•°æ®ç»è¿‡æ‰©æ•£è¿‡ç¨‹ä¹‹åï¼Œå±€éƒ¨çš„å…³ç³»å˜æˆäº†å…¨å±€çš„å…³ç³»ï¼Œå¹¶ä¸”å…¨å±€çš„å…³ç³»è¿›å…¥äº†ä¸€ä¸ªç›¸å¯¹å¹³å¦çš„å­æµå½¢ä¸Šå»äº†ã€‚</p><blockquote><p>è¿™è¾¹æˆ‘è‡ªå·±ä¹Ÿå¾ˆå¥½å¥‡ï¼Œå¦‚æœæˆ‘é€‰ç”¨ç¬¬äºŒç§ç›¸ä¼¼åº¦æè¿°æ–¹å¼ï¼Œè¯¥å¦‚ä½•å»åšæ•°æ®é™æ¸©å‘¢ï¼Ÿ</p></blockquote><p>åˆ°äº†è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬æ‹¥æœ‰äº†ä¸€ä¸ªæ•°æ®çš„æœ‰æ•ˆè¡¨ç¤º<span class="math inline">\(P^t_{i*}\)</span>ï¼ŒåŒæ—¶è¿˜å‡è®¾äº†çº¿æ€§ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™ä½¿ç”¨ä»€ä¹ˆæ–¹å¼å»åšæ•°æ®é™ç»´é‚£ä¹ˆå°±æ˜¯æ˜¾è€Œæ˜“è§äº†ï¼Œæˆ‘ä»¬åªéœ€è¦å¯¹<span class="math inline">\(P^t\)</span>åšä¸€æ¬¡<code>PCA</code>ï¼Œå°±å¯ä»¥åšåˆ°äº†ã€‚å½“ç„¶äº†åœ¨åŸå§‹çš„paperï¼Œç ”ç©¶äººå‘˜ä½¿ç”¨äº†ä¸€äº›æ•°å­¦æ‰‹æ®µç®€åŒ–äº†è¿™ä¸ª<code>PCA</code>è¿‡ç¨‹ï¼Œæœ‰å…´è¶£çš„å¯ä»¥çœ‹çœ‹é™„å½•å§ã€‚</p><p>åˆ°äº†è¿™è¾¹ï¼Œæœ‰äº†æ•°æ®è¡¨ç¤ºå’Œæ•°æ®ç›¸ä¼¼åº¦çš„æ•°å­¦å»ºæ¨¡ï¼Œé‚£ä¹ˆé™¤äº†æ•°æ®é™ç»´ï¼Œå»åšä¸€ä¸ªèšç±»ä»»åŠ¡ä¹Ÿæ˜¯æ¯”è¾ƒç®€å•çš„äº‹æƒ…äº†ã€‚æ¯”å¦‚å¯¹ä¸Šé¢çš„é‚£ç»„æµ‹è¯•æ•°æ®ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>DMM</code>é™ä¸‰ç»´æ•°æ®é™åˆ°äºŒç»´ï¼Œå¾—åˆ°ä¸‹é¢çš„ç»“æœ<img src="/2022/07/03/diffusion_map/two_dim.png" class="" title="This is an image"> æˆ‘ä»¬å¾ˆå®¹æ˜“å¾—å‡ºä¸‹é¢ä¸¤ç‚¹ç»“è®ºï¼š</p><ul><li>æ•°æ®çš„orderå¾—åˆ°äº†ä¿è¯ï¼Œè“-æ©˜-ç»¿</li><li>æ•°æ®å˜å¾—æ›´åŠ çš„ç´§è‡´</li></ul><p>å¦‚æœé™ç»´åˆ°ä¸€ç»´çš„ç»“æœï¼Œå°±æ˜¯æŠŠä¸Šé¢è¿™ä¸ªå›¾å‘<span class="math inline">\(x\)</span>è½´æŠ•å½±ï¼Œæˆ‘ä»¬ä¼šå‘ç°ä¸Šé¢çš„ä¸¤ç‚¹ç»“è®ºä»ç„¶æ˜¯æˆç«‹çš„ã€‚è¿™ä¸ªDemoçš„ä¾‹å­å¯ä»¥ç”¨ä¸‹é¢è¿™æ®µç”Ÿæˆ</p><p></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">import matplotlib.pyplot as plt</span><br><span class="line">import numpy as np</span><br><span class="line">from mpl_toolkits.mplot3d import Axes3D</span><br><span class="line"></span><br><span class="line">def gaussian_kernel(point1, point2, alpha: float = 0.01):</span><br><span class="line">    return np.exp(-np.linalg.norm(point1 - point2)**2 / alpha)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class DiffusionMap:</span><br><span class="line">    """</span><br><span class="line">    a simple realization of diffusion map method</span><br><span class="line">    """</span><br><span class="line">    def __init__(self):</span><br><span class="line">        pass</span><br><span class="line"></span><br><span class="line">    @staticmethod</span><br><span class="line">    def diff_map(data: np.ndarray, kernel_func, keep_dim: int = 2):</span><br><span class="line">        """</span><br><span class="line">        Params:</span><br><span class="line">        -------------------</span><br><span class="line">        data: N x M numpy array, N data points with original dimension M</span><br><span class="line">        kernel_func: a function, give the measure between two data points</span><br><span class="line">        keep_dime: int, the number of dimension left</span><br><span class="line">        """</span><br><span class="line">        data_num = data.shape[0]</span><br><span class="line">        kernel_mat = np.zeros((data_num, data_num))</span><br><span class="line">        for i in range(data_num):</span><br><span class="line">            for j in range(data_num):</span><br><span class="line">                kernel_mat[i, j] = kernel_func(data[i, :], data[j, :])</span><br><span class="line">        normalize_mat = np.diag(np.sum(kernel_mat, axis=1))</span><br><span class="line">        normalize_mat_sqrt = np.sqrt(normalize_mat)</span><br><span class="line">        normalize_mat_sqrt_inv = np.linalg.inv(normalize_mat_sqrt)</span><br><span class="line">        transition_mat_sim = normalize_mat_sqrt_inv.dot(kernel_mat).dot(normalize_mat_sqrt_inv)</span><br><span class="line">        print("symmetry error:", np.sum(np.abs(transition_mat_sim - transition_mat_sim.T)))</span><br><span class="line">        # transition_mat = kernel_mat / np.sum(kernel_mat, axis=1, keepdims=True)</span><br><span class="line">        eig_vals, eig_vecs_sim = np.linalg.eig(transition_mat_sim)</span><br><span class="line">        # print("eig_vals:", eig_vals)</span><br><span class="line">        eig_vals_sort = np.sort(eig_vals)[::-1]</span><br><span class="line">        eig_vals_sort_index = np.argsort(eig_vals)[::-1]</span><br><span class="line">        eig_vecs_tran = normalize_mat_sqrt_inv.dot(eig_vecs_sim)</span><br><span class="line">        if keep_dim &gt; data_num - 1:</span><br><span class="line">            keep_dim = data_num - 1</span><br><span class="line">        diffusion_map = np.zeros((data_num, keep_dim))</span><br><span class="line">        for i in range(keep_dim):</span><br><span class="line">            val = eig_vals_sort[i+1]</span><br><span class="line">            eig_vec = eig_vecs_tran[:, eig_vals_sort_index[i+1]]</span><br><span class="line">            print("norm:", np.linalg.norm(eig_vec))</span><br><span class="line">            diffusion_map[:, i] = val * eig_vec</span><br><span class="line">        return diffusion_map</span><br><span class="line"></span><br><span class="line">if __name__ == "__main__":</span><br><span class="line">    n = 300</span><br><span class="line">    r = np.linspace(0, 1, n)</span><br><span class="line">    theta = np.linspace(0, 6 * np.pi, n)</span><br><span class="line">    phi = np.linspace(0, np.pi / 4, n)</span><br><span class="line">    x = r * np.cos(theta) * np.cos(phi)</span><br><span class="line">    y = r * np.sin(theta) * np.cos(phi)</span><br><span class="line">    z = r * np.sin(phi)</span><br><span class="line">    fig1 = plt.figure()</span><br><span class="line">    ax1 = Axes3D(fig1)</span><br><span class="line">    ax1.scatter(x[:100], y[:100], z[:100])</span><br><span class="line">    ax1.scatter(x[100:200], y[100:200], z[100:200])</span><br><span class="line">    ax1.scatter(x[200:], y[200:], z[200:])</span><br><span class="line">    data = np.concatenate([x.reshape(-1,1), y.reshape(-1,1), z.reshape(-1,1)], axis=1)</span><br><span class="line">    reduce_data = DiffusionMap.diff_map(data, gaussian_kernel)</span><br><span class="line">    fig2 = plt.figure()</span><br><span class="line">    plt.scatter(reduce_data[:100,0], reduce_data[:100,1])</span><br><span class="line">    plt.scatter(reduce_data[100:200,0], reduce_data[100:200,1])</span><br><span class="line">    plt.scatter(reduce_data[200:,0], reduce_data[200:,1])</span><br><span class="line">    plt.show()</span><br></pre></td></tr></tbody></table></figure><p></p><h2 id="ä½¿ç”¨dmmç ”ç©¶é‡å­ç›¸å˜">ä½¿ç”¨DMMç ”ç©¶é‡å­ç›¸å˜</h2><p>è¿™è¾¹ä¸»è¦æ˜¯å±•ç¤ºä¸€ä¸‹ä¹‹å‰é‚£ç¯‡<strong>PRL</strong>çš„å…¶ä¸­ä¹‹ä¸€çš„ä¸€ä¸ªå·¥ä½œã€‚åœ¨è¿™è¾¹æ–‡ç« ä¸­ï¼Œä½œè€…ä½¿ç”¨DMMæ¥åšèšç±»ä»»åŠ¡ï¼Œè®¤ä¸ºç±»åˆ«çš„æ•°ç›®å¯ä»¥ä½œä¸ºä¸€ä¸ªå®è§‚çš„é‡æ¥æè¿°å„ç§ç‰©ç†ç›¸ã€‚</p>é¦–å…ˆï¼Œå’±ä»¬å…ˆæŠŠç‰©ç†æŠ›åœ¨è„‘åï¼Œå…ˆæ€è€ƒä¸€ä¸ªé—®é¢˜<span class="math inline">\(\epsilon\)</span>å’Œèšç±»çš„æ•°ç›®çš„å…³ç³»åº”è¯¥æ˜¯ä»€ä¹ˆæ ·å­çš„ã€‚<img src="/2022/07/03/diffusion_map/prl1.png" class="" title="This is an image"><center>ç‰¹å¾åŠå¾„å’Œèšç±»æ•°ç›®çš„å…³ç³»</center><p>å¦‚ä¸Šå›¾ä¸­è“çº¿æ‰€ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥æƒ³è±¡ï¼Œå½“<span class="math inline">\(\epsilon\)</span>å¾ˆå°çš„æ—¶å€™ï¼Œæ ¸å‡½æ•°è¡°å‡å¾—éå¸¸å¿«ï¼Œé‚£ä¹ˆæ¯ä¸ªæ•°æ®ç‚¹ï¼Œå°±å¾ˆå®¹æ˜“è¢«éš”ç¦»å¼€ï¼Œè‡ªå·±å•ç‹¬å½¢æˆä¸€ä¸ªèšç±»ã€‚éšç€<span class="math inline">\(\epsilon\)</span>çš„æ…¢æ…¢å¢å¤§ï¼Œä¸€äº›ç›¸è¿‘çš„æ•°æ®ç‚¹ä¹‹é—´çš„è¿æ¥é€æ¸å½¢æˆï¼Œé‚£ä¹ˆèšç±»å¼€å§‹æˆå›¢ç°‡çŠ¶ã€‚ç›´åˆ°<span class="math inline">\(\epsilon\)</span>å˜å¾—å¾ˆå¤§ï¼Œæ ¸å‡½æ•°åœ¨æ•´ä¸ªå°ºåº¦éƒ½ä¸æ€ä¹ˆè¡°å‡ï¼Œæ‰€æœ‰æ•°æ®ç‚¹æ„æˆä¸€ä¸ªå›¢ç°‡ã€‚æ˜¾ç„¶ï¼Œä¸­é—´çš„è¿™ç§çŠ¶æ€æ˜¯æ¯”è¾ƒæœ‰æ„æ€çš„æƒ…å†µï¼Œä¸¤ç«¯çš„æƒ…å†µåˆ™ç›¸å¯¹trivialã€‚</p><p>ä¸‹é¢ä½œè€…ç”¨äº†ä¸€ä¸ªç†è®ºç‰©ç†å¸¸ç”¨çš„æ¨¡å‹ï¼Œ <span class="math inline">\(Z_3\)</span>çš„æ¨ªåœºIsingæ¨¡å‹ï¼Œå“ˆå¯†é¡¿é‡å¯ä»¥å†™æˆä¸‹é¢è¿™ç§å½¢å¼:<span class="math display">\[H = -f \sum_{j=1}^N \tau_j e^{i\theta} - (1 - f)\sum_{j=1}^N \sigma_j\sigma_{j+1}^{\dagger}e^{i\theta} + h.c.\]</span> ä¼—æ‰€å‘¨çŸ¥ï¼Œè¿™ä¸ªæ¨¡å‹ï¼š - åœ¨æ²¡æœ‰æ‰‹æ€§çš„æƒ…å†µ(<span class="math inline">\(\theta=0\)</span>)ï¼Œæœ‰ä¸¤ä¸ªç›¸ï¼Œé“ç£ç›¸å’Œé¡ºç£ç›¸ã€‚ -åœ¨æœ‰æ‰‹æ€§çš„æƒ…å†µ(<span class="math inline">\(\theta &gt; 0\)</span>),åœ¨é“ç£å’Œé¡ºç£ä¹‹é—´ï¼Œè¿˜æœ‰ä¸€ä¸ªé¢å¤–çš„ç›¸IC(incommensurate phase,æˆ‘ä¹Ÿä¸çŸ¥é“ä¸­æ–‡æ˜¯å•¥)ã€‚è¿™ä¸ªä¸­é—´ç›¸ä¸åŒé“ç£å’Œé¡ºç£é‚£ä¹ˆå¥½åŒºåˆ†ã€‚å› ä¸ºå®ƒçš„è‡ªå‘ç£åŒ–å¼ºåº¦ä¹Ÿæ˜¯0ï¼Œå› æ­¤<span class="math inline">\(\sum_{j=1}^N \langle \sigma_j \rangle\)</span>ä½œä¸ºä¸€ä¸ªå®è§‚å¯è§‚æµ‹é‡ï¼Œä¸è¶³ä»¥åŒºåˆ†è¿™ä¸¤ç§ç›¸ã€‚</p><p>è¿™è¾¹ä½œè€…é€šè¿‡æµ‹é‡å“ˆå¯†é¡¿é‡å¯¹åº”çš„åŸºæ€å¯¹åº”çš„ç£åŒ–å¼ºåº¦ï¼Œå¾—åˆ°äº†ä¸€äº›æ•°æ®ç‚¹<span class="math inline">\(\vec{M}_i\)</span>ï¼Œç„¶åé€šè¿‡å¯¹è¿™äº›æ•°æ®ç‚¹ï¼Œä½¿ç”¨<code>DMM</code>åšèšç±»åˆ†æï¼Œç”»å‡ºäº†ä¸åŒçš„å‚æ•°<span class="math inline">\(f,\theta\)</span>ä¸‹é¢ï¼Œå¯¹åº”çš„èšç±»æ•°ç›®å¯†åº¦å›¾ï¼ŒæƒŠå–œåœ°å‘ç°ï¼ˆå¦‚å›¾ï¼‰ï¼š<img src="/2022/07/03/diffusion_map/prl2.png" class="" title="This is an image"> - é€‰æ‹©ä¸åŒçš„<span class="math inline">\(\epsilon\)</span>å¯ä»¥å¾—åˆ°ä¸åŒçš„ç›¸å›¾ - é€‰æ‹©åˆé€‚çš„<span class="math inline">\(\epsilon\)</span>ï¼Œå¯ä»¥å¾ˆå¥½æ ¹æ®èšç±»çš„æ•°ç›®ï¼ŒåŒºåˆ†å‡ºæ¥ä¸‰ç§ç›¸ï¼Œå’Œç‰©ç†çš„ç»“æœå»åˆã€‚</p><h2 id="dmmæ•°å­¦ç®€åŒ–">DMMæ•°å­¦ç®€åŒ–</h2><p>å¯¹äºç»™å®šçš„ä¸€ä¸ªæ ¸çŸ©é˜µ<span class="math inline">\(K\)</span>ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°è½¬ç§»çŸ©é˜µ<span class="math inline">\(P=D^{-1}K\)</span>ï¼Œæ­£å¦‚ä¹‹å‰è¯´çš„ã€‚æ˜¾ç„¶ï¼Œ<span class="math inline">\(P\)</span>åœ¨å¤§éƒ¨åˆ†çš„æƒ…å†µä¸‹ï¼Œéƒ½ä¸æ˜¯ä¸€ä¸ªå®å¯¹ç§°çš„çŸ©é˜µï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç®€å•çš„è½¬åŒ–ï¼Œåˆ†æ<span class="math inline">\(Q =D^{-\frac{1}{2}}KD^{-\frac{1}{2}}\)</span>æ¥æ¢ç´¢<span class="math inline">\(P\)</span>çš„ä¸€äº›æ€§è´¨ã€‚å¾ˆæ˜¾ç„¶ï¼Œ</p><ul><li><span class="math inline">\(P\)</span>å’Œ<span class="math inline">\(Q\)</span>æ˜¯ä¸€å¯¹ç›¸ä¼¼çŸ©é˜µ</li><li><span class="math inline">\(Q\)</span>æ˜¯å®å¯¹ç§°çš„</li></ul><p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°åœ¨å®æ•°åŸŸå†…ï¼Œå¯¹<span class="math inline">\(Q\)</span>åšå¯¹è§’åŒ–ï¼Œå¾—åˆ°å…¶å¯¹åº”çš„ç‰¹å¾å€¼<span class="math inline">\(1=\lambda_0\ge \lambda_i \ge \cdots \ge\lambda_{N-1} \ge 0\)</span> å’Œå¯¹åº”çš„ç‰¹å¾å‘é‡<span class="math inline">\(v_0, v_1, \cdots,v_{N-1}\)</span>ã€‚é‚£ä¹ˆæˆ‘ä»¬å¾ˆå®¹æ˜“å‘ç°<span class="math inline">\(P\)</span>çŸ©é˜µçš„å³ç‰¹å¾å‘é‡ä¸º<span class="math inline">\(u_0:=D^{-\frac{1}{2}}v_0,u_1:=D^{-\frac{1}{2}}v_1, \cdots\)</span> å’Œ å·¦ç‰¹å¾å‘é‡ <span class="math inline">\(w_0 := D^{\frac{1}{2}}v_0, w_1 =D^{\frac{1}{2}}v_1, \cdots\)</span>ã€‚é‚£ä¹ˆ<span class="math inline">\(P\)</span>çš„è°±åˆ†è§£å¯ä»¥å†™æˆï¼š <span class="math display">\[P = \sum_{j=0}^{N-1}\lambda_j u_j w_j^T\]</span> åŒæ—¶<span class="math inline">\(t\)</span>-stepçš„è½¬ç§»çŸ©é˜µå¯ä»¥å†™æˆ: <span class="math display">\[P^t = \sum_{j=0}^{N-1}\lambda_j^t u_j w_j^T\]</span> é‚£ä¹ˆåœ¨<span class="math inline">\(\{w_j\}_{j=1}^{N-1}\)</span>æ„æˆçš„åæ ‡ç³»ä¸‹é¢ï¼Œç¬¬<span class="math inline">\(i\)</span>ç»„æ•°æ®çš„è¡¨è¾¾å°±æ˜¯<span class="math inline">\((\lambda_0^t u_0(i), \lambda_1^t u_1(i), \cdots,\lambda_{N-1}^t u_{N-1}(i))\)</span>ã€‚ä½¿ç”¨è€…å¯ä»¥æ ¹æ®éœ€æ±‚å¯¹<span class="math inline">\(0\)</span>åˆ°<span class="math inline">\(N-1\)</span>ä¹‹é—´çš„dimensioné€‰æ‹©é€‚åˆçš„ç»´åº¦è¿›è¡Œï¼Œç„¶ååšæ•°æ®é™ç»´ã€‚</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> äººå·¥æ™ºèƒ½ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é‡å­ç‰©ç†ï¼Œæœºå™¨å­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å› æœåˆ†æ</title>
      <link href="/2022/05/01/nonlinear_analysis/"/>
      <url>/2022/05/01/nonlinear_analysis/</url>
      
        <content type="html"><![CDATA[<h1 id="éçº¿æ€§å› æœåˆ†ææŠ€æœ¯">éçº¿æ€§å› æœåˆ†ææŠ€æœ¯</h1><p>åœ¨åŸºç¡€çš„ç»Ÿè®¡å­¦ä¸­ï¼Œæˆ‘ä»¬å­¦è¿‡ç”¨åæ–¹å·®çŸ©é˜µæ¥è¡¨å¾ä¸¤ä¸ªé«˜ç»´éšæœºå˜é‡<span class="math inline">\(X=(X_1,X_2,\cdots,X_n)^T, Y=(Y_1,Y_2,\cdots,Y_m)^T\)</span>ä¹‹é—´çš„ç›¸å…³æ€§ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬çŸ¥é“ç›¸å…³æ€§å¹¶ä¸æ„å‘³ç€ç‹¬ç«‹æ€§ï¼Œæ›´åŠ ä¸èƒ½å‡†ç¡®æè¿°å› æœæ€§ã€‚è¿™ç¯‡Blogï¼Œæˆ‘ä»¬å°†æŒç»­æ›´æ–°ä¸€äº›å› æœæ€§åˆ†æå·¥å…·ã€‚<a id="more"></a></p><h2 id="granger-causalityg-causality">GrangerCausality(G-causality)</h2><p>æ‰€è°“çš„G-causalityçš„æƒ³æ³•å…¶å®éå¸¸çš„ç®€å•çš„ï¼Œå°±æ˜¯ç‰©ç†å­¦ä¸­å¸¸è¯´çš„æ§åˆ¶å˜é‡æ³•ã€‚</p><blockquote><p>Definition å‡è®¾æˆ‘ä»¬æ‹¥æœ‰ä¸‰ä¸ªéšæœºè¿‡ç¨‹<span class="math inline">\(X_t,Y_t, Z_t\)</span>, å¹¶ä¸”æˆ‘ä»¬å°†å…¶å„è‡ªçš„realization trajectoryæ ‡è®°ä¸º<span class="math inline">\(X^t, Y^t, Z^t\)</span>, å¯¹äºç»™å®šçš„ä¸€ä¸ªåº¦é‡<span class="math inline">\(g\)</span>, å’Œæ‹Ÿåˆç®—å­<span class="math inline">\(f_1, f_2\)</span>, æˆ‘ä»¬å¾ˆå®¹æ˜“å®šä¹‰å¯¹åº”çš„è¯¯å·®: <span class="math display">\[\mathcal{R}(Y^{t+1}| Y^t, Z^t) = g(Y_{t+1}, f_1(Y^t, Z^t)) \\\mathcal{R}(Y^{t+1}| Y^t, X^t, Z^t) = g(Y_{t+1}, f_1(Y^t, X^t, Z^t))\]</span></p></blockquote><p>ç„¶åæˆ‘ä»¬æ£€éªŒæ–¹æ³•ï¼Œæ£€éªŒä¸¤ä¸ªæ®‹å·®æœ‰æ²¡æœ‰æ˜¾è‘—çš„å·®å¼‚ï¼Œæ¥è¡¨æ˜<span class="math inline">\(X\)</span>å’Œ<span class="math inline">\(Y\)</span>æœ‰æ²¡æœ‰æ˜¾è‘—çš„å› æœå…³ç³»ã€‚</p><p>å½“ç„¶æˆ‘ä»¬éœ€è¦æ³¨æ„çš„æ˜¯:</p><ul><li>æ•´ä¸ªæµç¨‹ä¸æ˜¯å®Œå…¨å‡†ç¡®çš„ï¼Œå› ä¸ºé€‰æ‹©çš„æ‹Ÿåˆç®—å­<span class="math inline">\(f_1,f_2\)</span>æ˜¯éå¸¸å…³é”®ã€‚åœ¨æœ€ç†æƒ³çš„æƒ…å†µä¸‹ï¼Œå…¶å®æˆ‘ä»¬è¿˜éœ€è¦å¯¹æ•´ä¸ª<span class="math inline">\(f\)</span>-space å»åšä¸€è½®ä¼˜åŒ–æ‰æ˜¯ã€‚</li><li>å¦‚æœ<span class="math inline">\(f_1,f_2\)</span>é€‰æˆçº¿æ€§ç®—å­ï¼Œæ•´ä¸ªæµç¨‹å’Œè‡ªå›å½’éå¸¸ç›¸è¿‘ã€‚è¯¥æ£€éªŒå¯ä»¥å’Œå¾ˆå¤šè‡ªå›å›½æŠ€æœ¯ç»“åˆèµ·æ¥ã€‚</li></ul><h2 id="transer-entropy">Transer Entropy</h2><p>é™¤äº†æ‹Ÿåˆæ•°æ®çš„è§’åº¦ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä»æ›´åŠ ç†è®ºçš„è§’åº¦å»åˆ†æéšæœºå˜é‡çš„å› æœæ€§ï¼Œå³ä»ä¸¤è€…å¯¹åº”çš„åˆ†å¸ƒæƒ…å†µ,è€Œä¸å†ä¾èµ–é¢å¤–ä»åˆ†å¸ƒåˆ°å®æ•°çš„æ˜ å°„æ„é€ çš„éšæœºå˜é‡ã€‚åœ¨ä¿¡æ¯è®ºé¢†åŸŸï¼Œentropyä½œä¸ºä¸€ä¸ªéå¸¸é‡è¦çš„ç»Ÿè®¡é‡æ¥è¡¡é‡åˆ†å¸ƒçš„æ€§è´¨ã€‚é‚£ä¹ˆæˆ‘ä»¬å¾ˆè‡ªç„¶åœ°ï¼Œæˆ‘ä»¬å°±å¯ä»¥æƒ³åˆ°æ¡ä»¶ç†µæ¥æè¿°å› æœæ€§çš„éƒ¨åˆ†ã€‚</p><blockquote><p>æ¡ä»¶ç†µ ç»™å®šä¸¤ä¸ªéšæœºå˜é‡<span class="math inline">\(X, Y\)</span>,<span class="math inline">\(Y\)</span>ä¹‹äº<span class="math inline">\(X\)</span>çš„æ¡ä»¶ç†µå¯ä»¥å®šä¹‰ä¸º <span class="math display">\[H(Y|X) = H(X,Y) - H(X)\]</span></p><p>å¯¹äºä¹‹å‰æ²¡æœ‰æ¥è§¦è¿‡ä¿¡æ¯è®ºçš„è¯»è€…ï¼Œè¿™è¾¹ç®€å•åœ°è§£é‡Šä¸€ä¸‹ç†µå’Œæ¡ä»¶ç†µçš„ç‰©ç†æ„ä¹‰ã€‚æ‰€è°“ç†µå³ä»£è¡¨è¯¥åˆ†å¸ƒå¯¹åº”çš„ä¸ç¡®å®šæ€§ã€‚å½“äººä»¬è®¨è®ºéšæœºçš„æ—¶å€™ï¼Œå¸¸å¸¸ç›´è§‰ä¼šå»æ„Ÿè§‰åˆ°æœ‰çš„éšæœºäº‹ä»¶æ²¡æœ‰é‚£ä¹ˆ"éšæœº"ï¼Œå¤§éƒ¨åˆ†æ—¶å€™ä½ èƒ½çŒœåˆ°ï¼Œä½†æ˜¯æœ‰çš„éšæœºäº‹ä»¶ï¼Œæ„Ÿè§‰å°±å¾ˆçœŸçš„å¾ˆâ€œéšæœºâ€ï¼Œå®Œå…¨æ²¡æœ‰å¤´ç»ªã€‚ç†µåˆ™æ˜¯é‡åŒ–ç›´è§‰ä¸Šæœ‰å¤šéšæœºçš„æ•°å­¦é‡ã€‚é‚£ä¹ˆæ¡ä»¶ç†µåˆæ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿå…¶å®å°±æ˜¯åœ¨ä½ ä»¬æ²¡å•¥ä¿¡æ¯çš„æ„Ÿè§‰<span class="math inline">\(Y\)</span>è¿™ä¸ªå˜é‡å¤§æ¦‚æœ‰<span class="math inline">\(H(Y)\)</span>è¿™ä¹ˆå¤šçš„ä¸ç¡®å®šæ€§ã€‚ä½†æ˜¯å¦‚æœä½ çŸ¥é“äº†<span class="math inline">\(X\)</span>çš„ä¿¡æ¯ä¹‹åï¼Œæœ‰å¯èƒ½å¯ä»¥å¸®åŠ©ä½ äº†è§£åˆ°<span class="math inline">\(Y\)</span>ï¼Œé‚£ä¹ˆä½ å¯¹<span class="math inline">\(Y\)</span>çš„ä¸ç¡®å®šæ€§å°±ä¼šæœ‰å¯èƒ½é™ä½ï¼Œé™ä½åˆ°å¤šå°‘å‘¢ï¼Œå°±æ˜¯<span class="math inline">\(H(Y|X)\)</span>.</p></blockquote><p>å½“ç„¶å¦‚æœ<span class="math inline">\(X\)</span>å’Œ<span class="math inline">\(Y\)</span>æ˜¯ç‹¬ç«‹çš„ï¼Œä»ä¸Šé¢çš„è§£é‡Šæˆ‘ä»¬å°±ä¼šæœŸæœ›<span class="math inline">\(H(Y|X)=H(Y)\)</span>ã€‚è¿™ç‚¹ä¹Ÿæ˜¯å¾ˆå¥½éªŒè¯çš„ã€‚</p><blockquote><p>è½¬ç§»ç†µ ç»™å®šä¸‰ä¸ªéšæœºè¿‡ç¨‹<span class="math inline">\(X_t,Y_t,Z_t\)</span>, æˆ‘ä»¬å®šä¹‰<span class="math inline">\(X\)</span>åˆ°<span class="math inline">\(Y\)</span>çš„è½¬ç§»ç†µä¸º <span class="math display">\[T(X \to Y) = H(Y_{t+1}|Y^t, Z^t) - H(Y_{t+1}|Y^t, X^t, Z^t)\]</span></p></blockquote><p>å½“ç„¶æœ‰äººä¸ºäº†ä¿è¯å¯¹ç§°æ€§ï¼Œä¹Ÿä¼šé‡‡ç”¨ä¸‹é¢çš„å®šä¹‰æ¥è¡¨ç¤ºä¿¡æ¯çš„å‡€æµå‡ºï¼Œ</p><blockquote><p>ä¿¡æ¯å‡€æµå‡º <span class="math display">\[\tilde{T}(X \to Y) = T(X \to Y) - T(Y \to X)\]</span></p></blockquote><h2 id="é™„å½•">é™„å½•</h2><h3 id="g-causalityå’Œè½¬ç§»ç†µçš„ç­‰ä»·æ€§">G-causalityå’Œè½¬ç§»ç†µçš„ç­‰ä»·æ€§</h3><p>æœ‰ä¸€ä¸ªéå¸¸æœ‰æ„æ€çš„ç»“æœï¼Œå°±æ˜¯åœ¨å‡è®¾<span class="math inline">\(X_t,Y_t\)</span>å‡æœä»å¤šå…ƒé«˜æ–¯åˆ†å¸ƒçš„æ¡ä»¶ä¸‹é¢ã€‚åœ¨2009å¹´çš„ä¸€ç¯‡<a href="https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.103.238701"><strong>PRL</strong></a>è¯æ˜äº†G-causalityå’Œè½¬ç§»ç†µçš„ç­‰ä»·æ€§ã€‚è¿™å°±æ˜¯å»ºç«‹æ•°å­¦æ‹Ÿåˆå’Œä¿¡æ¯è®ºä¹‹é—´çš„ä¸€äº›æ¡¥æ¢ï¼Œä¹Ÿå»ºç«‹äº†å®æ“(G-causalityæ›´åŠ å¥½å®ç°)å’Œç†è®º(è½¬ç§»ç†µå®ç°æ›´ä¸ºéº»çƒ¦ï¼Œè¦ä»æ•°æ®å»å¾—åˆ°åˆ†å¸ƒä¸æ˜¯é‚£ä¹ˆå¾—å®¹æ˜“)çš„å…³ç³»ã€‚</p><p>è¿™è¾¹ç®€è¦ä»‹ç»ä¸€äº›è¯æ˜çš„æ ¸å¿ƒå†…å®¹ã€‚ #### G-causality</p><p>ç»™å®šä¸¤ä¸ªéšæœºå˜é‡<span class="math inline">\(X,Y\)</span>, åˆ†åˆ«ä¸º<span class="math inline">\(n\)</span>å…ƒï¼Œ<span class="math inline">\(m\)</span>å…ƒï¼Œçº¿æ€§å›å½’çš„è¡¨è¾¾åˆ™æ˜¯ï¼Œ <span class="math display">\[Y = A X + b + \epsilon\]</span> è¿™è¾¹<span class="math inline">\(A\in R^{m\times n}, b \inR^{m}\)</span> ä¸ºçº¿å½¢æ‹Ÿåˆçš„å‚æ•°ï¼Œ<span class="math inline">\(\epsilon\)</span>ä¸ºæ®‹å·®é¡¹ã€‚å¦‚æœ<span class="math inline">\(X,Y\)</span>å‡æœä»é«˜æ–¯åˆ†å¸ƒçš„ï¼Œé‚£ä¹ˆä½¿ç”¨<span class="math inline">\(tr(\Sigma(\epsilon))\)</span>ä½œä¸ºæŸå¤±å‡½æ•°å»ä¼˜åŒ–ï¼Œåˆ™æ˜¯ç¬¦åˆMLEçš„ä¸€ç§ç®—æ³•ã€‚ä¹Ÿå°±æ˜¯æˆ‘ä»¬è¦ä¼˜åŒ–çš„æ˜¯ï¼Œ <span class="math display">\[\mathcal{L} = \mathbb{E}[(Y - AX - b)^T (Y -AX -b)]\]</span> å¯¹<span class="math inline">\(\mathcal{L}\)</span>æ±‚å¯¼ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ° <span class="math display">\[\frac{\partial \mathcal{L}}{\partial A} = -2\mathbb{E}[(Y-AX-b)X^T] \\\frac{\partial \mathcal{L}}{\partial b} = -2\mathbb{E}[Y-AX-b]\]</span> ä»¤å¯¼æ•°ç­‰äº<span class="math inline">\(0\)</span>ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°<span class="math inline">\(A,b\)</span>è§£åˆ†åˆ«ä¸º <span class="math display">\[A = \Sigma(Y,X)\Sigma(X,X)^{-1} \\b = \mathbb{E}[Y] - A\mathbb{E}[X]\]</span> é‚£ä¹ˆæˆ‘ä»¬å®¹æ˜“å¾—åˆ°ï¼Œ <span class="math display">\[\Sigma(\epsilon,\epsilon) = \mathbb{E}[(Y-AX-b)(Y-Ax-b)^T] \\= \Sigma(Y,Y) - A \Sigma(X,Y) \\= \Sigma(Y,Y) - \Sigma(Y,X)\Sigma(X,X)^{-1}\Sigma(X,Y)\]</span> ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬å°†æœ€åä¸€é¡¹ç®€è®°æˆ<span class="math inline">\(\Sigma(Y|X)\)</span>ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬å›åˆ°G-causalityçš„è®¨è®ºä¸Šé¢æ¥ï¼ŒåŒæ—¶è¿™è¾¹å°†<span class="math inline">\(f_1,f_2\)</span>é™åˆ¶æˆçº¿æ€§çš„æ‹Ÿåˆç®—å­ã€‚æ­£å¦‚å‰é¢æ‰€è¯´çš„ï¼ŒG-causalityå°±æ˜¯è¦æ¯”è¾ƒåŠ å…¥<span class="math inline">\(X^t\)</span>ä¹‹åï¼Œå¯¹äº<span class="math inline">\(Y^{t+1}\)</span>çš„æ‹Ÿåˆå¸¦æ¥äº†å¤šå°‘çš„å¢ç›Šã€‚é‚£ä¹ˆè¿™è¾¹æ–‡ç« ä½œè€…é‡‡ç”¨äº†å¯¹æ•°ratioçš„æ–¹æ³•æ¥æ¯”è¾ƒï¼Œ<span class="math display">\[\mathcal{G}(X \to Y) := \ln \frac{\det(\Sigma(Y^{t+1}|Y^t \oplusZ^t))}{\det(\Sigma(Y^{t+1}|Y^t \oplus X^t \oplus Z^t))}\]</span></p><h4 id="è½¬ç§»ç†µ">è½¬ç§»ç†µ</h4><p>è¿™éƒ¨åˆ†æˆ‘ä»¬è¦è¯æ˜çš„æ˜¯<span class="math inline">\(X\)</span>åˆ°<span class="math inline">\(Y\)</span>çš„è½¬ç§»ç†µ<span class="math inline">\(T(X\to Y)\)</span>ç­‰ä»·äºä¸Šé¢çš„<span class="math inline">\(\mathcal{G}(X \to Y)\)</span></p><p>ç»™å®šä¸€ä¸ªæœä»<span class="math inline">\(n,m\)</span>å…ƒé«˜æ–¯åˆ†å¸ƒçš„éšæœºå˜é‡<span class="math inline">\(X, Y\)</span>,æˆ‘ä»¬å¾ˆå®¹æ˜“è¯æ˜å…¶å¯¹åº”çš„ç†µçš„è¡¨è¾¾å¼å¦‚ä¸‹ï¼š <span class="math display">\[H(X) = \frac{1}{2}\ln \det(\Sigma(X)) + \frac{n}{2}\ln(2\pi e),\\H(X|Y) = H(X\oplus Y) - H(Y) = \frac{1}{2} \ln \frac{\det (\Sigma(X\oplus Y))}{\det \Sigma(Y)} + \frac{n}{2}\ln(2 \pi e)\]</span> åŒæ—¶ï¼Œ <span class="math display">\[\Sigma(X\oplus Y) = \left(\begin{matrix}\Sigma(X,X) &amp; \Sigma(X,Y) \\ \Sigma(Y,X) &amp; \Sigma(Y,Y)\\\end{matrix}\right)\]</span> å¯¹äº<span class="math inline">\(2\times2\)</span>çš„åˆ†å—çŸ©é˜µï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å…¶ç‰¹å¾å€¼ï¼Œå¾—åˆ° <span class="math display">\[\det\Sigma(X \oplus Y) = \det\Sigma(Y,Y)\det\Sigma(X|Y)\]</span></p><p>é‚£ä¹ˆå¯¹äºè½¬ç§»ç†µ, <span class="math display">\[T(X \to Y) = H(Y^{t+1}|Y^t, Z^t) - H(Y^{t+1}|Y^t, X^t, Z^t) \\= \frac{1}{2} \mathcal{G}(X \to Y)\]</span></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> äººå·¥æ™ºèƒ½ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æœºå™¨å­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€Šå¤§è¡°é€€è¯»ä¹¦ç¬”è®°ã€‹</title>
      <link href="/2022/03/20/%E5%A4%A7%E8%A1%B0%E9%80%80/"/>
      <url>/2022/03/20/%E5%A4%A7%E8%A1%B0%E9%80%80/</url>
      
        <content type="html"><![CDATA[<h1 id="å¤§è¡°é€€">å¤§è¡°é€€</h1><p>è¿™æœ¬ä¹¦ä¸»è¦ä»èµ„äº§è´Ÿå€ºè¡¨è¡°é€€çš„è§’åº¦æ¥åˆ†ææ—¥æœ¬æ¶ˆå¤±çš„20å¹´ã€‚åŒæ—¶ä½œè€…ä¹Ÿåˆ©ç”¨èµ„äº§è´Ÿå€ºè¡¨è¡°é€€çš„æ¦‚å¿µæ¥é‡æ–°è¯ é‡Š<strong>æµåŠ¨æ€§é™·é˜±</strong><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> <a id="more"></a></p><h2 id="ä¸ªäººæ„Ÿæ‚Ÿ">ä¸ªäººæ„Ÿæ‚Ÿ</h2><h3 id="ä»€ä¹ˆæ˜¯èµ„äº§è´Ÿå€ºè¡¨è¡°é€€">ä»€ä¹ˆæ˜¯èµ„äº§è´Ÿå€ºè¡¨è¡°é€€</h3>èµ„äº§è´Ÿå€ºè¡¨è¡°é€€ï¼Œé€šå¸¸æ˜¯æŒ‡ï¼Œç”±äºå„ç±»èµ„äº§ä»·æ ¼<strong>æš´è·Œ</strong>ï¼Œå¯¼è‡´ç§è¥ä¼ä¸šä»æ‰©å¤§ç»è¥è§„æ¨¡ï¼Œæ‰©å¤§åˆ©æ¶¦æ¥æºç­‰ç­‰åŸå§‹çš„çš„ç›®çš„ï¼Œè½¬åŒ–ä»¥é™ä½ä¼ä¸šè´Ÿå€ºä¸ºç›®çš„ï¼Œä»è€Œå¯¼è‡´ä¼ä¸šçš„èµ„é‡‘éœ€æ±‚ä¸è¶³ï¼Œè¿›è€Œå¯¼è‡´é€šè´§ç´§ç¼©å½¢å¼çš„ç»æµè¡°é€€ã€‚<pre class="mermaid">graph TD;G1[èµ„äº§ä»·æ ¼æš´è·Œ] --ç¤¾ä¼šæ–‡åŒ–è¿˜æ˜¯ä»€ä¹ˆæ·±å±‚åŸå›  --&gt; G2[ä¼ä¸šé™ä½è´Ÿå€º];G2 --èµ„é‡‘æµå‘é“¶è¡Œ --&gt; G3[é€šè´§ç´§ç¼©];G3 --&gt; G4[ç»æµè¡°é€€];</pre><p>è¿™æ•´ä¸ªæµç¨‹è¿˜æ˜¯æœ‰ä¸€äº›å€¼å¾—å•†æ¦·çš„åœ°æ–¹ã€‚</p><ul><li>èµ„äº§ä»·æ ¼æš´è·Œ --&gt; èµ„äº§è´Ÿå€ºè¡¨çš„éš¾çœ‹ --&gt;ä¼ä¸šå¼€å§‹å¿å€ºã€‚ä½œè€…è®¤ä¸ºè¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œè´§å¸æ”¿ç­–å·²ç»å¤±æ•ˆï¼Œä½†æ˜¯ä½œä¸ºä¸€ä¸ªä¼ä¸šç»è¥è€…ï¼Œé¢å¯¹ä½æˆæœ¬ï¼ˆä½åˆ©ç‡ï¼‰çš„èµ„é‡‘ï¼Œå¦‚æœä¼ä¸šæœ¬èº«ç›ˆåˆ©æ¨¡å¼æ²¡æœ‰å‡ºç°é—®é¢˜ï¼Œé‚£å®Œå…¨å¯ä»¥é€šè¿‡ï¼šå€Ÿè´· --&gt; æ‰©å¤§ç”Ÿäº§ --&gt; æ›´å¤šçš„åˆ©æ¶¦ --&gt; è´­ç½®æ›´å¤šçš„èµ„äº§ï¼Œè¿™å¥—æµç¨‹æ¥è§£å†³èµ„äº§è´Ÿå€ºè¡¨çš„é—®é¢˜ã€‚<strong>åˆ°åº•æ˜¯ä»€ä¹ˆå› ç´ å¯¼è‡´äº†å¤§éƒ¨åˆ†çš„æ—¥æœ¬ä¼ä¸šé€‰æ‹©äº†ï¼Œä»¥é™ä½è´Ÿå€ºæ¥è§£å†³èµ„äº§è´Ÿå€ºè¡¨çš„é—®é¢˜</strong></li></ul><h3 id="èµ„äº§è´Ÿå€ºè¡¨è¡°é€€æ˜¯æ—¥æœ¬ç»æµè¡°é€€çš„ä½è¯">èµ„äº§è´Ÿå€ºè¡¨è¡°é€€æ˜¯æ—¥æœ¬ç»æµè¡°é€€çš„ä½è¯</h3><ul><li>ä¸æ˜¯ç»“æ„æ€§çš„é—®é¢˜ï¼šå› ä¸ºæ—¥æœ¬æ²¡æœ‰ç»“æ„æ€§é—®é¢˜å¸¦æ¥çš„ç§ç§å¼Šç«¯ï¼šä¾‹å¦‚ï¼Œå·¥äººç½¢å·¥ï¼Œå·¨é¢è´¸æ˜“é€†å·®ï¼Œè´§å¸è´¬å€¼ã€‚<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></li><li>æ•°æ®ä½è¯äº†ï¼Œä¼ä¸šå¯¹èµ„é‡‘çš„éœ€æ±‚ç¡®å®åœ¨é™ä½ï¼Œè€Œä¸”å¹¶éç”±äºé“¶è¡Œé‡‡å–äº†ä¿¡è´·ç´§ç¼©æ”¿ç­–ã€‚</li></ul><h3 id="èµ„äº§è´Ÿå€ºè¡¨è¡°é€€èƒŒæ™¯ä¸‹å„ä¸ªç»„ä»¶çš„å…³ç³»">èµ„äº§è´Ÿå€ºè¡¨è¡°é€€èƒŒæ™¯ä¸‹ï¼Œå„ä¸ªç»„ä»¶çš„å…³ç³»</h3><pre class="mermaid">graph LRA1[ä¼ä¸š]--éœ€æ±‚é™ä½--&gt;B1A1 -- å¿å€º --&gt; B1A1 -- å¿å€º --&gt; C4subgraph Bank[é“¶è¡Œ]    B1[èµ„é‡‘é—²ç½®]endsubgraph Gov[è´¢æ”¿]    C1[è´¢æ”¿æ”¯å‡ºå¢åŠ ]    C2[è´¢æ”¿æ”¶å…¥å‡å°‘]    C4[é™ä½ç¨æ”¶]    C4 --&gt; C2 --&gt; C8[è´¢æ”¿èµ¤å­—]    C6[å›½å€º]    C6 --&gt; C1 --&gt; C8endsubgraph Center[è´§å¸]    D1[åˆ©ç‡é™ä½]endB1 -- ä¿ƒè¿›èµ„é‡‘éœ€æ±‚ --&gt; D1B1 -- ç¼“è§£é€šè´§ç´§ç¼© --&gt; C6</pre><ul><li>å¦‚æœèµ„äº§è´Ÿå€ºå¤§å¹…åº¦è¡°é€€ï¼Œè´§å¸æ”¿ç­–å¤±æ•ˆï¼Œåªå‰©ä¸‹è´¢æ”¿è¿™ä¸ªæ‰‹æ®µæ¥è°ƒæ§ï¼Œæ”¿åºœæ­¤åˆ»åº”è¯¥æœç»è´¢æ”¿æ•´é¡¿ã€‚</li><li>æ±‡ç‡æ”¿ç­–ï¼Œé™ä½æ±‡ç‡ï¼Œå¯¹äºè´¸æ˜“é€†å·®çš„å›½å®¶å¯ä»¥åœ¨ç¼“è§£èµ„äº§è´Ÿå€ºè¡°é€€ã€‚<ul><li>åœ¨ä¸€ä¸ªç»æµæ­£å¸¸çš„ä¸–ç•Œé‡Œï¼Œå¸‚åœºå¯ä»¥å¦‚æ­¤è°ƒèŠ‚æ±‡ç‡çš„å¹³è¡¡ã€‚<code>é™ä½æ±‡ç‡</code>--&gt;<code>å‡ºå£å¢åŠ </code>--&gt;<code>åˆºæ¿€å›½å†…ç»æµ</code>--&gt;<code>è¿›å£å¢åŠ </code>--&gt;<code>è´¸æ˜“å¹³è¡¡</code>ã€‚</li><li>åœ¨èµ„äº§è´Ÿå€ºè¡¨è¡°é€€çš„ä¸–ç•Œé‡Œï¼Œæ±‡ç‡é™ä½çš„å½±å“å¦‚ä¸‹ï¼Œ<code>é™ä½æ±‡ç‡</code>--&gt;<code>å‡ºå£å¢åŠ </code>--&gt;<code>åˆºæ¿€å›½å†…ç»æµ</code>--&gt;<code>ä¼ä¸šèµšæ¥çš„åˆ©æ¶¦å»è¿˜å€º</code></li><li>å› æ­¤åœ¨èµ„äº§è´Ÿå€ºè¡¨è¡°é€€çš„ä¸–ç•Œé‡Œï¼Œè´¸æ˜“é¡ºå·®çš„å›½å®¶ï¼Œé™ä½ä¼šä½¿å¾—è´¸æ˜“é¡ºå·®è¿›ä¸€æ­¥æ‰©å¤§ï¼Œè¿™ä¼šå¯¼è‡´å…¶ä»–å›½å®¶ï¼Œé‡‡å–å¯¹åº”çš„æ±‡ç‡æ”¿ç­–ï¼Œä»¥é˜»æ­¢è¯¥å›½çš„æ±‡ç‡çš„é™ä½ã€‚ä½†æ˜¯å¯¹äºè´¸æ˜“é€†å·®çš„å›½å®¶ï¼Œåªä¼šé™ä½è´¸æ˜“é€†å·®ï¼Œä¸ä¼šå¯¼è‡´å¤–ç•Œå¯¹å…¶æœ‰å¾ˆæ˜æ˜¾çš„åå‘æ“ä½œã€‚</li></ul></li></ul><h3 id="é˜´é˜³å‘¨æœŸç†è®º">é˜´é˜³å‘¨æœŸç†è®º</h3><pre class="mermaid">graph LRsubgraph Neg[é˜´å‘¨æœŸ]    N1[æ”¶ç´§è´§å¸æ³¡æ²«ç ´ç­]    N1 --&gt; N2[èµ„äº§è´Ÿå€ºè¡¨è¡°é€€]    N2 --&gt; N3[è´Ÿå€ºæœ€å°åŒ–+è´¢æ”¿æ”¿ç­–]    N3 --&gt; N4[å®Œæˆå¿å€º-åˆ©ä¾ç„¶ä½è¿·]endsubgraph Pos[é˜³å‘¨æœŸ]    P1[èµ„é‡‘éœ€æ±‚å¤å…´]    P1 --&gt; P2[è½¬ä¸ºè´§å¸æ”¿ç­–]    P2 --&gt; P3[ç§è¥ä¼ä¸šå……æ»¡æ´»åŠ›]    P3 --&gt; P4[ç§è¥ä¼ä¸šè¿‡æ¸¡è‡ªä¿¡]endM1[æ³¡æ²«] --&gt; N1M2[å€ºåŠ¡æŠµè§¦ç»¼åˆå¾] --&gt; P1N4 --&gt; M2P4 --&gt; M1</pre><p>åœ¨é˜´é˜³å‘¨æœŸç†è®ºä¸­éœ€è¦æ³¨æ„çš„ï¼š</p><ul><li>é˜´å‘¨æœŸï¼Œå¹¶ä¸ä¸€å®šæ„å‘³æ€»çš„ç»æµä¸‹è¡Œï¼Œä½†æ˜¯ç§è¥ä¼ä¸šçš„ç»æµæ´»åŠ¨è‚¯å®šæ¯”è¾ƒèé¡ã€‚</li><li><code>å¤§å‘¨æœŸ</code>å’Œ<code>å°å‘¨æœŸ</code>çš„è½®è½¬ã€‚</li><li>é˜´é˜³å‘¨æœŸæœ€ä¸»è¦çš„åŒºåˆ«åœ¨äº<code>ç§è¥ä¼ä¸šçš„çš„è´¢åŠ¡çŠ¶å†µ</code></li></ul><p><strong>æ‰€è°“çš„å®è§‚ç»æµå­¦æ–°çš„åœ£ç»</strong> é˜³å‘¨æœŸï¼š</p><ul><li>æ–°å¤å…¸ä¸»ä¹‰</li><li>è´§å¸ä¸»ä¹‰</li><li>å‡¯æ©æ–¯ä¸»ä¹‰</li><li>æ–°å‡¯æ©æ–¯ä¸»ä¹‰</li></ul><p>é˜´å‘¨æœŸï¼š</p><ul><li>èµ„äº§è´Ÿå€ºè¡¨è¡°é€€ç†è®º</li></ul><table><thead><tr class="header"><th></th><th>é˜³çš„ä¸–ç•Œ</th><th>é˜´çš„ä¸–ç•Œ</th></tr></thead><tbody><tr class="odd"><td>ç°è±¡</td><td>æ•™ç§‘ä¹¦çš„ç»æµå­¦</td><td>èµ„äº§è´Ÿå€ºè¡¨è¡°é€€</td></tr><tr class="even"><td>æ³•åˆ™</td><td>äºšå½“æ–¯å¯†çš„â€œçœ‹ä¸è§çš„æ‰‹â€</td><td>åˆæˆè°¬è¯¯<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></td></tr><tr class="odd"><td>ä¼ä¸šè´¢åŠ¡</td><td>èµ„äº§&gt;è´Ÿå€º</td><td>èµ„äº§&lt;è´Ÿå€º</td></tr><tr class="even"><td>è¡ŒåŠ¨åŸç†</td><td>åˆ©æ¶¦æœ€å¤§åŒ–</td><td>è´Ÿå€ºæœ€å°åŒ–</td></tr><tr class="odd"><td>ç»“æœ</td><td>æœ€å¤§å¤šæ•°çš„å¹¸ç¦</td><td>ç½®ä¹‹ä¸ç†åˆ™å°†å¯¼è‡´è§æ¡</td></tr><tr class="even"><td>è´§å¸æ”¿ç­–</td><td>æœ‰æ•ˆ</td><td>æ— æ•ˆ(æµåŠ¨æ€§é™·é˜±)</td></tr><tr class="odd"><td>è´¢æ”¿æ”¿ç­–</td><td>è´Ÿæ•ˆåº”(æŒ¤å‡ºæ•ˆåº”)</td><td>æœ‰æ•ˆ</td></tr><tr class="even"><td>ç‰©ä»·</td><td>é€šè´§è†¨èƒ€</td><td>é€šè´§ç´§ç¼©</td></tr><tr class="odd"><td>åˆ©ç‡</td><td>æ­£å¸¸</td><td>æä½</td></tr><tr class="even"><td>å‚¨è“„</td><td>ç¾å¾·</td><td>æ¶å¾³</td></tr><tr class="odd"><td>é“¶è¡Œå±æœºå¯¹ç­–</td><td>ä¼˜æƒ å’Œè¿…é€Ÿå¤„ç†ä¸è‰¯è´·æ¬¾</td><td>èµ„æœ¬æ³¨å…¥å’Œè°¨æ…å¤„ç†ä¸è‰¯è´·æ¬¾</td></tr></tbody></table><h3 id="å‡ ä¸ªæœ‰æ„æ€çš„è§‚ç‚¹">å‡ ä¸ªæœ‰æ„æ€çš„è§‚ç‚¹</h3><ul><li>å®šé‡å®½æ¾æ”¿ç­–çš„è§£é™¤ä¸ç­‰äºé‡‘èç´§ç¼©æ”¿ç­–<ul><li>å¤®è¡Œå‘å•†ä¸šé“¶è¡Œå‡ºå”®å›½å€ºï¼Œæ¸…é™¤æµåŠ¨æ€§ï¼Œåœ¨ä¸€èˆ¬çš„æƒ…å†µä¸‹ï¼Œå› ä¸ºå•†ä¸šé“¶è¡Œï¼Œæ²¡æœ‰ç”¨æ¥è´­ä¹°å›½å€ºçš„é—²ç½®èµ„é‡‘ï¼Œæ‰€ä»¥æŠ›å”®é‡‘èèµ„äº§ï¼Œå¯¼è‡´é‡‘èèµ„äº§ä»·æ ¼é™ä½ï¼Œç»æµçƒ­åº¦ä¸‹é™ï¼Œé‡‘èè¶‹äºç´§ç¼©ã€‚ä½†æ˜¯åœ¨èµ„äº§è´Ÿå€ºè¡¨æœŸé—´ï¼Œå•†ä¸šé“¶è¡Œæœ‰è¶³å¤Ÿçš„é—²ç½®èµ„é‡‘æ¥ï¼Œè´­ä¹°å›½å€ºï¼Œä¸å¤Ÿæˆé‡‘èç´§ç¼©ã€‚</li></ul></li><li>è´¢æ”¿èµ¤å­—å’ŒGDPçš„æ¯”ç‡æ²¡æœ‰å¢é•¿å¹¶ä¸èƒ½è¯´æ˜è´¢æ”¿æ”¿ç­–çš„å¤±æ•ˆã€‚å› ä¸ºæœ‰ä¸¤ç§æƒ…å†µï¼Œç¬¬ä¸€ç§ï¼Œå°±æ˜¯è´¢æ”¿æ”¯å‡ºå’Œç¨æ”¶ç¡®å®æ²¡æœ‰å¤§å¹…åº¦å˜åŒ–ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œè´¢æ”¿æ”¿ç­–å½±å“ç”šå¾®ï¼›ç¬¬äºŒç§ï¼Œè´¢æ”¿æ”¯å‡ºå¢åŠ ï¼Œåˆºæ¿€äº†ç»æµå¢é•¿ï¼Œå› è€Œç¨æ”¶ä¹ŸåŒæ­¥å¢åŠ ï¼Œæ‰€ä»¥èµ¤å­—æ¯”ç‡æ²¡æœ‰æ”¹å˜ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‰©å¼ çš„çš„è´¢æ”¿æ”¿ç­–æ˜æ˜¾èµ·åˆ°äº†å¾ˆå¤§çš„ä½œç”¨ã€‚</li><li></li></ul><pre class="mermaid">graph LRA1[ç»æµè¡°é€€] --&gt; A2[ç»æµå‘¨æœŸé€ æˆçš„è¡°é€€] --&gt; B1[è´§å¸æ”¿ç­–]A1 --&gt; A3[èµ„äº§è´Ÿå€ºè¡¨è¡°é€€] --&gt; B2[è´¢æ”¿æ”¿ç­–]</pre><ul><li>æ³¡æ²«ä¹‹æ‰€ä»¥æˆä¸ºæ³¡æ²«ï¼Œå°±æ˜¯å› ä¸ºèµ„äº§ä»·æ ¼æ°´å¹³å†ä¹Ÿæ— æ³•é€šè¿‡ç°é‡‘æµé‡æŠ˜ç°æ³•æ¥åˆ¤æ–­ã€‚</li></ul><h2 id="æ‘˜è¦">æ‘˜è¦</h2><ul><li>ç¦äº•ä¿Šå½¦ï¼šåªæœ‰ç­‰åˆ°ç§è¥éƒ¨é—¨çš„èµ„é‡‘éœ€æ±‚å˜å¾—æ›´åŠ å¼ºåŠ²ä¹‹åï¼Œæ”¿åºœçš„è´¢æ”¿æ”¹é©ä¸ä¹‹é…å¥—ï¼Œè¿™æ ·æ‰ä¸ä¼šå‡ºç°é—®é¢˜ã€‚</li><li>ä¼ ç»Ÿç»æµå­¦çš„å¤§å‰æå‡è®¾ï¼šå‡è®¾é‚£äº›å¯¼è‡´ç»æµè„±ç¦»æ­£å¸¸è½¨é“çš„å¤–éƒ¨å†²å‡»çš„æ€§è´¨å¹¶ä¸ååˆ†é‡è¦ï¼Œå› æ­¤ï¼Œå³ä½¿æ”¶åˆ°å¤–éƒ¨å†²å‡»ï¼Œå—å…¶å½±å“çš„ç»æµè¡Œä¸ºè€…çš„æ—¢å®šç›®æ ‡ä¹Ÿä¸ä¼šæ”¹å˜ã€‚èµ„äº§è´Ÿå€ºè¡¨è¡°é€€è¿™ä¸€æ¦‚å¿µä¸»å¼ ï¼Œç‰¹å®šçš„å¤–éƒ¨å†²å‡»ä¼šä»æ ¹æœ¬ä¸Šæ”¹å˜ä¼ä¸šå’Œä¸ªäººçš„è¡Œä¸ºç›®æ ‡ã€‚</li><li>ä¸­å¤®é“¶è¡Œç»å¯¹ä¸å¯ä»¥æ‰¿æ‹…è¿‡å¤šçš„é£é™©ï¼Œè¿™æ˜¯å› ä¸ºä»Šå¤©çš„è´§å¸å®Œå…¨æ˜¯ç”±ä¸­å¤®é“¶è¡Œçš„ä¿¡ç”¨æ¥æ‹…ä¿ï¼Œè€Œéé»„é‡‘å’Œç™½é“¶<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>ã€‚</li><li>åªè¦ä¸€ä¸ªå›½å®¶çš„ä¸­å¤®é“¶è¡Œèƒ½å¤Ÿæ­£å¸¸è¿ä½œï¼Œé‚£ä¹ˆæ— è®ºå†å¤§çš„æ”¿åºœé¢„ç®—èµ¤å­—ï¼Œå…¶å¯¼è‡´çš„é«˜åˆ©ç‡å’Œç§äººæŠ•èµ„æŒ¤å‡ºæ•ˆåº”çš„è´Ÿé¢å½±å“éƒ½æ˜¯æœ‰é™çš„ï¼Œä½†æ˜¯ä¸€æ—¦ä¸­å¤®é“¶è¡Œè¿«äºæ”¿åºœå‹åŠ›ï¼Œæ‰§è¡Œæœ‰æŸå…¬å…±ä¿¡èµ–çš„æ”¿ç­–ï¼Œåˆ™å¿…å°†æ‰¿å—ç¾éš¾æ€§çš„åæœã€‚</li><li>å‡¯æ©æ–¯ä¸»ä¹‰çš„é‡å¤§ç¼ºé™·ï¼š<ul><li>å®Œå…¨æ²¡æœ‰è€ƒè™‘èµ„äº§è´Ÿå€ºè¡¨çš„é—®é¢˜</li><li>å°†åˆ©ç‡è¿‡ä½å¯¼è‡´é‡‘èæ”¿ç­–å¤±çµç»å¯¹åœ°å½’å’äºï¼ŒæµåŠ¨æ€§åå¥½ä½¿å¾—å…¬ä¼—å°†èµ„é‡‘ä»å€ºåˆ¸è½¬ä¸ºç°é‡‘ï¼Œè€Œä¸è€ƒè™‘æµåŠ¨æ€§åå¥½ä¸­ï¼Œå€Ÿè´·æ–¹çš„éœ€æ±‚è½¬æ¢</li><li>æ²¡æœ‰è§£é‡Šå¯¹ç»æµå’Œèµ„äº§ä»·æ ¼å½±å“æ˜¾è‘—çš„è´§å¸æ”¿ç­–ä¸ºä»€ä¹ˆå¤±çµ ## æ•°æ®</li></ul></li><li>æŸ¥çœ‹å…¨ä½“é“¶è¡Œçš„èµ„äº§è´Ÿå€ºè¡¨ï¼Œå¯ä»¥å¾—åˆ°å„ç»„ä»¶çš„å€Ÿè´·ä¿¡æ¯ï¼Œä»¥åŠå…¨å›½èŒƒå›´çš„è´§å¸ä¾›åº”é‡ï¼Œè´§å¸ä¹˜æ•°ç­‰ç­‰æŒ‡æ ‡ã€‚</li><li>å­˜æ¬¾å‘¨è½¬ç‡åœ¨æŸç§ç¨‹åº¦ä¸Šå¯ä»¥è¡¡é‡èµ„äº§ä»·æ ¼çš„æ³¡æ²«å¤§å°ã€‚é€»è¾‘æ¥è‡ªäºï¼Œé‡‘èèµ„äº§è¿‡çƒ­çš„æ—¶å€™ï¼Œä¼šå¼•å‘æ°‘ä¼—çš„å¤§é‡äº¤æ˜“ã€‚</li></ul><h2 id="å»ºæ¨¡">å»ºæ¨¡</h2><ul><li>å€ºåŠ¡å’Œèµ„é‡‘éœ€æ±‚çš„çŸ›ç›¾<ul><li>å¯»æ‰¾ä¸€ä¸ªæ¨¡å‹æ¥æè¿°ï¼Œèµ„äº§ä¸‹è·Œçš„ç¨‹åº¦ä¸è¿˜å€ºçš„å…³ç³»ï¼Œä»¥æ­¤å¯»æ±‚é‡åŒ–èµ„äº§è´Ÿå€ºè¡¨è¡°é€€çš„ç¨‹åº¦ã€‚</li></ul></li></ul><h2 id="è„šæ³¨">è„šæ³¨</h2><aside id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr><ol><li id="fn1"><p>åˆ©ç‡ä½è‡³å€ºåˆ¸æ”¶ç›Šç­‰åŒäºè´§å¸ï¼Œèµ„é‡‘ä¾›åº”å¤§é‡å›¤ç§¯è´§å¸çš„è¡Œä¸ºã€‚<a href="#fnref1" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li><li id="fn2"><p>è´¸æ˜“é€†å·®--&gt;è´§å¸è´¬å€¼ï¼›è´¸æ˜“é¡ºå·®--&gt;è´§å¸å‡å€¼çš„åŸç†ï¼šå½“ä¸€ä¸ªå›½å®¶æœ‰å·¨å¤§è´¸æ˜“é€†å·®çš„æ—¶å€™ï¼Œå³è¿›å£é‡&gt;å‡ºå£é‡ã€‚è¿›å£ä¼ä¸šéœ€è¦å°†æœ¬å›½è´§å¸å…‘æˆå¤–å¸ç”¨æ¥è´­ä¹°ï¼Œå‡ºå£ä¼ä¸šä¼šå°†èµšæ¥çš„å¤–å¸æ¢æˆæœ¬å›½è´§å¸ï¼Œè¿›å£é‡å¤§çš„æ—¶å€™ï¼Œå¯¹å¤–å¸çš„éœ€æ±‚å°±ä¼šå¤§ï¼Œæ ¹æ®ä¾›ç»™éœ€è¦å…³ç³»ï¼Œå¯¹åº”çš„å¤–å¸å‡å€¼ï¼Œæœ¬å›½è´§å¸è´¬å€¼ã€‚<a href="#fnref2" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li><li id="fn3"><p>æ¯ä¸ªä¸ªä½“éƒ½åšå±€éƒ¨æ­£ç¡®çš„äº‹æƒ…ï¼Œä½†æ˜¯å…¨å±€çš„æ•ˆç›Šå´å› æ­¤é™ä½ã€‚<a href="#fnref3" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li><li id="fn4"><p>å¦‚æœä¸­å›½å¤®è¡Œè¿‡åˆ†è¶…å‘è´§å¸ï¼Œäººä»¬å¯¹å¤®è¡Œçš„ä¿¡ä»»æ˜¯ä¸æ˜¯å¹¶ä¸ä¼šåƒè¥¿æ–¹é‚£æ ·è¿…é€Ÿé™ä½ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¤®è¡Œçš„è¶…å‘è´§å¸ï¼Œå¹¶ä¸ä¼šåœ¨çŸ­æ—¶é—´å†…æå‡äººä»¬å¯¹äºé€šè´§è†¨èƒ€ç‡ä¸Šå‡çš„é¢„æœŸã€‚<a href="#fnref4" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li></ol></aside><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> æŠ•èµ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®è§‚æŠ•èµ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Start with Hexo</title>
      <link href="/2022/03/19/start-with-hexo/"/>
      <url>/2022/03/19/start-with-hexo/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¾èµ–ç¯å¢ƒå‡†å¤‡">ä¾èµ–ç¯å¢ƒå‡†å¤‡</h1><h2 id="node.jså®‰è£…"><code>Node.js</code>å®‰è£…</h2><p><code>Hexo</code>æ˜¯åŸºäº<code>Node.js</code>å®‰è£…çš„ï¼Œå› æ­¤éœ€è¦å…ˆå®‰è£…<code>Node.js</code>,å®‰è£…åœ°å€ä¸º <a href="https://nodejs.org/en/download/" target="_blank" rel="noopener">Node.js</a><a id="more"></a></p><p>å®‰è£…Node.jsä¼šåŒ…å«ç¯å¢ƒå˜é‡åŠnpmçš„å®‰è£…,å®‰è£…å®Œæˆåå¯ä»¥æ£€æŸ¥<code>Node.js</code>æ˜¯å¦å®‰è£…æˆåŠŸ </p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node -v</span><br></pre></td></tr></tbody></table></figure>æ£€æŸ¥npmæ˜¯å¦å®‰è£…æˆåŠŸ <figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm -v</span><br></pre></td></tr></tbody></table></figure> æ£€æµ‹æˆåŠŸåå°±å®‰è£…å®Œæˆäº†<p></p><h1 id="hexoå®‰è£…åŠåˆå§‹åŒ–"><code>Hexo</code>å®‰è£…åŠåˆå§‹åŒ–</h1><p><a href="https://hexo.io/zh-cn/">Hexo</a>æ˜¯æ­å»ºä¸ªäººç½‘ç«™çš„æ¡†æ¶ï¼Œå®‰è£…æ–¹å¼å¦‚ä¸‹</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## å®‰è£…hexo</span></span><br><span class="line">sudo npm install hexo-cli -g</span><br><span class="line"></span><br><span class="line"><span class="comment">## cdåˆ°å¸Œæœ›å»ºç«‹åšå®¢çš„æ–‡ä»¶å¤¹ç›®å½•ä¸‹, åˆå§‹åŒ–blogæ–‡ä»¶å¤¹</span></span><br><span class="line">hexo init blog</span><br><span class="line"><span class="built_in">cd</span> blog</span><br></pre></td></tr></tbody></table></figure><p></p><h1 id="hexoæœ¬åœ°ä½¿ç”¨"><code>Hexo</code>æœ¬åœ°ä½¿ç”¨</h1><h2 id="hexoåŸºæœ¬ä½¿ç”¨å‘½ä»¤"><code>Hexo</code>åŸºæœ¬ä½¿ç”¨å‘½ä»¤</h2><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## æ–°å»ºä¸€ç¯‡åšå®¢</span></span><br><span class="line">hexo n my_first_site</span><br><span class="line"><span class="comment"># hexo new post --path filepath name  # æŒ‡å®šç”Ÿæˆmdçš„åœ°å€</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## ç”Ÿæˆé™æ€æ–‡ä»¶</span></span><br><span class="line">hexo g</span><br><span class="line"></span><br><span class="line"><span class="comment">## æœ¬åœ°è¿è¡Œserver</span></span><br><span class="line">hexo s</span><br><span class="line"></span><br><span class="line"><span class="comment">## æ¸…é™¤ç¼“å­˜</span></span><br><span class="line">hexo clean</span><br></pre></td></tr></tbody></table></figure><ul><li><p>è¿è¡Œå®Œ<code>hexo n my_first_site</code>åï¼Œå¯ä»¥åœ¨<code>blog/source/_posts</code>æ–‡ä»¶å¤¹ä¸‹å‘ç°å¤šäº†ä¸€ä¸ª<code>my_first_site.md</code>æ–‡ä»¶ï¼Œæ­¤æ–‡ä»¶å³æˆ‘ä»¬ç¼–è¾‘ç½‘é¡µå†…å®¹çš„ä¸»è¦æºæ–‡ä»¶</p></li><li><p>è¿è¡Œå®Œ<code>hexo s</code>ä¹‹åï¼Œterminalä¼šè¿”å›æˆ‘ä»¬æœ¬åœ°è®¿é—®çš„ç½‘å€ï¼Œå¯ä»¥åœ¨ä¸Šé¢æŸ¥çœ‹é¢„è§ˆæ ·å¼</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">INFO  Validating config</span><br><span class="line">INFO  Start processing</span><br><span class="line">INFO  Hexo is running at http://localhost:4000/ . Press Ctrl+C to stop.</span><br></pre></td></tr></tbody></table></figure><p></p></li></ul><h2 id="hexoä¸»é¢˜çš„é€‰æ‹©"><code>Hexo</code>ä¸»é¢˜çš„é€‰æ‹©</h2><h3 id="nextä¸»é¢˜"><code>Next</code>ä¸»é¢˜</h3><ol type="1"><li>ä¸‹è½½nextä¸»é¢˜ <figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## ä¸‹è½½nextä¸»é¢˜åˆ°blog/themes/ä¸‹</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/theme-next/hexo-theme-next themes/next</span><br></pre></td></tr></tbody></table></figure></li><li>ä¿®æ”¹Hexoé…ç½®æ–‡ä»¶ä½¿ä¸»é¢˜ç”Ÿæ•ˆï¼Œå°†<code>blog/_config.yml</code>æ–‡ä»¶ä¸­çš„<code>theme</code>è®¾å®šæˆ<code>next</code><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Extensions</span></span><br><span class="line"><span class="comment">## Plugins: https://hexo.io/plugins/</span></span><br><span class="line"><span class="comment">## Themes: https://hexo.io/themes/</span></span><br><span class="line">theme: next</span><br></pre></td></tr></tbody></table></figure></li></ol><p>å®Œæˆä¹‹åé‡æ–°è¿è¡Œ<code>Hexo g</code>ä»¥åŠ<code>Hexo s</code>å³å¯é¢„è§ˆéªŒè¯ä¸»é¢˜æ˜¯å¦ç”Ÿæ•ˆ</p><h1 id="hexo-çš„è¿œç¨‹éƒ¨ç½²"><code>Hexo</code> çš„è¿œç¨‹éƒ¨ç½²</h1><h2 id="github-åˆ›å»ºè‡ªå·±ç”¨æˆ·åçš„ä¸ªäººä»“åº“">githubåˆ›å»ºè‡ªå·±ç”¨æˆ·åçš„ä¸ªäººä»“åº“</h2><p>ref: <a href="https://snailwish.com/368/" target="_blank" rel="noopener">ä»é›¶å¼€å§‹ï¼Œä¸€æ­¥ä¸€æ­¥æ•™ä½ ç”¨Github å¿«é€Ÿæ­å»ºå…è´¹çš„ä¸ªäººä¸»é¡µ</a></p><h2 id="hexo-å’Œè¿œç¨‹gitä»“åº“ç»‘å®š"><code>Hexo</code> å’Œè¿œç¨‹gitä»“åº“ç»‘å®š</h2><p>å°†<code>blog/_config.yml</code>æ–‡ä»¶ä¸­çš„<code>deploy</code>è®¾å®šæˆæŒ‡å®šçš„è¿œç¨‹éƒ¨ç½²ç½‘é¡µå³å¯,å¦‚ä¸‹æ‰€ç¤º </p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/one-command-deployment</span></span><br><span class="line">deploy:</span><br><span class="line">  <span class="built_in">type</span>: git</span><br><span class="line">  repo: https://github.com/{username}/{username}.github.io</span><br><span class="line">  branch: master</span><br></pre></td></tr></tbody></table></figure><p></p><h2 id="hexo-åœ¨è¿œç¨‹ç½‘é¡µä¸Šéƒ¨ç½²"><code>Hexo</code> åœ¨è¿œç¨‹ç½‘é¡µä¸Šéƒ¨ç½²</h2><p>åœ¨ç”Ÿæˆå¥½é™æ€ç½‘é¡µä¹‹åï¼Œç›´æ¥è¿è¡Œå‘½ä»¤ </p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># éƒ¨ç½²ç½‘é¡µ</span></span><br><span class="line">Hexo d</span><br></pre></td></tr></tbody></table></figure><p></p><p>è¿™æ ·æœ€ç®€å•çš„ç½‘é¡µéƒ¨ç½²å°±å®Œæˆäº†ï¼Œåé¢åªéœ€è¦ä¿®æ”¹<code>blog/source/_posts/*.md</code>æ–‡ä»¶å³å¯ã€‚</p><h1 id="hexoé«˜çº§é…ç½®"><code>Hexo</code>é«˜çº§é…ç½®</h1><h2 id="ä¸€èˆ¬ä¸»é¢˜é…ç½®">ä¸€èˆ¬ä¸»é¢˜é…ç½®</h2><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## ä¿®æ”¹ä½œè€…, æ–‡ä»¶å: (/_config.yml)</span></span><br><span class="line">author: fishermanxx</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## ä¿®æ”¹æ ‡é¢˜ä¸‹æ–¹èœå•æ , æ·»åŠ tagä»¥åŠcategoryæ , æ–‡ä»¶å: (/themes/next/_config.yml)</span></span><br><span class="line"><span class="comment">##ï¼ˆå¦å¤–éœ€è¦æ–°å»ºä¸€ä¸ªtagsé¡µé¢å»å±•ç¤º, æ­¤æ—¶æœªç”Ÿæ•ˆ, detailè§ æ–‡ç« åˆ†ç±»/åˆ†ç±»å±•ç¤º ï¼‰</span></span><br><span class="line">menu:</span><br><span class="line">  home: / || fa fa-home</span><br><span class="line">  tags: /tags/ || fa fa-tags</span><br><span class="line">  categories: /categories/ || fa fa-th</span><br><span class="line">  archives: /archives/ || fa fa-archive</span><br><span class="line"></span><br><span class="line"><span class="comment">## æ·»åŠ æµè§ˆæ¬¡æ•°ç­‰ç»Ÿè®¡é‡</span></span><br><span class="line"><span class="comment">### Step1. ä¿®æ”¹/themes/next/_config.ymlæ–‡ä»¶ä¸­çš„busuanzi_count:</span></span><br><span class="line">busuanzi_count:</span><br><span class="line">  <span class="built_in">enable</span>: <span class="literal">true</span></span><br><span class="line">  total_visitors: <span class="literal">false</span></span><br><span class="line">  total_visitors_icon: fa fa-user</span><br><span class="line">  total_views: <span class="literal">false</span></span><br><span class="line">  total_views_icon: fa fa-eye</span><br><span class="line">  post_views: <span class="literal">true</span>  <span class="comment">## æ–‡ç« è®¿é—®é‡</span></span><br><span class="line">  post_views_icon: fa fa-eye</span><br><span class="line"><span class="comment">### Step2. ç»Ÿè®¡å­—æ•°ç­‰ï¼Œ å®‰è£…æ’ä»¶ï¼Œ bashè¿è¡Œ</span></span><br><span class="line">npm install hexo-symbols-count-time --save </span><br><span class="line"><span class="comment">### Step3. åœ¨/_config.ymlä¸­é…ç½®</span></span><br><span class="line">symbol_count_time:</span><br><span class="line">  symbols: <span class="literal">true</span>  <span class="comment"># æ˜¯å¦ç»Ÿè®¡å­—æ•°</span></span><br><span class="line">  time: <span class="literal">false</span>  <span class="comment"># æ˜¯å¦ç»Ÿè®¡é˜…è¯»æ—¶é•¿</span></span><br><span class="line">  total_symbols: <span class="literal">false</span>  <span class="comment">#æ€»å­—æ•°</span></span><br><span class="line">  total_time: <span class="literal">false</span>  <span class="comment">#æ€»æ—¶é•¿</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## æ·»åŠ æ–‡ç« ç»“æŸæ ‡å¿—</span></span><br><span class="line"><span class="comment">### Step1. åœ¨/themes/next/layout/_macro æ–°å»º passage-end_tag.swig, å¹¶æ·»åŠ ä¸€ä¸‹å†…å®¹</span></span><br><span class="line">&lt;div&gt;</span><br><span class="line">    {% <span class="keyword">if</span> not is_index %}</span><br><span class="line">        &lt;div style=<span class="string">"text-align:center;color: #ccc;font-size:14px;"</span>&gt;-------------------The END-------------------&lt;/div&gt;</span><br><span class="line">    {% endif %}</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"><span class="comment">### Step2. åœ¨/themes/next/layout/_macro/post.swigæ–‡ä»¶ä¸­ï¼Œåœ¨ END POST BODYä¹‹åè¾“å…¥</span></span><br><span class="line">&lt;div&gt;</span><br><span class="line">  {% <span class="keyword">if</span> not is_index %}</span><br><span class="line">      {% include <span class="string">'passage-end-tag.swig'</span> %}</span><br><span class="line">  {% endif %}</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"><span class="comment">### Step3. åœ¨/themes/next/_config.yml æœ«å°¾æ·»åŠ </span></span><br><span class="line">passage_end_tag:</span><br><span class="line">  enabled: <span class="literal">true</span></span><br></pre></td></tr></tbody></table></figure><h2 id="è‡ªå®šä¹‰hexo-newç”Ÿæˆæ¨¡æ¿">è‡ªå®šä¹‰hexo newç”Ÿæˆæ¨¡æ¿</h2><p>hexo new (post/page/draft) $filenameçš„æ¨¡æ¿ï¼Œä¿®æ”¹<code>/scaffolds/post.md</code>æ–‡ä»¶(<code>page.md</code>å’Œ<code>draft.md</code>æ–‡ä»¶åŒç†)</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">title: {{ title }}</span><br><span class="line">date: {{ date }}</span><br><span class="line">tags:                <span class="comment">#æ ‡ç­¾</span></span><br><span class="line">categories:      <span class="comment">#åˆ†ç±»</span></span><br><span class="line">copyright: <span class="literal">true</span> <span class="comment">#ç‰ˆæƒå£°æ˜</span></span><br><span class="line">permalink: 01  <span class="comment">#æ–‡ç« é“¾æ¥ï¼Œæœ‰é»˜è®¤å€¼</span></span><br><span class="line">top: 0              <span class="comment">#ç½®é¡¶ä¼˜å…ˆçº§</span></span><br><span class="line">password:      <span class="comment">#å¯†ç ä¿æŠ¤</span></span><br></pre></td></tr></tbody></table></figure><p></p><h2 id="æ–‡ç« åˆ†ç±»">æ–‡ç« åˆ†ç±»</h2><h3 id="åˆ†ç±»å±•ç¤º">åˆ†ç±»å±•ç¤º</h3><p>æ­¤å¤„ä»…å±•ç¤ºtagsçš„è®¾ç½®, categoriesåŒç†è®¾å®šå³å¯ 1.å»ºç«‹åˆ†ç±»å±•ç¤ºçš„é™æ€é¡µé¢ </p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new page tags</span><br></pre></td></tr></tbody></table></figure>å‘ç°ç”Ÿæˆä¸€ä¸ª<code>/source/tags/index.md</code>æ–‡ä»¶<p></p><ol start="2" type="1"><li><p>è®¾ç½®é¡µé¢ç±»å‹, ç›´æ¥åœ¨<code>index.md</code>æ–‡ä»¶ä¸­è¾“å…¥:</p><figure class="highlight markdown"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: Tags</span><br><span class="line">date: 2022-03-21 00:50:56</span><br><span class="line">type: "tags"</span><br><span class="line">comments: false</span><br><span class="line">---</span><br></pre></td></tr></tbody></table></figure><p></p></li><li><p>ä¿®æ”¹èœå•æ ,ä¿®æ”¹<code>themes/${theme_name}/_config.yml</code>æ–‡ä»¶ï¼Œä¿®æ”¹ä¸‹åˆ—è®¾ç½®</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">menu:</span><br><span class="line">  home: /</span><br><span class="line">  archives: /archives</span><br><span class="line">  tags: /tags</span><br></pre></td></tr></tbody></table></figure><p></p></li><li><p>ä¿®æ”¹tagsé¡µé¢çš„å­—ä½“å¤§å°,ä¿®æ”¹æ–‡ä»¶<code>themes/${theme_name}/_config.yml</code>, å¦‚ä¸‹</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># TagCloud settings for tags page.</span></span><br><span class="line">tagcloud:</span><br><span class="line">  <span class="comment"># All values below are same as default, change them by yourself.</span></span><br><span class="line">  min: 30 <span class="comment"># Minimun font size in px</span></span><br><span class="line">  max: 50 <span class="comment"># Maxium font size in px</span></span><br><span class="line">  start: <span class="string">"#ccc"</span> <span class="comment"># Start color (hex, rgba, hsla or color keywords)</span></span><br><span class="line">  end: <span class="string">"#111"</span> <span class="comment"># End color (hex, rgba, hsla or color keywords)</span></span><br><span class="line">  amount: 200 <span class="comment"># Amount of tags, change it if you have more than 200 tags</span></span><br></pre></td></tr></tbody></table></figure><p></p></li><li><p>ä¿®æ”¹æ–‡ç« æœ«å°¾çš„tagçš„å›¾æ ‡,ä¿®æ”¹æ–‡ä»¶<code>/themes/next/layout/_macro/post.swig</code>,æ›¿æ¢</p><figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href="{{ url_for(tag.path) }}" rel="tag"&gt;{{ tag_indicate }} {{ tag.name }}&lt;/a&gt;</span><br></pre></td></tr></tbody></table></figure> ä¸º <figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href="{{ url_for(tag.path) }}" rel="tag"&gt;&lt;i class="fa fa-tag"&gt;&lt;/i&gt; {{ tag.name }}&lt;/a&gt;</span><br></pre></td></tr></tbody></table></figure><p></p></li></ol><h3 id="åˆ†ç±»å­˜å‚¨">åˆ†ç±»å­˜å‚¨</h3><p>é€šè¿‡ä¿®æ”¹é…ç½®æ–‡ä»¶<code>blog/_config.yml</code>ä¸­çš„<code>new_post_name</code>æ¥è®©åˆ›å»ºçš„æ–‡ä»¶æŒ‰ç…§æ—¶é—´åˆ†ç±»ï¼Œä¹Ÿå¯ä»¥æŒ‰ç…§(<code>hexo new post --path filepath name</code>)æ¥åˆ›å»ºï¼Œç¤ºä¾‹å¦‚ä¸‹</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">permalink: :year/:month/:day/:title/</span><br><span class="line">new_post_name: :year/:month/:title.md <span class="comment"># File name of new posts</span></span><br></pre></td></tr></tbody></table></figure><p></p><h2 id="æ–‡ç« åŠ å¯†è®¿é—®">æ–‡ç« åŠ å¯†è®¿é—®</h2><h3 id="ç®€å•æ–¹æ³•">ç®€å•æ–¹æ³•</h3><ol type="1"><li><p>æ‰“å¼€ä¸»é¢˜ç›®å½•ä¸‹layout/_partials/head.swigæ–‡ä»¶,åœ¨metaæ ‡ç­¾åé¢æ’å…¥è¿™æ ·ä¸€æ®µä»£ç </p><figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">'{{ page.password }}'</span>){</span><br><span class="line">            <span class="keyword">if</span> (prompt(<span class="string">'è¯·è¾“å…¥æ–‡ç« å¯†ç '</span>) !== <span class="string">'{{ page.password }}'</span>){</span><br><span class="line">                alert(<span class="string">'å¯†ç é”™è¯¯ï¼'</span>);</span><br><span class="line">                history.back();</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    })();</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p></li><li><p>åœ¨æ¯ç¯‡æ–‡ç« mdçš„å¼€å¤´æ·»åŠ  <code>password: pwd</code>, å³å¯ä»¥æ¿€æ´»</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: Start with Hexo</span><br><span class="line">date: 2022-03-19 00:06:40</span><br><span class="line">tags: hexo</span><br><span class="line"><span class="comment"># password: mypwd</span></span><br><span class="line">---</span><br></pre></td></tr></tbody></table></figure> ### å®‰è£…æ’ä»¶æ–¹æ³• ref: <a href="https://www.itfanr.cc/2021/04/16/hexo-blog-article-encryption/">hexoåšå®¢æ–‡ç« åŠ å¯†</a><p></p></li><li><p>å®‰è£…æ’ä»¶ </p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save hexo-blog-encrypt</span><br></pre></td></tr></tbody></table></figure><p></p></li><li><p>åœ¨/_config.ymlä¸­è¾“å…¥å“åº”é…ç½® </p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Security</span></span><br><span class="line">encrypt: <span class="comment"># hexo-blog-encrypt</span></span><br><span class="line">  silent: <span class="literal">true</span></span><br><span class="line">  abstract: è¿™æ˜¯ä¸€ç¯‡åŠ å¯†æ–‡ç« ï¼Œéœ€è¦å¯†ç æ‰èƒ½ç»§ç»­é˜…è¯»ã€‚</span><br><span class="line">  message: å½“å‰æ–‡ç« æš‚ä¸å¯¹å¤–å¯è§ï¼Œè¯·è¾“å…¥å¯†ç åæŸ¥çœ‹ï¼</span><br><span class="line">  tags:</span><br><span class="line">  - {name: private, password: mypwd}</span><br><span class="line">  wrong_pass_message: æŠ±æ­‰ï¼Œæ‚¨è¾“å…¥çš„å¯†ç é”™è¯¯ï¼Œè¯·æ£€æŸ¥åé‡æ–°è¾“å…¥ã€‚</span><br><span class="line">  wrong_hash_message: æŠ±æ­‰, å½“å‰æ–‡ç« ä¸èƒ½è¢«æ ¡éªŒ, ä¸è¿‡æ‚¨è¿˜æ˜¯å¯ä»¥çœ‹çœ‹è§£å¯†åçš„å†…å®¹</span><br></pre></td></tr></tbody></table></figure><p></p></li><li><p>è§£å†³è§£å¯†åç›®å½•æ¶ˆå¤±é—®é¢˜ï¼Œæ‰¾åˆ°æ–‡ä»¶<code>themes/next/layout/_macro/sidebar.swig</code> ï¼Œç¼–è¾‘å¦‚ä¸‹éƒ¨åˆ†ï¼š</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;aside class=<span class="string">"sidebar"</span>&gt;</span><br><span class="line">  &lt;div class=<span class="string">"sidebar-inner"</span>&gt;</span><br><span class="line"></span><br><span class="line">    {%- <span class="built_in">set</span> display_toc = page.toc.enable and display_toc %}</span><br><span class="line">    {%- <span class="keyword">if</span> display_toc %}</span><br><span class="line">      </span><br><span class="line">      <span class="comment">## Start</span></span><br><span class="line">      {%- <span class="keyword">if</span> (page.encrypt) %}</span><br><span class="line">        {%- <span class="built_in">set</span> toc = toc(page.origin, { class: <span class="string">"nav"</span>, list_number: page.toc.number, max_depth: page.toc.max_depth }) %}</span><br><span class="line">      {%- <span class="keyword">else</span> %}</span><br><span class="line">        {%- <span class="built_in">set</span> toc = toc(page.content, { class: <span class="string">"nav"</span>, list_number: page.toc.number, max_depth: page.toc.max_depth }) %}</span><br><span class="line">      {%- endif %}</span><br><span class="line">      <span class="comment">## End</span></span><br><span class="line">      <span class="comment">## åŒæ—¶åˆ é™¤ set tocè¿™ä¸€å¥ï¼ï¼ï¼</span></span><br><span class="line"></span><br><span class="line">      {%- <span class="built_in">set</span> display_toc = toc.length &gt; 1 and display_toc %}</span><br><span class="line">    {%- endif %}</span><br></pre></td></tr></tbody></table></figure><p></p></li></ol><h2 id="æ’ä»¶å®‰è£…">æ’ä»¶å®‰è£…</h2><h3 id="mermaidæµç¨‹å›¾">mermaidæµç¨‹å›¾</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## å®‰è£…æ’ä»¶</span></span><br><span class="line">npm install hexo-filter-mermaid-diagrams</span><br><span class="line"></span><br><span class="line"><span class="comment">## åœ¨å½“å‰ä½¿ç”¨çš„ä¸»é¢˜çš„.config.ymlä¸­å¼€å¯åŠŸèƒ½ï¼Œ ./themes/.config.yml</span></span><br><span class="line">mermaid:</span><br><span class="line">  on: <span class="literal">true</span></span><br></pre></td></tr></tbody></table></figure><h1 id="ref">Ref</h1><p><a href="https://yelog.org/2017/03/13/3-hexo-homepage/">3-hexo-homepage</a><a href="https://theme-next.iissnan.com/theme-settings.html" target="_blank" rel="noopener">next</a> <a href="https://vic.kim/2019/05/25/Hexo%E5%8D%9A%E5%AE%A2%E4%BC%98%E5%8C%96%E4%B9%8BNext%E4%B8%BB%E9%A2%98%E7%BE%8E%E5%8C%96/">nextä¸»é¢˜ç¾åŒ–</a></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Bolzaé—®é¢˜, Legendreå˜æ¢ï¼Œä»æœ€é€Ÿé™çº¿è¯´èµ·</title>
      <link href="/2022/03/01/bolza/"/>
      <url>/2022/03/01/bolza/</url>
      
        <content type="html"><![CDATA[<h1 id="bolzaé—®é¢˜">Bolzaé—®é¢˜</h1><h2 id="å¼•è¨€">å¼•è¨€</h2><p>æœ€è¿‘åœ¨å­¦ä¹ The financial mathematics of market liquidityå’Œæ¸¸æˆä¸­ç‰©ç†æ¨¡æ‹Ÿçš„ä¸€äº›çŸ¥è¯†ï¼Œå‘ç°è¿™ä¸¤ä¸ªåœ°æ–¹éƒ½æ¶‰åŠåˆ°äº†Bolzaé—®é¢˜ï¼Œå†³å®šå•ç‹¬æŠŠè¿™å—æå–å‡ºæ¥è¯´ä¸€è¯´ã€‚æˆ‘ä»¬è¿™è¾¹ä¸»è¦æŠŠBolzaé—®é¢˜é›†ä¸­åœ¨æœ€å°åŒ–è¿™ä¸ªå°é—®é¢˜ä¸Šé¢:<span class="math display">\[J = \int_{0}^T f_t(x(t)) + g_t(\dot{x}(t))dt\]</span> å¹¶ä¸”æ»¡è¶³è¾¹ç•Œæ¡ä»¶<span class="math inline">\(x(0) = a, x(T) =b\)</span>ã€‚ <a id="more"></a></p><p>å½“ç„¶æ›´åŠ ä¸€èˆ¬çš„Bolzaé—®é¢˜å¯ä»¥å‚è€ƒè¿™ä¸ªé“¾æ¥https://encyclopediaofmath.org/wiki/Bolza_problemè¿™è¾¹æˆ‘ä»¬è€ƒè™‘æ˜¯å…¶ç®€åŒ–ç‰ˆæœ¬ï¼Œåœ¨ä¸€èˆ¬çš„å…¼å®¹å»ºæ¨¡å’Œç‰©ç†æ¨¡æ‹Ÿä¸­è¶³å¤Ÿä½¿ç”¨äº†ã€‚</p><blockquote><p>NOTEç¬”è€…èƒŒæ™¯åç†è®ºç‰©ç†å‘ï¼Œæ‰€ä»¥æ•´ä¸ªBlogåœ¨æ•°å­¦ä¸Šå¯èƒ½ä¸æ˜¯é‚£ä¹ˆä¸¥è°¨ï¼Œä½†æ±‚èƒ½å¤Ÿè®²æ¸…æ¥šå…¶èƒŒåçš„ä¸€äº›åŸç†æ€§çš„ä¸œè¥¿</p></blockquote><h2 id="æœ€é€Ÿé™çº¿">æœ€é€Ÿé™çº¿</h2><p>çœ‹åˆ°ä¸Šé¢é‚£ä¸ªå¸¦ä¼˜åŒ–çš„æ–¹ç¨‹ï¼Œå¯¹äºå­¦è¿‡ä¸€äº›ç‰©ç†çš„æœ‹å‹æ¥è¯´ï¼Œç¬¬ä¸€ååº”å°±æ˜¯è”æƒ³åˆ°Lagrangianã€‚é‚£ä¹ˆè¿™è¾¹æˆ‘ä»¬å°±ä»ç»å…¸çš„æœ€é€Ÿé™çº¿è¯´èµ·ã€‚æœ€é€Ÿé™çº¿è¦è§£å†³çš„ä¸€ä¸ªé—®é¢˜å°±æ˜¯ï¼Œåœ¨çº¯é‡åŠ›åœºä¸‹é¢ï¼Œæ‰¾åˆ°ä¸€æ¡è½¨é“ï¼Œä½¿å¾—ä»ç‚¹Aåˆ°ç‚¹B(ç‚¹Aé«˜åº¦é«˜äºç‚¹B)ï¼Œç”¨çš„æ—¶é—´æœ€çŸ­ã€‚å¦‚å›¾æ‰€ç¤º æ˜¾ç„¶ï¼Œæˆ‘ä»¬è¦ä¼˜åŒ–çš„ä¸œè¥¿æ˜¯ <span class="math inline">\(T=\int_0^Tdt\)</span>ï¼Œé€šè¿‡ç®€å•çš„è¿åŠ¨å­¦å’Œèƒ½é‡å®ˆæ’ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ï¼Œ <span class="math display">\[dt = \frac{\sqrt{dx^2 + dy^2}}{v} =\frac{\sqrt{1+y'^2(x)}}{\sqrt{2gy}}dx\]</span> å› æ­¤æˆ‘ä»¬æœ€ç»ˆçš„ä¼˜åŒ–é—®é¢˜æ˜¯ï¼š <span class="math display">\[J[y(x)] = \int_{x_A}^{x_B}\frac{\sqrt{1+y'^2(x)}}{\sqrt{2gy}}dx\]</span> ä»è¿™è¾¹æˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥ï¼Œæœ€é€Ÿé™çº¿å°±æ˜¯ä¸€ç§Blozaé—®é¢˜ï½</p><h2 id="legendreå˜æ¢">Legendreå˜æ¢</h2><p>æåˆ°Legendreå˜æ¢ï¼Œæˆ‘æƒ³å¯¹äºç‰©ç†ç³»æ¯•ä¸šçš„å­¦ç”Ÿï¼Œä¸€ä¸‹å°±ä¼šæƒ³åˆ°ç†è®ºåŠ›å­¦å’Œçƒ­åŠ›å­¦å­¦åˆ°çš„ä¸¤ä¸ªåœºæ™¯</p><h3 id="ç†è®ºåŠ›å­¦">ç†è®ºåŠ›å­¦</h3><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œç†è®ºåŠ›å­¦æœ‰ä¸¤å¥—æè¿°æ–¹å¼ï¼Œä¸€å¥—èµ°çš„æ‹‰æ ¼æœ—æ—¥åŠ›å­¦ï¼Œä¸€å¥—èµ°çš„å“ˆå¯†é¡¿åŠ›å­¦ã€‚ä»å¹¿ä¹‰åæ ‡å’Œè™šåŠŸåŸç†å‡ºå‘ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“æ‰¾åˆ°åœ¨ä¿å®ˆåœºä¸­åŠ¨åŠ›å­¦æè¿°ï¼š<span class="math display">\[L = T(q,\dot{q})- V(q)\]</span>ï¼Œ è¿™è¾¹<span class="math inline">\(q, T,V\)</span>åˆ†åˆ«ä»£è¡¨ç³»ç»Ÿçš„å¹¿ä¹‰åæ ‡ï¼ŒåŠ¨èƒ½ï¼Œä¿å®ˆåŠ¿èƒ½ã€‚åŠ¨åŠ›å­¦å¯¹åº”çš„å¾®åˆ†æ–¹ç¨‹æ˜¯<span class="math display">\[\frac{d}{dt}\frac{\partial L}{\partial \dot{q}_k} = \frac{\partialL}{\partial q_k}\]</span></p><p>å“ˆå¯†é¡¿åŠ›å­¦åˆ™å¯ä»¥é€šè¿‡Legendreå˜æ¢ï¼Œä»æ‹‰æ ¼æœ—æ—¥åŠ›å­¦ä¸­è½¬å˜è€Œæ¥ï¼Œ <span class="math display">\[\dot{p}_k = -\nabla_{q_k}H(p,q), \dot{q}_k = \nabla_{p_k}H(p,q)\]</span> è¿™è¾¹åŠ¨é‡<span class="math inline">\(p:=\frac{\partialL}{\partial \dot{q}_k}\)</span>ï¼Œè€Œå“ˆå¯†é¡¿é‡<span class="math inline">\(H\)</span>åˆ™æ˜¯æ‹‰æ ¼æœ—æ—¥é‡é€šè¿‡Legendreå˜æ¢å¾—æ¥ <span class="math inline">\(H = p^T \dot{q} - L(q, \dot{q})\)</span>ã€‚</p><h3 id="çƒ­åŠ›å­¦">çƒ­åŠ›å­¦</h3><p>åœ¨çƒ­åŠ›å­¦ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“æœ‰å‡ ä¸ªåŸºæœ¬çš„ç‰©ç†é‡ï¼Œç„“<span class="math inline">\(H\)</span>, å“ªèƒ½<span class="math inline">\(U\)</span>, äº¥å§†éœå…¹è‡ªç”±èƒ½<span class="math inline">\(F\)</span>ï¼Œå‰å¸ƒæ–¯è‡ªç”±èƒ½<span class="math inline">\(G\)</span>ï¼Œæ»¡è¶³ä¸‹é¢çš„å…³ç³» <span class="math display">\[H = U + PV,G = H - TS,A = U - TS\]</span> è¿™è¾¹<span class="math inline">\(T,S\)</span>ä»£è¡¨ç³»ç»Ÿçš„æ¸©åº¦å’Œç†µï¼Œ<span class="math inline">\(P,V\)</span>ä»£è¡¨ç³»ç»Ÿçš„å‹å¼ºå’Œä½“ç§¯ã€‚ç¬”è€…ï¼Œå½“åˆåœ¨å­¦ä¹ çƒ­åŠ›å­¦çš„æ—¶å€™ï¼Œå¯¹äº<span class="math inline">\((T,S),(P,V)\)</span>è¿™ä¸¤ç»„å…±è½­å˜é‡ï¼Œä¹Ÿæ˜¯åªæ˜¯è®¤ä¸ºé‡çº²äº’è¡¥ï¼Œä¹Ÿæ˜¯æœ€è¿‘æ‰ç†è§£äº†è¿™è¾¹å…±è½­çš„æ¥æºï¼Œæƒ­æ„§...</p><h3 id="æ•°å­¦">æ•°å­¦</h3><p>æ•°å­¦ä¸Šå¯¹äºLegendreå˜æ¢çš„å®šä¹‰å¦‚ä¸‹ï¼š</p><blockquote><p>å®šä¹‰ å¦‚æœå‡½æ•°<span class="math inline">\(f(x): R^d \to R\)</span>åœ¨æˆ‘ä»¬æ‰€å…³å¿ƒçš„åŒºåŸŸå†…æ˜¯å¯å¯¼çš„ï¼Œå‡½æ•°<span class="math inline">\(f(x)\)</span>å¯¹åº”çš„Legendreå˜æ¢å®šä¹‰ä¸º <span class="math display">\[ f^*(p) = p^T x - f(x) |_{\frac{d(px-f(x))}{dx} =0} \]</span></p></blockquote><p>ä»å›¾ä¸Šæˆ‘ä»¬å¯ä»¥çœ‹åˆ°Legendreå˜æ¢çš„å‡ ä½•æ„ä¹‰: <img src="/2022/03/01/bolza/leg.png" class="" title="This is an image">ä»è¿™å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥ï¼ŒåŠ å…¥<span class="math inline">\(f(x)\)</span>ä¸€ä¸ªæ»¡è¶³è¶…çº¿æ€§<span class="math inline">\(\lim_{|x|\to\infty}\frac{|f(x)|}{|x|} =\infty\)</span>çš„å‡¸å‡½æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªå®šä¹‰ç­‰ä»·äº <span class="math display">\[f^*(p) = \sup_{x} p^T x - f(x)\]</span> å¯¹ç€æ¼”ç¤ºçš„è¿™å¹…å›¾ï¼Œæˆ‘ä»¬å¯ä»¥æƒ³è±¡ï¼Œæ¯”å¦‚<span class="math inline">\(x\)</span>è¶Šæ¥è¶Šå¤§çš„æ—¶å€™ï¼Œ<span class="math inline">\(f(x)\)</span>å¢åŠ è¶Šæ¥è¶Šå¿«ï¼Œå¯¹åº”çš„åˆ‡çº¿å˜é™¡å³­çš„é€Ÿç‡ä¹Ÿè¶Šæ¥è¶Šå¿«ï¼Œ<span class="math inline">\(f^*\)</span>å¢åŠ å¾—ä¹Ÿè¶Šæ¥è¶Šå¿«ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥claimï¼Œæ•°å­¦è¯æ˜ä¹Ÿæ˜¯å¾ˆç®€å•çš„ï¼Œåœ¨è¿™è¾¹å°±ä¸èµ˜è¿°äº†ã€‚</p><blockquote><p>æ€§è´¨ <span class="math inline">\(f^*\)</span>ä¹Ÿæ˜¯ä¸€ä¸ªå‡¸å‡½æ•°</p></blockquote><p>å¯¹æ¯”ä¸Šé¢ä¸¤ç§ç‰©ç†ï¼Œå°¤å…¶æ˜¯ç†è®ºåŠ›å­¦ä¸­çš„ç»“æ„ï¼Œæˆ‘ä»¬å¯ä»¥ä»»ä½•ä¸€ä¸ªæ‹‰æ ¼æœ—æ—¥é‡ï¼Œå¯¹åº”çš„å“ˆå¯†é¡¿é‡ä¹Ÿä¼šç»§æ‰¿å…¶çš„å‡¹å‡¸æ€§ï¼Œè¿™ç‚¹æ˜¯éå¸¸é‡è¦æœ‰æ„æ€çš„ï¼Œæœ‰å…´è¶£çš„è¯»è€…å¯ä»¥è„‘å­é‡Œæƒ³è±¡ä¸€ä¸‹ç®€å•çš„å¼¹ç°§ç³»ç»Ÿã€‚</p><!-- é‚£ä¹ˆå¯¹äºé‚£äº›ä¸å¯å¯¼çš„å‡¸å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ª```subgradient```æ¥ä»£æ›¿æç£> å®šä¹‰> å‡è®¾$f:C \to R$æ˜¯ä¸€ä¸ªå‡¸å‡½æ•°ï¼Œå¯¹äºå®šä¹‰åŸŸå†…çš„ä¸€ç‚¹$x$ï¼Œè¿™ç‚¹çš„```subgradient```æ˜¯å®šä¹‰ä¸ºæ»¡è¶³ä¸‹é¢æ¡ä»¶çš„é›†åˆ:> $$ \{ p | \forall y \in C, f(y) \ge f(x) + p(y - x) \}$$ --><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> ç†è®ºç‰©ç† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é‡å­ç‰©ç†ï¼Œæœºå™¨å­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€Šåˆšæ€§æ³¡æ²«ã€‹è¯»ä¹¦ç¬”è®°</title>
      <link href="/2021/01/01/%E5%88%9A%E6%80%A7%E6%B3%A1%E6%B2%AB/"/>
      <url>/2021/01/01/%E5%88%9A%E6%80%A7%E6%B3%A1%E6%B2%AB/</url>
      
        <content type="html"><![CDATA[<h1 id="åˆšæ€§æ³¡æ²«">åˆšæ€§æ³¡æ²«</h1><p>å…¨ä¹¦æè¿°äº†ä¸­å›½ç»æµé‡åˆ°å›°å¢ƒï¼Œå¹¶è®¤ä¸ºæ”¿åºœçš„éšæ€§æ‹…ä¿å’Œåˆšæ€§å…‘ä»˜éš¾è¾å…¶å’ï¼ŒåŒæ—¶å¼ºè°ƒå¸‚åœºè‡ªç”±çš„é‡è¦æ€§ã€‚<a id="more"></a></p><h2 id="ä¿¡ç”¨æµ">ä¿¡ç”¨æµ</h2><pre class="mermaid">graph TDG1[ä¸­å¤®æ”¿åºœ] --&gt; G2[åœ°æ–¹æ”¿åºœ]G2 --ä¿è¯æˆ¿ä»·ä¸è·Œ--&gt; G3[æˆ¿åœ°äº§]G2 --ä¿è¯æ”¶ç›Šç¨³å®š--&gt; G4[å½±å­é“¶è¡Œ]G1 --&gt; G5[è¯ç›‘ä¼š]G5 --ä¿è¯è‚¡å¸‚ç¹è£ --&gt; G6[è‚¡å¸‚]G1 --æ”¿ç­–ä¼˜æƒ --&gt; G7[å›½æœ‰ä¼ä¸š]G4 --&gt; G8[ä¿¡æ‰˜äº§å“]G4 --&gt; G9[å§”æ‰˜å­˜æ¬¾]</pre><p>å¤‡æ³¨ï¼š</p><ul><li>é€šè¿‡å‘è¡Œæ”¶ç›Šä¸°åšåŒæ—¶è¢«è®¤ä¸ºéå¸¸å®‰å…¨çš„ä¿¡æ‰˜äº§å“å’Œç†è´¢è®¡åˆ’ï¼ŒæŠŠèµ„é‡‘è´·ç»™æˆ¿åœ°äº§å¼€å‘å•†å’Œåœ°æ–¹æ”¿åºœèèµ„å¹³å°ï¼Œè¿™äº›ä¼ ç»Ÿé“¶è¡Œä¸èƒ½æ”¾è´·çš„é¢†åŸŸã€‚</li><li>å§”æ‰˜è´·æ¬¾ï¼Œä¸€ä¸ªå…¬å¸æŠŠè‡ªå·±çš„èµ„é‡‘è´·ç»™å¦ä¸€ä¸ªå…¬å¸ï¼Œå½±å­é“¶è¡Œåœ¨å…¶ä¸­æ‰®æ¼”ä¸­ä»‹ã€‚</li></ul><p>ä¸ºä»€ä¹ˆè¯´ä¸­å›½å­˜åœ¨åˆšæ€§å…‘ä»˜ï¼š</p><ul><li>å›½é™…çš„è¯ç›‘ä¼šèŒè´£åªæœ‰ä¸€æ¡ï¼Œä¿è¯å¸‚åœºä¸Šçš„ä¿¡æ¯æŠ«éœ²å…¬æ­£ï¼Œå…¬å¹³ï¼Œå…¬å¼€ã€‚è€Œä¸­å›½è¯ç›‘ä¼šä¸€ç›´åœ¨ä¸ºè‚¡å¸‚æä¾›éšå½¢æ‹…ä¿ï¼Œè¿™å®é™…é€ æˆäº†ä¸­å›½è‚¡å¸‚ä¸Šçš„èµŒåšè¡Œä¸ºæ›´åŠ æ˜æ˜¾ï¼Œæ•´ä¸ªè‚¡å¸‚é•¿æœŸå¤„äºé«˜æ³¢åŠ¨çŠ¶æ€ã€‚</li><li>å›½æœ‰ä¼ä¸šäº«æœ‰ç‰¹åˆ«çš„æ”¿ç­–ä¼˜æƒ ï¼Œä¾‹å¦‚å„æ–­è¡Œä¸šçš„å‡†å…¥æƒï¼Œé‡ç‚¹æ ¸å¿ƒé¡¹ç›®çš„å‚ä¸æƒï¼Œæ”¿åºœé‡‡è´­ï¼Œé€€ç¨åŠå…¶ä»–è´¢æ”¿ä¼˜æƒ ã€‚å› æ­¤å¯¼è‡´äº†ä¸­å›½å›½æœ‰ä¼ä¸šçš„è´Ÿå€ºè¿‡é«˜ï¼Œäº§èƒ½è¿‡å‰©çš„æ˜æ˜¾é—®é¢˜ã€‚</li></ul><h3 id="å½±å­é“¶è¡Œ">å½±å­é“¶è¡Œ</h3><p>å‘è¾¾å›½å®¶é‡‘èä½“ç³»:</p><ul><li>è‚¡ç¥¨</li><li>å€ºåˆ¸</li></ul><p>ä¸­å›½é‡‘èä½“ç³»</p><ul><li>é“¶è¡Œ</li></ul><p>ä¸ºä»€ä¹ˆå½±å­é“¶è¡Œåœ¨ä¸­å›½è§„æ¨¡å¦‚æ­¤ä¹‹å¤§ï¼š</p><ul><li>é‡‘èå‹æŠ‘ï¼Œå®ä½“ç»æµå¯¹èµ„é‡‘çš„æ¸´æ±‚</li><li>èµ„æœ¬é‡‘å……è¶³ç‡çš„è¦æ±‚<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a><ul><li>å½±å­é“¶è¡Œå¯ä»¥å¸®åŠ©é“¶è¡Œï¼Œå°†è¡¨å†…ä¸šåŠ¡è½¬è‡³è¡¨å¤–ï¼Œä»è€Œå‰Šå‡èµ„äº§è§„æ¨¡ï¼Œè¾¾åˆ°é™ä½è‡ªæœ‰èµ„æœ¬é‡‘çš„ç›®çš„ã€‚</li></ul></li><li>å­˜è´·æ¬¾æ¯”ç‡å’Œå­˜æ¬¾å‡†å¤‡é‡‘çš„è¦æ±‚<ul><li>é€šè¿‡å½±å­é“¶è¡ŒæŠŠä¸èƒ½ç®—ä½œé“¶è¡Œæ™®é€šå­˜æ¬¾çš„é“¶è¡Œé—´å­˜æ¬¾è½¬æˆæ™®é€šå­˜æ¬¾ï¼Œä»è€Œæé«˜å­˜æ¬¾è§„æ¨¡ï¼Œé™ä½å­˜è´·æ¬¾æ¯”ç‡ã€‚</li></ul></li></ul><h3 id="æˆ¿åœ°äº§">æˆ¿åœ°äº§</h3><p>ä¸­å›½æˆ¿åœ°äº§å­˜åœ¨ä¸¥é‡çš„æ³¡æ²«ï¼Œå¹¶ä¸”é€šè¿‡æ•°æ®åˆ†æï¼Œæ’é™¤äº†æ˜¯åˆšéœ€çš„åŠ¨æœºã€‚</p><ul><li>æˆ¿ä»·ä¸Šæ¶¨é€Ÿåº¦</li><li>ç§Ÿé‡‘å’Œæˆ¿ä»·æ¯”ä¾‹</li><li>æˆ¿ä»·å’Œå±…æ°‘æ”¶å…¥æ¯”ä¾‹</li><li>åœŸåœ°æ€»ä»·å€¼</li></ul><p><code>ä¼ ç»Ÿé“¶è¡Œ</code>ï¼Œ<code>å½±å­é“¶è¡Œ</code>å’Œ<code>åœ°æ–¹èèµ„å¹³å°</code>å¾ˆå¤šèµ„é‡‘éƒ½è¿›å…¥äº†<code>æˆ¿åœ°äº§</code>ã€‚è¿™äº›é‡‘èæœºæ„éƒ½å› æˆ¿åœ°äº§é¢ä¸´å·¨å¤§çš„é£é™©æ•å£ã€‚</p><h3 id="ä¸­å›½è‚¡å¸‚">ä¸­å›½è‚¡å¸‚</h3><p>ä¸­å›½è‚¡å¸‚ç¼ºä¹æŠ‘åˆ¶æ³¡æ²«å¢é•¿çš„å·¥å…·</p><ul><li>åšç©ºæœºåˆ¶</li><li>è¡ç”Ÿå“ç§ç±»å¤ªè¿‡å•ä¸€</li><li>å¤–æ±‡é™åˆ¶ï¼Œå¯¼è‡´äº†å“„æŠ¬å›½å†…èµ„äº§ä»·æ ¼</li></ul><p>Aè‚¡ä¸¥å‰çš„å®¡æ‰¹åˆ¶åº¦å¸¦æ¥ä¸€ä¸‹çš„ç¼ºç‚¹ï¼š</p><ul><li>å¾ˆå¤šçœŸæ­£çš„å¥½å…¬å¸å¹¶ä¸èƒ½åœ¨Aè‚¡ä¸Šå¸‚</li><li>ä¸¥å‰çš„å®¡æ‰¹ï¼Œä¼šè¯¯å¯¼æŠ•èµ„è€…ï¼Œè®¤ä¸ºèƒ½åœ¨Aè‚¡ä¸Šå¸‚çš„å…¬å¸éƒ½æ˜¯å¥½å…¬å¸ï¼Œé™ä½äº†æŠ•èµ„è€…çš„åˆ¤æ–­èƒ½åŠ›</li><li>ä¸¥å‰çš„å®¡æ‰¹ï¼Œé€ æˆäº†Aè‚¡å…¬å¸æ™®éçš„é«˜ä¼°å€¼</li><li>ä¸¥å‰çš„å®¡æ‰¹ï¼Œå°†æŠ•èµ„é£é™©éƒ¨åˆ†è½¬ç§»åˆ°è¯ç›‘ä¼šï¼Œè¿™ä¸€ä¸­æ€§æœºæ„ï¼Œç›¸å½“äºæä¾›äº†éšå½¢æ‹…ä¿ã€‚</li><li>æ²¡æœ‰å®Œå¤‡çš„é€€å¸‚æœºåˆ¶ï¼Œå¯¼è‡´ä¸Šå¸‚å…¬å¸èèµ„ä¹‹åï¼Œå¹¶ä¸æ‰©å¤§ä¸»è¥ä¸šåŠ¡ï¼Œè€Œæ˜¯æŠ•å…¥åˆ°æˆ¿åœ°äº§ç­‰é¢†åŸŸï¼Œæ‰©å¤§äº†æ•´ä¸ªç³»ç»Ÿé£é™©ã€‚</li></ul><h3 id="ä¸­å›½çš„é‡‘èåˆ›æ–°">ä¸­å›½çš„é‡‘èåˆ›æ–°</h3><p>ä¸­å›½ç‰¹è‰²çš„é‡‘èäº§å“:</p><ul><li>ä½™é¢å®ä¹‹ç±»çš„äº’è”ç½‘é‡‘èäº§å“<ul><li>ç½‘æ°‘æ•°é‡ä¹‹å¤§ï¼Œäººå‡ç†è´¢æ•°é¢ä¸å¤§ï¼Œæä¾›äº†å……è¶³çš„æµåŠ¨æ€§</li><li>ä¸­å›½ç½‘æ°‘ç¼ºä¹ç†è´¢å¸¸è¯†ï¼Œå¹¶ä¸èƒ½æ„è¯†åˆ°å…¶ä¸­çš„é£é™©</li><li>äº’è”ç½‘ä¼ä¸šé€šè¿‡åšå¤§è‡ªå·±ï¼Œå¸å¼•æ”¿åºœå…³æ³¨ï¼Œå°†è¯¥ç±»æŠ•èµ„å“çš„é£é™©è½¬åŠ ç»™æ”¿åºœï¼Œè®©æ”¿åºœä¸ºå…¶æä¾›éšå½¢æ‹…ä¿å’Œåˆšæ€§å…‘ä»˜ã€‚</li></ul></li><li>P2P</li><li>å¤§å®—å•†å“èèµ„<ul><li>å¥—åˆ©æœºåˆ¶ï¼Œä¾èµ–äºå¤§å®—å•†å“çš„ä»·æ ¼ç¨³å®š</li></ul></li></ul><h3 id="ä¸­å›½ç»æµåŠ¨åŠ›">ä¸­å›½ç»æµåŠ¨åŠ›</h3><p>ä¸‰é©¾é©¬è½¦</p><ul><li>å‡ºå£<ul><li>åŠ³åŠ¨åŠ›ä¼˜åŠ¿å‡å¼±</li><li>ä¼ä¸šç”Ÿäº§æ•ˆç‡ä½ä¸‹</li></ul></li><li>å†…éœ€<ul><li>ä¸­å›½ç¤¾ä¼šæ–‡åŒ–å¯¼è‡´äººä»¬å¯¹å¥¢é¥°å“çš„è¿½æ±‚ï¼Œå¹¶ä¸èƒ½ä¿ƒè¿›å›½å†…çš„æ¶ˆè´¹éœ€æ±‚</li><li>æ—¥ç›Šé«˜æ¶¨çš„æˆ¿ä»·ï¼ŒæŒ¤å‹å¹´è½»äººçš„æ¶ˆè´¹éœ€æ±‚</li><li>é«˜åº¦ä¸ç¡®å®šçš„ç¤¾ä¼šä¿éšœä½“åˆ¶ï¼Œæé«˜äº†äººä»¬çš„å­˜æ¬¾éœ€æ±‚</li></ul></li><li>æŠ•èµ„<ul><li>ä¸­å›½ä¼ä¸šçš„æŠ•èµ„å›æŠ¥ç‡åœ¨ä¸‹é™</li></ul></li></ul><h3 id="äº§èƒ½è¿‡å‰©">äº§èƒ½è¿‡å‰©</h3><p>ä¸­å›½ç»æµé¢ä¸´äº§èƒ½è¿‡å‰©çš„ä¸»è¦è¡Œä¸š</p><ul><li>é’¢é“ï¼Œæ°´æ³¥ï¼Œç”µè§£é“ï¼Œå¹³æ¿ç»ç’ƒï¼Œé€ èˆ¹</li><li>æ±½è½¦è¡Œä¸š</li><li>æ–°èƒ½æºè¡Œä¸šï¼šå…‰ä¼ï¼Œé£ç”µ</li></ul><p>äº§èƒ½è¿‡å‰©çš„ä¸‰ä¸ªåŸå› </p><ul><li>ä¸­å¤®æ”¿åºœå’Œåœ°æ–¹æ”¿åºœè´£ä»»ä¸å¯æ¨å¸<ul><li>ä¸­å¤®æ”¿åºœåœ¨è§„åˆ’ä¸­ï¼Œç‚¹åäº†æŸäº›è¡Œä¸šï¼Œå°±ä¼šå¯¼è‡´åœ°æ–¹æ”¿åºœè¿‡åˆ†å®è·µï¼Œä»è€Œèµ„é‡‘èµ„æºå¤§é‡æ¶Œå…¥ï¼Œç«‹é©¬å¯¼è‡´è¡Œä¸šçš„äº§èƒ½è¿‡å‰©</li></ul></li><li>ä¼ä¸šæœ¬èº«ä¸å¯æ¨å¸<ul><li>ä¼ä¸šä¹è§‚è®¤ä¸ºä¸­å›½ç»æµçš„é«˜é€Ÿå¢é•¿ä¼šä¸€ç›´æŒç»­ï¼Œå› æ­¤ç–¯ç‹‚æ‰©å¼ </li><li>ç–¯ç‹‚çš„æ‰©å¼ ï¼ŒæœŸæœ›è·å¾—æ”¿åºœçš„éšå½¢æ‹…ä¿</li></ul></li><li>é‡‘èåˆ¶åº¦çš„ä¸å®Œå–„<ul><li>ç ´äº§åˆ¶åº¦ï¼Œç¼ºä¹åˆç†çš„é€€å‡ºåˆ¶åº¦</li><li>åªè¦å›½å†…çš„åˆ©ç‡æ°´å¹³å’Œäººæ°‘å¸æ±‡ç‡è¿˜å—åˆ°ç®¡åˆ¶ï¼Œé‚£ä¹ˆå¸‚åœºå°†æ— æ³•æœ€å¤§é™åº¦åœ°å‘æŒ¥å…¶é…ç½®èµ„æºçš„åŠŸèƒ½</li></ul></li></ul><h3 id="å›½æœ‰ä¼ä¸šæ¦‚è²Œ">å›½æœ‰ä¼ä¸šæ¦‚è²Œ</h3><p>ä¸­å›½å›½æœ‰ä¼ä¸šè§„æ¨¡å®å¤§çš„åŸå› (ç°åœ¨ä¼¼ä¹äº’è”ç½‘å…¬å¸å·²ç»è¶…è¿‡è¿™äº›å›½æœ‰ä¼ä¸šäº†)</p><ul><li>å®è§‚ç»æµå› ç´ ï¼Œä¸­å›½ç»æµå¤§ç›˜å‘å±•å¾ˆå¥½</li><li>å›½å®¶æ”¿ç­–çš„å¯¼å‘</li></ul><p>å›½æœ‰ä¼ä¸šçš„ä¼˜åŠ¿</p><ul><li>ä¸šåŠ¡è§„æ¨¡å¤§</li><li>å“ç‰Œç›¸å¯¹æ°‘ä¼è¾ƒç¡¬</li><li>è¡Œä¸šå…·æœ‰å„æ–­ç‰¹æ€§</li></ul><p>å›½æœ‰ä¼ä¸šçš„åŠ£åŠ¿</p><ul><li>å®ç°çš„ç›®æ ‡å¤šå…ƒåŒ–ï¼Œä¸èƒ½åˆ©æ¶¦æœ€å¤§åŒ–ï¼Œæå‡è¿è¡Œæ•ˆç‡</li><li>æ”¿åºœå’Œå›½æœ‰ä¼ä¸šå…³è”å¤ªå¤§ï¼Œä»•é€”ä¸Šå‡æ¯”ä¼ä¸šåˆ©æ¶¦æœ€å¤§åŒ–æ›´è¦</li><li>ä¸­å¤®è®¡åˆ’è€…å¾ˆéš¾æ”¶é›†å›½æœ‰ä¼ä¸šçœŸå®çš„è¿è¥ä¿¡æ¯</li><li>å› ä¸ºä¸€è‚¡ç‹¬å¤§ï¼Œå…¬å¸æ²»ç†ç¼ºå¤±</li><li>è´Ÿå€ºè¿‡é«˜ï¼Œæ æ†è¿‡é«˜</li></ul><p>å¯¹æ¯”ä¸Šé¢ï¼Œå›½æœ‰çš„åŠ£åŠ¿ï¼Œå¯ä»¥æƒ³åƒåˆ°å›½æœ‰ä¼ä¸šæ”¹é©æ–¹å‘æœ‰</p><ul><li>å‰Šå‡å€ºåŠ¡ï¼Œå»æ æ†</li><li>åˆ©ç‡åŒ–å¸‚åœºæ”¹é©ï¼Œå¢åŠ å›½ä¼çš„èèµ„éš¾åº¦ï¼Œä¿ƒè¿›æŠ•èµ„çš„æ•ˆç‡ï¼Œä¹Ÿå¯ä»¥å»æ æ†</li><li>æ”¾æ¾è¡Œä¸šç®¡åˆ¶å’Œæ”¿ç­–é™åˆ¶ï¼Œè®©æ°‘ä¼æ›´å¤šå‚ä¸åˆ°ä¸å›½ä¼çš„ç«äº‰ä¸­</li><li>å®Œå–„å›½ä¼ä¿¡æ¯æŠ«éœ²åˆ¶åº¦å’Œè€ƒè¯„åˆ¶åº¦</li><li>æ³•åˆ¶æ”¹é©ï¼Œåˆ’æ¸…æ”¿åºœå’Œå¸‚åœºçš„ç•Œé™</li></ul><h3 id="å·«æœ¯ç»Ÿè®¡å­¦">å·«æœ¯ç»Ÿè®¡å­¦</h3><p>ä¸­å›½å®˜æ–¹çš„ç»Ÿè®¡æ•°æ®çµæ´»æ€§å¾ˆå¤§ã€‚<code>ç ”ç©¶ä¸€é¡¹æ•°æ®æŒ‡æ ‡ï¼Œå¿…é¡»è¦æ˜ç™½æŒ‡æ ‡çš„å…·ä½“è®¡ç®—æ–¹å¼</code></p><h3 id="æ€»ç»“">æ€»ç»“</h3><p>ä¸­å›½ç»æµå–å¾—æˆåŠŸçš„åŸå› </p><ul><li>æ”¹é©å¼€æ”¾ç­‰åˆ¶åº¦çš„ä¿è¯</li><li>æ”¿åºœå¯¹æµåŠ¨æ€§çš„æ³¨å…¥çš„ä¿è¯</li><li>æ”¿åºœå¯¹æŠ•èµ„æ”¶ç›Šçš„ä¿è¯</li></ul><p>ä¸­å›½ç»æµèµ°å‡ºå›°å¢ƒçš„æ–¹å¼</p><ul><li>å¸‚åœºåœ¨èµ„æºé…ç½®ä¸­èµ·å†³å®šæ€§ä½œç”¨</li><li>è°ƒæ•´æ”¿åºœå’Œå¸‚åœºçš„å…³ç³»</li><li>åŠ å¼ºæ³•åˆ¶å»ºè®¾ï¼Œå®ç°â€œä¹°è€…è‡ªè´Ÿï¼Œå–è€…æœ‰è´£â€</li><li>åª’ä½“ç›‘ç£æ”¿åºœå’Œå¸‚åœºçš„å…³ç³»</li><li>æ”¿åºœé€€å‡º<ul><li>é™ä½è´§å¸ä¾›åº”é‡</li><li>åˆ©ç‡å¸‚åœºåŒ–</li><li>èµ„æœ¬é¡¹ä¸‹æ”¾</li><li>é€€å‡ºæˆ¿ä»·ä¿éšœ</li><li>é€€å‡ºè‚¡ç¥¨å¸‚åœºä¿éšœ</li><li>åŠ å¼ºå½±å­é“¶è¡Œï¼ŒP2Pç›‘ç®¡</li><li>ä¸­å¤®æ”¿åºœé€€å‡ºå¯¹åœ°æ–¹æ”¿åºœçš„å€ºåŠ¡æ‹…ä¿</li></ul></li></ul><h2 id="æ‘˜è¦">æ‘˜è¦</h2><ul><li>å¦‚æœä¼ä¸šçš„ç»è¥è€…é¢„è®¡è´§å¸ä¾›åº”ä¼šè¶Šæ‹‰è¶Šå®½æ¾ï¼Œé‚£ä¹ˆä¸€å®šå¯ä»¥é¢„æµ‹åˆ°ï¼Œèµ„äº§ä»·æ ¼å‡ºç°æ˜æ˜¾çš„ä¸Šæ¶¨ã€‚åœ¨å¯¹å›½å®¶çš„é€šèƒ€æ°´å¹³å’Œèµ„äº§ä»·æ ¼æœ‰å¦‚æ­¤çš„é¢„æœŸä¹‹ä¸‹ï¼Œä¼ä¸šç»è¥è€…åˆä¹é€»è¾‘çš„åšæ³•å°±æ˜¯å¤§è§„æ¨¡å€Ÿå…¥å€ºåŠ¡å’Œæ‰©å¼ è‡ªå·±çš„èµ„äº§å’Œäº§èƒ½ï¼Œä»¥æœŸå¾…åœ¨ä¸‹ä¸€è½®çš„æ³¡æ²«ä¸­è·åˆ©ã€‚å¾ˆå¤šå¼€å§‹è¢«è®¤ä¸ºæ˜¯éå¸¸æ¿€è¿›çš„æŠ•èµ„ä¸¾æªï¼Œéšç€æ³¡æ²«çš„å¿«é€Ÿæ‰©å¼ ï¼Œäº‹åè¢«è®¤ä¸ºæ˜¯éå¸¸æ˜çŸ¥çš„ï¼Œç”šè‡³æ˜¯éå¸¸ç¥åœ£çš„ã€‚è¿™ç§æˆåŠŸæŠ¼å®çš„ç»æµæ‰©å¼ å’Œèµ„äº§ä»·æ ¼å‡å€¼çš„ç»éªŒï¼Œå¯¼è‡´ä¼ä¸šå®¶è¶Šæ¥è¶Šæœ‰ä¿¡å¿ƒè¿›è¡Œå°½å¯èƒ½çš„å›ºå®šèµ„äº§æŠ•èµ„å’Œäº§èƒ½æ‰©å¼ ã€‚</li><li>ç ´äº§æ˜¯å¯¹èµ„æºçš„é‡æ–°é…ç½®</li><li>ç ´äº§æœ¬èº«æœ€æœ‰ä»·å€¼çš„ä¸€ç‚¹ï¼Œå°±æ˜¯è®©å¸‚åœºå†³å®šå“ªäº›ä¼ä¸šå¯ä»¥å­˜æ´»å“ªäº›ä¸å¯ä»¥ï¼Œå“ªäº›èµ„äº§è¿˜æœ‰ä»·å€¼å“ªäº›æ²¡æœ‰</li><li>æ­»äº¡æ˜¯ç”Ÿå‘½æœ€ä¼Ÿå¤§çš„å‘æ˜ï¼ˆä¹”å¸ƒæ–¯ï¼‰</li></ul><h1 id="è„šæ³¨">è„šæ³¨</h1><aside id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr><ol><li id="fn1"><p>å·´å¡å°”åè®®è¦æ±‚é“¶è¡Œçš„è‡ªæœ‰åŸºæœ¬é‡‘å¿…é¡»è¾¾åˆ°æ€»èµ„äº§è§„æ¨¡çš„ç™¾åˆ†ä¹‹å…«ã€‚<a href="#fnref1" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li></ol></aside><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> æŠ•èµ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®è§‚æŠ•èµ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Trace, off-policy, on-policy</title>
      <link href="/2020/06/30/trace/"/>
      <url>/2020/06/30/trace/</url>
      
        <content type="html"><![CDATA[<h2 id="æ‘˜è¦">æ‘˜è¦</h2><p>åœ¨è¿™ç¯‡blogä¸­ï¼Œæˆ‘ä»¬ä¼šä»‹ç»å‡ ä¸ªtraceæŠ€å·§ï¼ŒåŒæ—¶ä»‹ç»ç ”ç©¶äººå‘˜å¦‚ä½•ç”¨traceæ¥æŠŠoff-policyçš„æ•°æ®çº æ­£æ¥è®¡ç®—å…³äºon-policyçš„objectiveã€‚<a id="more"></a></p><h2 id="tdlambda-å’Œ-eligibility-traces-4">TD(<span class="math inline">\(\lambda\)</span>) å’Œ Eligibility Traces [^4]</h2><!-- ### ç®€ä»‹ --><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œåœ¨å¼ºåŒ–å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ä¼°è®¡valuefunctionï¼Œä¹Ÿå°±æ˜¯è¦è®¡ç®—ä¸‹é¢<span class="math inline">\(G_t\)</span>çš„æ•°å­¦æœŸæœ›ã€‚ <span class="math display">\[G_t = R_{t+1} + \gamma R_{t+2} + \cdots + \gamma^{T-t-1}R_T\]</span> é‚£ä¹ˆå¾ˆè‡ªç„¶çš„æœ‰ä¸¤ç§æµæ´¾ï¼š</p><ul><li>ç¬¬ä¸€ç§å°±æ˜¯æ¯æ¬¡å®Œå¤‡åœ°æ”¶é›†<span class="math inline">\(R_{t+1},\cdots,R_T\)</span>è¿™äº›æ•°æ®ï¼Œç„¶åä¸æ–­é‡å¤ï¼Œæœ€åè®¡ç®—å‡ºä¸€ä¸ªsamplemeanï¼Œè¿™å°±æ˜¯å®Œå…¨çš„åŸºäºreturnçš„æ–¹å¼ã€‚å› ä¸ºå®Œå¤‡åœ°è·å–æ•°æ®éœ€è¦ä¸æ–­çš„è’™ç‰¹å¡ç½—æ¨¡æ‹Ÿæ•´ä¸ªè¿‡ç¨‹ï¼Œæ‰€ä»¥ä¹Ÿç§°ä¹‹è’™ç‰¹å¡ç½—æ–¹æ³•ã€‚</li><li>ç¬¬äºŒç§å°±æ˜¯æˆ‘ä»¬åªæ¨¡æ‹Ÿåˆ°æŸä¸€æ­¥ï¼Œå‰©ä¸‹çš„éƒ¨åˆ†ç”¨ä¸€ä¸ªå‡½æ•°å»è¿‘ä¼¼ï¼Œç„¶åæ•´ä¸ªè¿‡ç¨‹bootstrapã€‚åœ¨æœ€æç«¯çš„æƒ…å†µä¸‹ï¼Œå°±æ˜¯åªæ¨¡æ‹Ÿä¸€æ­¥ï¼Œå‰©ä¸‹å…¨éƒ¨ç”¨å‡½æ•°æ¥è¿‘ä¼¼:<span class="math inline">\(G_t=R_{t+1}+\gamma V(S_{t+1})\)</span></li></ul><p>å½“ç„¶è¿™è¾¹æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªæ¯”è¾ƒgeneralçš„åšæ³•ï¼Œå°±æ˜¯æ¨¡æ‹Ÿ <span class="math inline">\(n\)</span> æ­¥ã€‚æˆ‘ä»¬å¯ä»¥å®šä¹‰<span class="math inline">\(n\)</span>æ­¥returnçš„æ¦‚å¿µï¼Œ <span class="math display">\[G_t^{t+n}=R_{t+1}+\gamma R_{t+2}+\cdots+\gamma^{n-1}R_{t+n}+\gamma^nV(S_{t+n}) \tag{1}\]</span> å³æ‰€è°“çš„ä¸­åº¸ä¹‹é“ã€‚å½“ç„¶å› ä¸º<span class="math inline">\(n\)</span>æ­¥çš„returnåœ¨å®é™…æ“ä½œä¸­çš„èŠ±è´¹ä¼šæ¯”è¾ƒå¤§ï¼Œå› ä¸ºæ¯æ¬¡éƒ½éœ€è¦å‘å‰æ¨¡æ‹Ÿ<span class="math inline">\(n\)</span>æ­¥ã€‚å› æ­¤äººä»¬æå‡ºæ¥äº†<span class="math inline">\(TD(\lambda)\)</span>ã€‚</p><h3 id="tdlambda"><span class="math inline">\(TD(\lambda)\)</span></h3><p>åœ¨æ–¹ç¨‹.(1)çš„åŸºç¡€ä¸Šï¼Œåšè¿›ä¸€æ­¥çš„æ”¹è¿›ï¼Œè€ƒè™‘ä¸€ç§ç‰¹æ®Šçš„çº¿æ€§ç»“åˆçš„æ–¹å¼ç»“åˆèµ·æ¥æ‰€æœ‰çš„<span class="math inline">\(n\)</span>æ­¥returnï¼Œä¾‹å¦‚ï¼Œ <span class="math display">\[L_t(\lambda) = (1-\lambda)\sum_{n=1}^{+\infty}\lambda^{n-1}G_{t}^{t+n}\]</span> å¯¹äºåœ¨æœ‰é™æ­¥<span class="math inline">\(T\)</span>èƒ½å¤Ÿç»“æŸçš„æ¸¸æˆï¼Œæˆ‘ä»¬åšä¸€ä¸ªæˆªæ–­ï¼Œ <span class="math display">\[L_t(\lambda) = (1-\lambda)\sum_{n=1}^{T-t-1}\lambda^{n-1}G_{t}^{t+n} +\lambda^{T-t-1}G_t.\]</span> é€šå¸¸æ„ä¹‰ä¸Šï¼Œäººä»¬ç§°è¿™ç§å®šä¹‰ä¸‹çš„returnä¸º<span class="math inline">\(\lambda\)</span>-return</p><h3 id="eligibility-trace">Eligibility Trace</h3><p>ä»<span class="math inline">\(\lambda\)</span>-returnçš„å®šä¹‰ï¼Œä¼¼ä¹æ¯”<span class="math inline">\(n\)</span>æ­¥çš„returnæ›´åŠ å¤æ‚ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦æ¨¡æ‹Ÿå‡ºæ‰€æœ‰çš„æ¸¸æˆæ­¥éª¤ã€‚å¹¸è¿çš„æ˜¯ï¼Œèªæ˜çš„ç ”ç©¶äººå‘˜è¯æ˜äº†ä¸‹é¢çš„è®¡ç®—æ–¹å¼ç­‰ä»·äºä¸Šé¢çš„å®šä¹‰ã€‚ä¸ºäº†æ›´å¥½çš„è¡¨è¾¾ï¼Œæˆ‘ä»¬å¼•å…¥Eligibilitytraceé€šè¿‡å®šä¹‰å…¶æ›´æ–°æ–¹å¼: <span class="math display">\[E_{t}(s) = \gamma\lambda E_{t-1}(s) + I_{s=S_t}\]</span> åœ¨è¿™äº›ç¬¦å·ä¸‹ï¼Œé‚£ä¹ˆæ¯æ­¥æ›´æ–°åªéœ€è¦TD errorå’Œeligibility traceï¼Œ<span class="math display">\[\Delta V_t(s) = \alpha \delta_t E_t(s), \delta_t = R_{t+1} + \gammaV_{t}(S_{t+1}) - V_t(S_t)ã€‚\]</span>è¿™è¾¹æˆ‘ä»¬ä¸åšä¸¥æ ¼çš„æ•°å­¦è¯æ˜ã€‚ä»…ä»…ç»™å‡ºä¸€ä¸ªç›´è§‰ä¸Šç†è§£æ–¹å¼ã€‚è®©æˆ‘ä»¬é¦–å…ˆå¿˜è®°å¼ºåŒ–å­¦ä¹ è¿™ä»¶äº‹ï¼Œè€ƒè™‘ä¸€ä¸ªç®€å•çš„caseï¼Œæˆ‘ä»¬æƒ³è¦ä¼°è®¡ä¸€ä¸ªç¡¬å¸æ­£é¢å‘ä¸Šçš„æ•°å­¦æœŸæœ›é€šè¿‡ä¸æ–­æŠ›ç¡¬å¸ã€‚å‡è®¾åœ¨æŠ›äº†<span class="math inline">\(n\)</span>æ¬¡ä¹‹åï¼Œæˆ‘ä»¬çš„ä¼°è®¡ç»“æœæ˜¯<span class="math inline">\(p_n\)</span>ï¼Œç„¶åæˆ‘ä»¬å†æŠ›ä¸€æ¬¡ï¼Œè¯•å›¾å»æ›´æ–°ä¼°è®¡ã€‚æœ€trivialçš„æ–¹å¼å°±æ˜¯ï¼Œ<span class="math display">\[p_{n+1} = (1-\lambda)p_n + \lambdaI_{up}\]</span> è¿™è¾¹<span class="math inline">\(I_{up}\)</span>æ„å‘³å¦‚æœç¬¬<span class="math inline">\(n+1\)</span>ç»“æœæ˜¯å‘ä¸Šï¼Œé‚£ä¹ˆå–1ï¼Œå¦åˆ™å–0ã€‚è¿™ä¸æ˜¯å’Œä¸Šé¢çš„è¿‡ç¨‹æœ‰æŸç§ç±»ä¼¼ï¼Ÿç°åœ¨æˆ‘ä»¬æ€è€ƒeligibilitytraceåšäº†ä»€ä¹ˆï¼Œé‚£ä¹ˆå°±æ¯”è¾ƒç®€å•äº†ã€‚å…¶å®å°±å¯¹äºé‡‡æ ·åˆ°çš„ç»“æœæœ‰äº†ä¸€ä¸ªclickï¼Œè¿™è¾¹å°±æ˜¯é‡‡å–çš„åŠ 1çš„æ–¹å¼ï¼Œç„¶åéšç€æ—¶é—´çš„æµå¤±ï¼Œè¿™äº›ç»“æœçš„å½±å“åŠ ä¸Šäº†discountã€‚è¿™è¾¹éœ€è¦å¼ºè°ƒçš„discountå¹¶ä¸å…·æœ‰çœŸæ­£æ„ä¹‰æ—¶é—´åºçš„å…³ç³»ï¼Œæ›´å¤šçš„æ˜¯ä¸ºäº†æ»¡è¶³normalizationï¼Œè¿™æ ·å¯ä»¥ä¿è¯ä¼°è®¡å­çš„consistencyã€‚</p><h2 id="ä½¿ç”¨å„ç§traceæ¥é“¾æ¥off-policyå’Œon-policy">ä½¿ç”¨å„ç§traceæ¥é“¾æ¥off-policyå’Œon-policy</h2><h3 id="summary">Summary</h3><p>åœ¨è¿™ä¸ªéƒ¨åˆ†ï¼Œæˆ‘ä¼šè€ƒè™‘å¦‚ä½•ä½¿ç”¨traceçš„æŠ€å·§æ¥å¼¥è¡¥off-policyå’Œon-policyçš„å·®è·ã€‚æ¯”å¦‚æˆ‘ä»¬çš„æ•°æ®æ˜¯ä»ç­–ç•¥<span class="math inline">\(\mu\)</span>ä¸­è€Œæ¥ï¼Œä½†æˆ‘ä»¬çš„ç›®æ ‡æ˜¯è¦ä¼°è®¡<span class="math inline">\(Q^{\pi}\)</span>è€Œé<span class="math inline">\(Q^{\mu}\)</span>,é‚£æˆ‘ä»¬éœ€è¦æ€ä¹ˆåšå‘¢ã€‚æœ€ç®€å•çš„å’Œæˆ‘ä»¬ä¹‹å‰æ‰€è®¨è®ºä¸€æ ·ä½¿ç”¨importancesamplingã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ¯”è¾ƒgeneralçš„æ“ä½œï¼Œ <span class="math display">\[\mathcal{R}Q(s,a):=Q(s,a)+E_{\mu}\left[\sum_{t\ge 0}\gamma^t(\prod_{s=1}^tc_s)(r_t+\gamma E_{\pi}Q(s_{t+1},\cdot)-Q(s_t,a_t))\right]\]</span></p><ul><li>Importance Sampling [^3] (<span class="math inline">\(c_s=\frac{\pi(a_s|s_s)}{\mu(a_s|s_s)}\)</span>)æ˜¾ç„¶æˆ‘ä»¬å¯ä»¥çº æ­£off-policyï¼Œä½†æ˜¯è¿™ç§åšæ³•æœ‰ä¸ªé—®é¢˜ï¼Œå°±æ˜¯åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œ<span class="math inline">\(\frac{\pi(a_s|s_s)}{\mu(a_s|s_s)}\)</span>æœ‰å¾ˆé«˜çš„æ–¹å·®ï¼Œå°±ä¼šå¯¼è‡´ç®—æ³•å¾ˆä¸ç¨³å®šã€‚</li><li>Off-policy <span class="math inline">\(Q^{\pi}(\lambda),Q^{*}(\lambda)\)</span> [^5] (<span class="math inline">\(c_s=\lambda\)</span>) è¿™ç§traceéœ€è¦ç­–ç•¥<span class="math inline">\(\mu\)</span>ä¸æ˜¯é‚£ä¹ˆoff-policyã€‚é‡åŒ–æ¥è®²ï¼Œå¦‚æœ<span class="math inline">\(\epsilon=\max_s\|\pi(\cdot|s)-\mu(\cdot|s)\|_1\)</span>ï¼Œä¸ºäº†ä¿è¯<span class="math inline">\(Q^{\pi}(\lambda)\)</span>æ”¶ç¼©æ€§è´¨ï¼Œ<span class="math inline">\(\lambda &lt;\frac{1-\gamma}{\gamma\epsilon}\)</span>; ä¸ºäº†ä¿è¯<span class="math inline">\(Q^{*}(\lambda)\)</span>çš„æ”¶ç¼©æ€§è´¨ï¼Œ<span class="math inline">\(\lambda &lt;\frac{1-\gamma}{2\gamma}\)</span>ã€‚</li><li>Tree-backup, TB(<span class="math inline">\(\lambda\)</span>) <span class="math inline">\((c_s=\lambda\pi(a_s|s_s))\)</span>è¿™ç§æ–¹å¼å¯ä»¥ä¿è¯ä»»æ„çš„off-policyéƒ½èƒ½æ”¶æ•›ï¼Œä½†æ˜¯å¾ˆæ˜æ˜¾ï¼Œå¦‚æœ<span class="math inline">\(\mu\)</span>å’Œ<span class="math inline">\(\pi\)</span>å¾ˆæ¥è¿‘ï¼Œé‚£ä¹ˆæ•ˆç‡å°±ä¼šå¾ˆä½ï¼Œå› ä¸º<span class="math inline">\(c_s\)</span>ä¸€ç›´discounté‡‡æ ·çš„æ•ˆç‡ï¼Œè€Œåœ¨è¿™ç§æƒ…å†µé€‚åˆçš„<span class="math inline">\(c_s\)</span>åº”è¯¥åœ¨<span class="math inline">\(1\)</span>é™„è¿‘ã€‚</li><li>Retrace(<span class="math inline">\(\lambda\)</span>)[^1] (<span class="math inline">\(c_s=\lambda \min\left(1,\frac{\pi(a_s|s_s)}{\mu(a_s|s_s)}\right)\)</span>)è¿™ä¸ªæ–¹æ³•å°±æ˜¯ç»¼åˆäº†ä¸Šé¢ä¸‰ä¸ªæ–¹æ³•çš„ç‰¹ç‚¹ã€‚<ul><li>ç»™äº†traceä¸€ä¸ªboundï¼Œé™åˆ¶äº†æ–¹å·®</li><li>on-policyçš„æ—¶å€™ï¼Œæ²¡æœ‰ä¸€ç›´discount trace</li><li>off-policyçš„æ—¶å€™ï¼Œé™åˆ¶äº†traceã€‚</li></ul></li><li>V-trace [^2] (<span class="math inline">\(c_s=\min(\lambda,\frac{\pi(a_s|s_s)}{\mu(a_s|s_s)})\)</span>)</li></ul><p>V-traceé™¤äº†ç”¨äº†ä¸€ä¸ªä¸åŒçš„traceï¼Œè¿˜ç›´æ¥æŠŠtemporaldifferenceåšäº†çº æ­£ï¼Œå³æ˜ å°„ç”¨çš„æ˜¯ï¼Œ <span class="math display">\[\mathcal{R}Q(s,a):=Q(s,a)+E_{\mu}\left[\sum_{t\ge 0}\gamma^t(\prod_{s=1}^tc_s)\rho_t(r_t+\gammaE_{\pi}Q(s_{t+1},\cdot)-Q(s_t,a_t))\right],\]</span> è¿™è¾¹<span class="math inline">\(\rho_t\)</span>æ˜¯ä¸€ä¸ªè¢«æˆªæ–­ISçº æ­£ï¼Œ<span class="math inline">\(\rho_t=\min(\bar{\rho},\frac{\pi(a_t|s_t)}{\mu(a_t|s_t)})\)</span>å¹¶ä¸”<span class="math inline">\(\bar{\rho}\ge\lambda \ge1\)</span>ã€‚ä½œè€…å£°ç§°çš„ä¸€ä¸ªå¥½å¤„æ˜¯åœ¨å®Œå…¨on-policyçš„æ—¶å€™ï¼ŒV-traceå¯ä»¥å®Œå…¨å¤åŸä¹Ÿå°±æ˜¯<span class="math inline">\(\rho_t=c_s=1\)</span>ï¼Œä½†æ˜¯Retraceä¸å¯ä»¥<span class="math inline">\(c_s=\lambda\)</span>ã€‚</p><h3 id="æ•°å­¦å®šç†">æ•°å­¦å®šç†</h3><p>ä¸‹é¢æ˜¯ä¸¤ä¸ªé‡è¦çš„æ•°å­¦å®šç†ï¼Œä»ç†è®ºçš„è§’åº¦ä¿è¯äº†è¿™äº›traceæŠ€å·§çš„å¯è¡Œæ€§ã€‚[^1]</p><h4 id="theorem-1">Theorem 1</h4><p>The operator <span class="math inline">\(\mathcal{R}\)</span> has auniqued fixed point <span class="math inline">\(Q^{\pi}\)</span>. If foreach <span class="math inline">\(a_s\)</span> and history <span class="math inline">\(\mathcal{F}_s\)</span> we have <span class="math inline">\(c_s=c_s(a_s,\mathcal{F}_s) \in [0,\frac{\pi(a_s|s_s)}{\mu(a_s|s_s)}]\)</span>, then for any function <span class="math inline">\(Q\)</span>, <span class="math display">\[\|\mathcal{R}Q-Q^{\pi}\| \le \gamma \|Q-Q^{\pi}\|\]</span></p><h4 id="definition">Definition</h4><p>We say that a sequence of policies <span class="math inline">\(\pi\)</span> is increasingly greedy a sequence<span class="math inline">\(Q_k\)</span> of Q functions if the followingproperty holds for all <span class="math inline">\(k\)</span>: <span class="math inline">\(P^{\pi_{k+1}}Q_{k+1} \geP^{\pi_k}Q_{k+1}\)</span>, where operator <span class="math inline">\(P\)</span> is defined as, <span class="math display">\[P^{\pi}Q(s,a) =\sum_{s',a'}\pi(a'|s')p(s'|s,a)Q(s',a')\]</span></p><h4 id="thoerem-2">Thoerem 2</h4><p>Consider an arbitrary sequence of behaviour policies <span class="math inline">\(\mu_k\)</span> and a sequence of target policies<span class="math inline">\(\pi_k\)</span> that are increasingly greedyw.r.t. the sequence <span class="math inline">\(Q_k\)</span>: <span class="math display">\[Q_{k+1} = \mathcal{R}_k Q_k\]</span> where <span class="math inline">\(\mathcal{R}_k\)</span> isfor <span class="math inline">\(\pi_k, \mu_k\)</span> and a<strong>Markovian</strong> <span class="math inline">\(c_s=c(a_s,s_s)\in[0, \frac{\pi(a_s|s_s)}{\mu(a_s|s_s)}]\)</span>. Assume the targetpolicies <span class="math inline">\(\pi_k\)</span> are <span class="math inline">\(\epsilon_k\)</span>-away from the greedy policiesw.r.t. <span class="math inline">\(Q_k\)</span>, in the sense that <span class="math inline">\(\mathcal{T^{\pi_k}}Q_k \ge \mathcal{T}Q_k-\epsilon_k\|Q_k\|e\)</span>, where <span class="math inline">\(e\)</span> is the vector with <span class="math inline">\(1\)</span>-components, and <span class="math display">\[\mathcal{T}^{\pi}Q:=r+\gamma P^{\pi}Q, \mathcal{T}Q := r + \gamma\max_{\pi}P^{\pi}Q\]</span> Furthermore suppose <span class="math inline">\(\mathcal{T}^{\pi_0}Q_0 \ge Q_0\)</span>. Then forany <span class="math inline">\(k\ge0\)</span>, <span class="math display">\[\|Q_{k+1}-Q^{*}\| \le \gamma \|Q_k -Q^*\| + \epsilon_k \|Q_k\|\]</span> In consquence, if <span class="math inline">\(\epsilon_k \to0\)</span>, then <span class="math inline">\(Q_k \to Q^*\)</span>.</p><h2 id="reference">Reference</h2><p>[^1] Munos, RÃ©mi, et al. "Safe and efficient off-policy reinforcementlearning." Advances in Neural Information Processing Systems. 2016. [^2]Espeholt, Lasse, et al. "Impala: Scalable distributed deep-rl withimportance weighted actor-learner architectures." arXiv preprintarXiv:1802.01561 (2018). [^3] Precup, Doina. "Eligibility traces foroff-policy policy evaluation." Computer Science Department FacultyPublication Series (2000): 80. [^4] Sutton, Richard S., and Andrew G.Barto. Introduction to reinforcement learning. Vol. 135. Cambridge: MITpress, 1998. APA [^5] Harutyunyan, Anna, et al. "Q (<span class="math display">\[\lambda \]</span>) with Off-Policy Corrections."International Conference on Algorithmic Learning Theory. Springer, Cham,2016. APA</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> äººå·¥æ™ºèƒ½ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¼ºåŒ–å­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸‰ä¸ªåˆ†å¸ƒå¼RLç®—æ³•</title>
      <link href="/2020/06/29/disoptimzer/"/>
      <url>/2020/06/29/disoptimzer/</url>
      
        <content type="html"><![CDATA[<p>ç®€å•ä»‹ç»ä¸€ä¸‹ä¸‰ä¸ªåˆ†å¸ƒå¼ç®—æ³• <a id="more"></a> ## Apex(Distributedprioritized experience replay)</p><h3 id="per">PER</h3><p>åœ¨ä»‹ç»åˆ†å¸ƒå¼çš„PERä¹‹å‰ï¼Œå…ˆç®€å•ä»‹ç»ä¸€ä¸‹åŸå§‹ç‰ˆæœ¬çš„PER[^1].PERçš„æå‡ºä¸»è¦æ˜¯ä¸ºäº†è§£å†³å¦‚ä½•æé«˜æ•°æ®åˆ©ç”¨æ•ˆç‡çš„é—®é¢˜ã€‚æ¯”æ–¹è¯´ï¼Œä¸€ä¸ªå­¦ç”Ÿåœ¨å­¦ä¹ æ•°å­¦çš„æ—¶å€™ï¼Œä»–éœ€è¦å»åšé¢˜æ¥æé«˜ä»–çš„ç†è§£è®¤çŸ¥èƒ½åŠ›ã€‚å¾ˆç®€å•çš„ä¸€ä¸ªé—®é¢˜å°±æ˜¯ï¼Œå­¦ç”Ÿéœ€è¦åšå“ªäº›é¢˜ç›®æ‰èƒ½æ›´å¿«åœ°æé«˜ä»–çš„æ•°å­¦èƒ½åŠ›ã€‚ç›´è§‰ä¸Šï¼Œæˆ‘ä»¬è®¤ä¸ºå»ç»ƒä¹ é‚£äº›åŸæ¥ä¸ä¼šåšçš„é¢˜ç›®æ¯”ä¸€ç›´ç»ƒä¹ å·²ç»ä¼šåšçš„é¢˜ç›®å¯ä»¥æ›´æœ‰æ•ˆç‡åœ°æé«˜æ•°å­¦æ°´å¹³ã€‚PERåˆ™æ˜¯åˆ©ç”¨æ¥è¿™ä¸€ç‚¹ï¼Œé€šè¿‡æé«˜å’Œå½“å‰è®¤çŸ¥ç›¸å·®è¾ƒè¿œçš„æ•°æ®ï¼ˆè­¬å¦‚losså¾ˆå¤§ï¼‰çš„é‡‡æ ·æ¦‚ç‡ï¼Œé™ä½å’Œå½“å‰è®¤çŸ¥ç›¸è¿‘çš„æ•°æ®çš„é‡‡æ ·æ¦‚ç‡ï¼Œæ¥å¢å¼ºç®—æ³•çš„å­¦ä¹ èƒ½åŠ›ã€‚</p><p>å…·ä½“æ¥è®²ï¼Œåœ¨PERä¸­ï¼Œé€‚åº”æ¥TDerroræ¥è¡¡é‡èƒ½å¤Ÿå­¦ä¹ åˆ°çš„å†…å®¹ã€‚ç›´è§‰ä¸Šè®¤ä¸ºä»TDerrorè¶Šå¤§çš„æ•°æ®ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å­¦ä¹ åˆ°æ›´å¤šæœ‰æ•ˆçš„ä¿¡æ¯ã€‚åŒæ—¶ä¸ºäº†æé«˜é²æ£’æ€§ï¼Œå¹¶æ²¡æœ‰ç›´æ¥ä½¿ç”¨hardçš„è´ªå¿ƒç®—æ³•ï¼Œè€Œæ˜¯å¼•å…¥ä¸€ä¸ªè¶…å‚æ•°<span class="math inline">\(\alpha\)</span>æ¥è°ƒèŠ‚é‡‡æ ·çš„è´ªå¿ƒç¨‹åº¦ï¼Œä¾‹å¦‚ï¼Œ <span class="math display">\[P(i) = \frac{p_i^\alpha}{\sum_k p_k^\alpha}\]</span> å¯¹äº <span class="math inline">\(p_i\)</span>çš„é€‰å–ï¼Œæå‡ºäº†ä¸¤ç§é€‰æ‹©æ–¹æ³• <span class="math inline">\(p_i=|\delta_i|+\epsilon\)</span> æˆ–è€… <span class="math inline">\(p_i =\frac{1}{\mathrm{rank}(|\delta_i|)}\)</span>.(åœ¨å®ç°çš„æ—¶å€™ï¼Œæ–°æ”¶é›†çš„æ•°æ®å› ä¸ºæ²¡æœ‰TDerrorï¼Œæ‰€ä»¥ä¼šç»™ä¸€ä¸ªå¾ˆå¤§çš„priorityï¼Œä¿è¯èƒ½å¤Ÿè¢«é€‰ä¸­)ã€‚å¦‚æœæˆ‘ä»¬ä»”ç»†æ£€æŸ¥è¿™ä¸ªè¿‡ç¨‹ä¼šå‘ç°ï¼Œæœ‰ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ï¼Œå°±æ˜¯è®¤ä¸ºçš„æ”¹å˜äº†é‡‡æ ·æ¦‚ç‡ï¼Œé‚£ä¹ˆæœ€ç»ˆæˆ‘ä»¬ç®—å‡ºæ¥çš„æ‰€æœ‰æœŸæœ›å€¼å¹¶ä¸ä¼šæ˜¯æˆ‘ä»¬çœŸæ­£æƒ³è¦å¾—åˆ°çš„å€¼ã€‚å¯¹äºè¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥IS(importancesampling)ã€‚ ### Importance Sampling ISæœ¬è´¨æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„æŠ€å·§ã€‚æ¯”å¦‚æˆ‘ä»¬æƒ³è¦è®¡ç®—éšæœºå˜é‡<span class="math inline">\(f(X)\)</span>åœ¨åˆ†å¸ƒ<span class="math inline">\(p(x)\)</span>ä¸‹çš„æœŸæœ›å€¼<span class="math inline">\(E_p[f(X)]=\int f(x)p(x)dx\)</span>.ä½†æ˜¯ç”±äºæŸäº›åŸå› ï¼Œæˆ‘ä»¬è·å¾—çš„æ•°æ®æ˜¯åœ¨åˆ†å¸ƒ<span class="math inline">\(q(x)\)</span>ä¸‹è·å¾—çš„ï¼Œé‚£ä¹ˆæˆ‘å¯ä»¥åšä¸€ä¸ªç®€å•çš„å˜å‹ï¼Œé€šè¿‡<span class="math inline">\(q(x)\)</span>ä¸‹çš„æ•°æ®ä¾ç„¶å¯ä»¥è®¡ç®—å‡º<span class="math inline">\(E_p[f(x)]\)</span>ã€‚ <span class="math display">\[E_p[f(X)] = \int f(x)p(x)dx = \int [f(x)\frac{p(x)}{q(x)}]q(x) dx\]</span> ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åªéœ€è¦ç»™åŸå§‹çš„éšæœºå˜é‡<span class="math inline">\(f(X)\)</span>ä¸€ä¸ªæƒé‡<span class="math inline">\(\frac{p(X)}{q(X)}\)</span>å³å¯ã€‚</p><p>åœ¨å®é™…æ“ä½œè¿‡ç¨‹ä¸­ï¼Œå¼•å…¥ä¸€ä¸ªè¶…å‚æ•°<span class="math inline">\(\beta\)</span>æ¥æ§åˆ¶è¿™ä¸ªæƒé‡ï¼Œä¾‹å¦‚ï¼Œ <span class="math display">\[w_i = \left(\frac{1}{N}\frac{1}{P(i)}\right)^{\beta}\]</span> ä¸ºäº†ä¿è¯ç¨‹åºçš„ç¨³å®šæ€§ï¼Œé€šå¸¸ä¼šä¹˜<span class="math inline">\(\frac{1}{\max_iw_i}\)</span>å½’ä¸€åŒ–è¿™ä¸ªæƒé‡ã€‚æ˜¾ç„¶å¦‚æœ<span class="math inline">\(\beta=1\)</span>ï¼Œé‚£ä¹ˆè¿™ä¸ªæƒé‡å¯ä»¥å®Œå…¨çº æ­£é‡‡æ ·åˆ†å¸ƒçš„åé¢‡ã€‚å› æ­¤å°±å­˜ä¸€ä¸ªåœ¨priorityå’Œcorrectnessä¹‹é—´å­˜åœ¨ä¸€ä¸ªtradeoffã€‚åœ¨å®è·µè¿‡ç¨‹ä¸­ï¼Œå¾€å¾€é€šè¿‡åˆå§‹åŒ–ä¸€ä¸ª<span class="math inline">\(\beta_0\)</span> ç„¶åæ…¢æ…¢é€€ç«åˆ° <span class="math inline">\(1\)</span>.è¿˜æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„å°±æ˜¯ISä¹Ÿä¼šè®©æ•´ä¸ªéšæœºæ¢¯åº¦ä¸‹é™å˜å¾—æ›´åŠ çš„ç¨³å®šã€‚å› ä¸ºç»™äº†å¤§çš„æ¢¯åº¦ä¸€ä¸ªdiscountï¼Œè¿™æ ·æ›´åŠ æ»¡è¶³æ¢¯åº¦ä¸‹é™æ‰€éœ€è¦çš„localityã€‚</p><h3 id="apex">Apex</h3><p>Apexç®—æ³•åˆ™æ˜¯æŠŠä¸Šè¿°ç®—æ³•æ‹“å±•æˆåˆ†å¸ƒå¼çš„ç»“æ„ï¼Œå¦‚ä¸‹å›¾ã€‚ <img src="apex.png"></p><ul><li><p>Learner ä» Replayä¹‹é—´çš„é‡‡æ ·ä¸åé¦ˆåŠ å…¥äº†priorityã€‚</p></li><li><p>ç›¸æ¯”ä¸å•æœºå¼çš„ç®—æ³•ï¼Œåœ¨åˆ†å¸ƒå¼ç»“æ„ä¸­æ¯ä¸ªactoréœ€è¦è‡ªå·±è®¡ç®—å‡ºä¸€ä¸ªåˆå§‹çš„priorityç»™æ–°åŠ å…¥çš„æ•°æ®ã€‚å¦åˆ™å¦‚æœå’Œå•æœºå¼çš„ç®—æ³•ä¸€æ ·ï¼Œç»™æ–°çš„æ•°æ®ä¸€ä¸ªå¾ˆå¤§çš„priorityçš„è¯ï¼Œä¼šæœ‰å‡ºç°é—®é¢˜ã€‚å› ä¸ºåœ¨åˆ†å¸ƒå¼çš„ç»“æ„ä¸­ï¼Œæˆ‘ä»¬æœ‰å¾ˆå¤šçš„actorï¼Œé‚£ä¹ˆå¦‚æœæ‰€æœ‰çš„priorityéƒ½æœ‰learneræ¥æ›´æ–°ç»´æŠ¤ï¼Œé‚£ä¹ˆlearneråœ¨æ¯æ¬¡é‡‡æ ·çš„æ—¶å€™éƒ½ä¼šé€‰å–æœ€è¿‘çš„dataã€‚</p></li><li><p>å…±äº«æ•°æ®æ¯”å…±äº«æ¢¯åº¦å¯¹äºoff-policyæ¥è®²æ›´åŠ é²æ£’ã€‚</p></li><li><p>å› ä¸ºåˆ†å¸ƒå¼çš„actorï¼Œæ¯ä¸ªéƒ½å¯ä»¥æ¢ç´¢ä¸åŒçš„é¢†åŸŸï¼Œè¿™æ ·èƒ½å¤Ÿæ›´æœ‰æ•ˆè§£å†³agentçš„explore-exploittrade-off.</p></li></ul><p>Apex-DQN å¯¹ä¸€èˆ¬çš„DQNåšäº†ä¸€äº›ä¿®æ”¹ï¼Œä½¿ç”¨äº†DoubleQå’Œn-stepï¼Œå…·ä½“æ¥è¯´ï¼Œ<span class="math display">\[G_t = R_{t+1} + \gamma R_{t+2} + \cdots + \gamma^{n-1}R_{t+n} + \gamma^nq(S_{t+n}, \arg\max_a q(S_{t+n},a,\theta), \theta^-)\]</span> Apex-DDPG <span class="math display">\[G_t = R_{t+1} + \gamma R_{t+2} + \cdots + \gamma^{n-1}R_{t+n} + \gamma^nq(S_{t+n}, \pi(S_{t+n},\psi^-), \theta^-).\]</span></p><h2 id="impala">IMPALA</h2><p>IMPALAæ˜¯<strong>Imp</strong>ortance Weighted<strong>A</strong>ctor-<strong>L</strong>earner<strong>A</strong>rchitectureçš„ç¼©å†™ã€‚é¡¾åæ€ä¹‰ï¼ŒIMPALAæ¡†æ¶ä¸‹ï¼Œæœ€é‡è¦çš„ä¸¤ä¸ªç‚¹ï¼š</p><ul><li>Importance weight: V-trace</li><li>Actor-Learner æ¶æ„ï¼šå¼‚æ­¥</li></ul><h3 id="v-trace">V-trace</h3><p>V-trace å¯ä»¥å‚è€ƒå¦ä¸€ç¯‡blog <a href="/2020/06/30/trace/" title="Trace, off-policy, on-policy">Trace, off-policy, on-policy</a></p><h3 id="actor-learner">Actor-Learner</h3><p><img src="impala.png">æ­£å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå·¦è¾¹å±•ç¤ºçš„æ‹¥æœ‰å¤šä¸ªactorï¼Œä¸€ä¸ªlearnerï¼Œé‚£ä¹ˆæ¯ä¸ªactoréƒ½æŠŠè‡ªå·±é‡‡æ ·çš„æ•°æ®ä¼ ç»™åŒä¸€ä¸ªlearnerï¼Œlearnerä½¿ç”¨GPUæ›´æ–°å‚æ•°ã€‚å½“è¿™ç§æ¡†æ¶æ‰©å±•åˆ°å¤šä¸ªactorï¼Œå¤šä¸ªlearnerçš„æ—¶å€™ï¼Œå°±å¦‚å³å›¾æ‰€ç¤ºã€‚ä¸€ä¸ªlearnerå‘¨å›´æœ‰å¾ˆå¤šactorï¼Œæ¯”å¦‚ä¸€ä¸ªGPUå’Œå¤šä¸ªCPUååŒï¼Œè¿™äº›actoræŠŠè‡ªå·±é‡‡æ ·åˆ°çš„æ•°æ®å‘é€å±äºè‡ªå·±çš„learnerä¸Šå»ï¼Œä½†æ˜¯åœ¨åå‘åŒæ­¥å‚æ•°çš„æ—¶å€™ï¼Œactorå¹¶ä¸éœ€è¦ä¸€å®šæ˜¯ä»è‡ªå·±å¯¹åº”çš„learnerä¸Šå»è·å–å‚æ•°ï¼Œè€Œæ˜¯å¿«é€Ÿä»ä»»æ„learnerè·å–å‚æ•°ã€‚</p><h2 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h2><p>[^1]Schaul, Tom, et al. "Prioritized experience replay." arXivpreprint arXiv:1511.05952 (2015).</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> äººå·¥æ™ºèƒ½ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¼ºåŒ–å­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é‡å­å‚…ç«‹å¶å˜æ¢</title>
      <link href="/2020/06/18/qft/"/>
      <url>/2020/06/18/qft/</url>
      
        <content type="html"><![CDATA[<p>ç»å…¸çš„å‚…ç«‹å¶å˜æ¢ï¼Œæ— è®ºå¯¹å·¥ç¨‹åº”ç”¨è¿˜æ˜¯æ•°æ®ç§‘å­¦ï¼Œéƒ½äº§ç”Ÿäº†æ·±è¿œã€‚å› æ­¤å¯¹äºé‡å­è®¡ç®—æœºæ¥è¯´ï¼Œå¦‚ä½•å®æ–½å‚…ç«‹å¶å˜æ¢ä¹Ÿæ˜¯å¾ˆé‡è¦çš„äº‹æƒ…<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>ã€‚ <a id="more"></a>ç¦»æ•£å‚…ç«‹å¶å˜æ¢ï¼Œæ˜¯å°†ä¸€ç»„æŒ¯å¹… <span class="math inline">\(\{x_j\}\)</span>ï¼Œé€šè¿‡å¦‚ä¸‹çš„å˜æ¢ï¼Œè½¬æ¢æˆå¦ä¸€ç»„å…±è½­çš„æŒ¯å¹… <span class="math inline">\(\{\tilde{x}_k\}\)</span> , <span class="math display">\[ \tilde{x}_k =\frac{1}{\sqrt{N}}\sum_{j=1}^{N}e^{i\frac{2j\pi}{N}k}x_j\tag{1}\]</span>å¯¹äºé‡å­è®¡ç®—æœºè€Œè¨€ï¼Œè¿™äº›éƒ½æ˜¯ç¼–ç çš„æ¦‚ç‡å¹…ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬åªè¦å¯¹computationalbasisåšå‚…ç«‹å¶å˜æ¢ï¼Œä¾‹å¦‚ï¼š <span class="math display">\[|\tilde{k}\rangle= \frac{1}{\sqrt{N}}\sum_{j=1}^{N}e^{i\frac{2\pi j}{N}k}|j\rangle\tag{2}\]</span>æ¯”è¾ƒå®¹æ˜“è§‚å¯Ÿåˆ°ï¼Œè¿™ç»„å˜æ¢æ˜¯unitaryçš„ã€‚æ—¢ç„¶å¦‚æ­¤ï¼Œæˆ‘ä»¬å°±å¸Œæœ›æ‰¾åˆ°ä¸€ç§ç‰©ç†å®ç°ã€‚åœ¨è°ˆå…·ä½“å®ç°ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥ç›´è§‰ä¸Šæ€è€ƒä¸€äº›äº‹æƒ…ã€‚1ï¼‰å¯¹äºä¸€ä¸ªn-qbitçš„é‡å­è®¡ç®—æœºï¼Œ$N=2^n ï¼Œ j=j_{n-1}j_{n-2}j_0$ï¼Œåè€…æˆ‘ä»¬ç”¨äº†äºŒè¿›åˆ¶ä¸²ã€‚2ï¼‰åŒæ—¶æˆ‘ä»¬éœ€è¦æ„è¯†åˆ°ï¼Œä»¥ <span class="math inline">\(2\pi\)</span> ä¸ºå•ä½ï¼Œæ¯æ¬¡è½¬åŠ¨çš„è§’åº¦æ˜¯ <span class="math inline">\(\frac{1}{2^n}\)</span> ï¼Œå¯¹äºæ‰€æœ‰çš„ <span class="math inline">\(j\)</span> ï¼Œæ­£å¥½è¦†ç›–äº†æ‰€æœ‰<span class="math inline">\(n\)</span>æ¯”ç‰¹é•¿åº¦çš„å°æ•°ï¼Œ <span class="math inline">\(\sum_{k=0}^{n-1}j_k2^{k-n}\)</span>ï¼Œå¦‚æœæˆ‘ä»¬è¯»å–äº†é‡å­æ€çš„ç›¸ä½ï¼Œé‚£ä¹ˆå¯ä»¥å¾ˆå¥½çš„çŸ¥é“ <span class="math inline">\(k\)</span> ï¼Œè¿™ä¸ºåé¢çš„å¾ˆå¤šç®—æ³•åšäº†å¥ åŸºå·¥ä½œã€‚åŸºäºä¸Šé¢çš„æˆ‘ä»¬å¯ä»¥ç»™å‡ºEq.(2)çš„ç­‰ä»·æè¿°ï¼Œ <span class="math display">\[|j_{n-1}j_{n-2}\cdots j_0\rangle \rightarrow\frac{1}{\sqrt{2^n}}\bigotimes_{l=0}^{n-1}(|0\rangle_l + e^{2\pi i0.j_{n-l-1}\cdots j_0}|1\rangle_l)\]</span>ä»è¿™ä¸ªè¡¨è¾¾å¼ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥ï¼Œå˜æ¢ä¹‹åçš„æ€ä»ç„¶æ˜¯å¯åˆ†çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦å…³æ³¨å¦‚ä½•æŠŠä¸€ä¸ªQbitä»<span class="math inline">\(|j_{n-l-1}\rangle å˜æˆ |0\rangle+e^{2\pi i0.j_{n-l-1}\cdots j_0}|1\rangle\)</span>ã€‚é¦–å…ˆç›¸ä½ <span class="math inline">\(e^{2\pi i 0.j_{n-l-1}}\)</span>é€šè¿‡ä¸€ä¸ªHadamardï¼Œç›´æ¥å¯ä»¥å¾—åˆ°ã€‚ä»ç¬¬äºŒä½å¼€å§‹ï¼Œç›¸ä½çš„å€¼ä¾èµ–äºå…¶ä»–çš„Qbitï¼Œå› æ­¤éœ€è¦å€ŸåŠ©æ§åˆ¶é—¨æ‰èƒ½å®Œæˆã€‚ä¾‹å¦‚æˆ‘ä»¬éœ€è¦æŠŠ<span class="math inline">\(|0\rangle \rightarrow \frac{|0\rangle +e^{2\pi i0.0b}|1\rangle}{\sqrt{2}}\)</span>ï¼ˆæ³¨æ„è¿™è¾¹çš„å°æ•°ä»ç„¶ä¸€ä¸ªäºŒè¿›åˆ¶ä¸²ï¼‰ï¼Œé‚£ä¹ˆæˆ‘å¯ä»¥åŠ ä¸€ä¸ªåŸºäºbçš„å€¼çš„æ§åˆ¶é—¨ï¼Œæ¥å®Œæˆï¼šå¦‚æœ<span class="math inline">\(b=0\)</span> ï¼Œä¸æ‰§è¡Œæ“ä½œï¼›å¦‚æœ <span class="math inline">\(b=1\)</span> ï¼Œæ‰§è¡Œä¸€ä¸ªé—¨ <span class="math inline">\(\left(\begin{array}{cc}1 &amp; 0 \\ 0 &amp;e^{2\pi i 2^{-2}} \end{array}\right)\)</span> . å› æ­¤å¯¹äº <span class="math inline">\(l\)</span>ä½çš„æ¯”ç‰¹æ¥è¯´ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åŠ åŸºäºæ‰€æœ‰ä»–ä¹‹åæ‰€æœ‰æ¯”ç‰¹çš„æ§åˆ¶é—¨ <span class="math inline">\(\left(\begin{array}{cc} 1 &amp; 0 \\ 0 &amp;e^{2\pi i 2^{-d}} \end{array}\right)\)</span>ï¼Œè¿™é‡Œçš„ <span class="math inline">\(d\)</span> ä»£è¡¨è·ç¦» <span class="math inline">\(l\)</span> çš„ä½æ•°ã€‚</p><p>å¤æ‚åº¦ï¼š <span class="math inline">\(O(n^2)\)</span> æˆ‘ä»¬éœ€è¦åš <span class="math inline">\(\frac{n(n+1)}{2}\)</span> æ¬¡é—¨æ“ä½œã€‚å¤‡æ³¨ï¼šæ¦‚ç‡å¹…å¹¶ä¸å¦‚ç»å…¸çš„æŒ¯å¹…é‚£æ ·å®¹æ˜“è·å¾—ï¼Œå› æ­¤ç›´æ¥åº”ç”¨QFTï¼Œä¸æ˜¯é‚£ä¹ˆå®¹æ˜“ï¼Œå°½ç®¡æˆ‘ä»¬å±•ç¤ºäº†æŒ‡æ•°åŠ é€Ÿçš„èƒ½åŠ›ã€‚</p><aside id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr><ol><li id="fn1"><p>Quantum Computation and Quantum Information, MichaelA.Nielsen, Issac L. Chuang<a href="#fnref1" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li></ol></aside><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> ç†è®ºç‰©ç† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é‡å­è®¡ç®— </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ray æ¡†æ¶ç®€ä»‹</title>
      <link href="/2020/06/01/ray/"/>
      <url>/2020/06/01/ray/</url>
      
        <content type="html"><![CDATA[<h2 id="æ‘˜è¦">æ‘˜è¦</h2><p>Rayæ˜¯ä¸€ä¸ªæ¬¾UCBç ”ç©¶äººå‘˜è®¾è®¡çš„åˆ†å¸ƒå¼æœºå™¨å­¦ä¹ æ¡†æ¶ï¼Œå°¤å…¶æ˜¯é’ˆå¯¹å¼ºåŒ–å­¦ä¹ ã€‚æœ¬æ–‡ç¬¬ä¸€éƒ¨åˆ†ä»‹ç»åˆ†å¸ƒå¼æœºå™¨å­¦ä¹ ï¼Œå°¤å…¶æ˜¯å¯¹äºå¤æ‚çš„å¼ºåŒ–å­¦ä¹ éœ€è¦è§£å†³çš„å‡ å¤§å›°éš¾ï¼Œç¬¬äºŒéƒ¨åˆ†ä»‹ç»Rayæ¡†æ¶æ˜¯å¦‚ä½•è§£å†³è¿™äº›é—®é¢˜çš„ã€‚[^1][^2] <a id="more"></a></p><h2 id="é—®é¢˜éœ€è¦è§£å†³">é—®é¢˜éœ€è¦è§£å†³</h2><ol type="1"><li>ä½å»¶è¿Ÿ</li><li>é«˜ååé‡</li><li>åŠ¨åŠ›å­¦ä»»åŠ¡åˆ›å»ºï¼ˆDynamics task creationï¼‰</li><li>ä»»åŠ¡çš„å¤šæ ·æ€§ï¼ˆä¸åŒæ—¶é—´å°ºåº¦ï¼Œä¸åŒèƒ½é‡æ¶ˆè€—å°ºåº¦ï¼‰</li><li>æ•°æ®æµä¹‹é—´çš„ç›¸å…³æ€§</li><li>å®¹é”™æ€§</li><li>Debugå’Œå…¶ä»–ä¸€äº›ç›‘è§†è¦æ±‚ã€‚</li></ol><h2 id="åŠ¨åŠ›å­¦è®¡ç®—å›¾">åŠ¨åŠ›å­¦è®¡ç®—å›¾</h2><p>åœ¨Rayçš„æ¡†æ¶é‡Œï¼Œé‡‡å–äº†ä¸€ç§æˆä¸ºåŠ¨åŠ›å­¦è®¡ç®—å›¾(Dynamics task graphcomputation)çš„è®¡ç®—æ¨¡å¼ã€‚åœ¨Rayé‡Œé¢æœ‰ä¸‰ä¸ªä¸»è¦èŠ‚ç‚¹ï¼šTask, Actor, DataObjectã€‚Taskç”¨æ¥å®Œæˆstatelessçš„è®¡ç®—ï¼ŒActorç”¨æ¥åšstatefulçš„è®¡ç®—ï¼ŒDataObjectç”¨æ¥å­˜å‚¨æ•°æ®ã€‚é‚£ä¹ˆå¾ˆå®¹æ˜“æƒ³è±¡è¿™ä¸ªä¸‰è€…ä¹‹é—´éƒ½å­˜åœ¨æŸç§åºçš„å…³ç³»ï¼Œæˆ–è€…æ‰€è°“çš„åŠ¨åŠ›å­¦å…³ç³»ã€‚æ¯”å¦‚ä¸€ä¸ªTaskéœ€è¦å¦ä¸€ä¸ªTaskçš„è¾“å‡ºä½œä¸ºè¾“å…¥ï¼ŒåŒæ—¶éšç€è®¡ç®—çš„è¿›è¡Œï¼Œæ•°æ®ä¹Ÿåœ¨ä¸æ–­çš„æ›´æ–°è¿­ä»£ï¼Œé‚£ä¹ˆæ•°æ®æµçš„æ–¹å‘ä¹Ÿå…·æœ‰åŠ¨åŠ›å­¦æ„ä¹‰ã€‚å¯¹äºActorï¼ŒRayå°†å…¶å†…éƒ¨çš„çŠ¶æ€çš„æ”¹å˜ä¹Ÿè½¬æ¢æˆä¸€ä¸ªæœ‰æ–¹å‘çš„åŠ¨åŠ›å­¦è¿‡ç¨‹ã€‚è¿™æœ‰ç‚¹ç±»ä¼¼æŠŠä¸€ä¸ªè‡ªå¾ªç¯çš„å›¾å±•å¼€è®¡ç®—ã€‚è¿™æ ·Rayçš„è®¡ç®—å›¾å°±å®Œå…¨è½¬åŒ–æˆä¸€ä¸ªæ— çŠ¶æ€çš„åŠ¨åŠ›å­¦è®¡ç®—å›¾ã€‚</p><h2 id="æ¶æ„">æ¶æ„</h2><p>è¿™è¾¹æˆ‘ä»¬ä»‹ç»Rayæ˜¯å¦‚ä½•æ¶æ„æ•´ä¸ªè¿‡ç¨‹æ¥å®Œæˆä¸Šé¢çš„è®¡ç®—çš„å¹¶è§£å†³é—®é¢˜çš„ã€‚</p><img src="/2020/06/01/ray/arche.png" class="" title="This is an image"><p>avatar: /figures/ray/arche.png æ•´ä¸ªæ¶æ„åˆ†ä¸ºä¸¤å±‚:App Layer + SystemLayer.</p><ul><li>App Layer<ul><li>Driver -&gt; ç”¨æ¥æ‰§è¡Œç”¨æˆ·ç¨‹åº</li><li>Actor -&gt; ç”¨æ¥æ‰§è¡Œæœ‰çŠ¶æ€çš„ç¨‹åº</li><li>Worker -&gt; ç”¨æ¥æ‰§è¡Œæ— çŠ¶æ€çš„ç¨‹åº</li></ul></li><li>System Layer<ul><li>Global Control State(GCS) -&gt; Rayç‹¬ç‰¹çš„è®¾è®¡<ul><li>è§£è€¦lineageå’Œsystemcomponentsï¼Œè¿™æ ·åœ¨è§£å†³å®¹é”™é—®é¢˜çš„æ—¶å€™åˆä¿è¯äº†æ€§èƒ½ã€‚</li><li>æŠŠmetadataå­˜åœ¨GCSé‡Œè€Œä¸æ˜¯å‘ä»¥å¾€çš„æ„æ¶å­˜åœ¨scheduleré‡Œï¼Œè¿™æ ·å°±è§£è€¦äº†taskdispatchå’Œtask scheduleï¼Œä¿è¯äº†æ€§èƒ½.</li></ul></li><li>Bottom-up Distributed Scheduler -&gt;ä¸ºäº†æ»¡è¶³ä½å»¶è¿Ÿè°ƒåº¦ä»»åŠ¡ï¼ŒRayå°†scheduleråˆ†æˆäº†ä¸¤å±‚ã€‚<ul><li>Local Scheduler</li><li>Global Scheduler è¿™æ ·å½¢æˆå…ˆglobalå†localçš„è‡ªä¸‹è€Œä¸Šçš„è°ƒåº¦æ–¹å¼ã€‚</li></ul></li><li>In-Memory Distributed Object Store -&gt;ä¸ºäº†é™ä½å»¶è¿Ÿä¿è¯ååé‡ï¼Œé‡‡ç”¨äº†å…±äº«å†…å­˜çš„å­˜å‚¨æ–¹å¼ï¼Œæ¥é™ä½overheadã€‚</li></ul></li></ul><p>[^1] Moritz, Philipp, et al. "Ray: A distributed framework foremerging {AI} applications." 13th {USENIX} Symposium on OperatingSystems Design and Implementation ({OSDI} 18). 2018. [^2] Nishihara,Robert, et al. "Real-time machine learning: The missing pieces."Proceedings of the 16th Workshop on Hot Topics in Operating Systems.2017.</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> äººå·¥æ™ºèƒ½ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¼ºåŒ–å­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
